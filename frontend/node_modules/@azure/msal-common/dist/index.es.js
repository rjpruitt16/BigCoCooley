/*! @azure/msal-common v1.0.0-alpha.0 2020-01-18 */
'use strict';
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __spreadArrays() {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
}

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * AuthErrorMessage class containing string constants used by error codes and messages.
 */
var AuthErrorMessage = {
    unexpectedError: {
        code: "unexpected_error",
        desc: "Unexpected error in authentication."
    }
};
/**
 * General error class thrown by the MSAL.js library.
 */
var AuthError = /** @class */ (function (_super) {
    __extends(AuthError, _super);
    function AuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorMessage) || this;
        Object.setPrototypeOf(_this, AuthError.prototype);
        _this.errorCode = errorCode;
        _this.errorMessage = errorMessage;
        _this.name = "AuthError";
        return _this;
    }
    /**
     * Creates an error that is thrown when something unexpected happens in the library.
     * @param errDesc
     */
    AuthError.createUnexpectedError = function (errDesc) {
        return new AuthError(AuthErrorMessage.unexpectedError.code, AuthErrorMessage.unexpectedError.desc + ": " + errDesc);
    };
    return AuthError;
}(Error));

// Token renewal offset default in seconds
var DEFAULT_TOKEN_RENEWAL_OFFSET_SEC = 300;
// Default module system options
var DEFAULT_SYSTEM_OPTIONS = {
    tokenRenewalOffsetSeconds: DEFAULT_TOKEN_RENEWAL_OFFSET_SEC,
    telemetry: null
};
// Default logger implementation
var DEFAULT_LOGGER_IMPLEMENTATION = {
    loggerCallback: function () {
        var notImplErr = "Logger - loggerCallbackInterface() has not been implemented.";
        throw AuthError.createUnexpectedError(notImplErr);
    },
    piiLoggingEnabled: false
};
// Default storage implementation
var DEFAULT_STORAGE_IMPLEMENTATION = {
    clear: function () {
        var notImplErr = "Storage interface - clear() has not been implemented for the cacheStorage interface.";
        throw AuthError.createUnexpectedError(notImplErr);
    },
    containsKey: function () {
        var notImplErr = "Storage interface - containsKey() has not been implemented for the cacheStorage interface.";
        throw AuthError.createUnexpectedError(notImplErr);
    },
    getItem: function () {
        var notImplErr = "Storage interface - getItem() has not been implemented for the cacheStorage interface.";
        throw AuthError.createUnexpectedError(notImplErr);
    },
    getKeys: function () {
        var notImplErr = "Storage interface - getKeys() has not been implemented for the cacheStorage interface.";
        throw AuthError.createUnexpectedError(notImplErr);
    },
    removeItem: function () {
        var notImplErr = "Storage interface - removeItem() has not been implemented for the cacheStorage interface.";
        throw AuthError.createUnexpectedError(notImplErr);
    },
    setItem: function () {
        var notImplErr = "Storage interface - setItem() has not been implemented for the cacheStorage interface.";
        throw AuthError.createUnexpectedError(notImplErr);
    }
};
// Default network implementation
var DEFAULT_NETWORK_IMPLEMENTATION = {
    sendGetRequestAsync: function () {
        return __awaiter(this, void 0, void 0, function () {
            var notImplErr;
            return __generator(this, function (_a) {
                notImplErr = "Network interface - sendGetRequestAsync() has not been implemented";
                throw AuthError.createUnexpectedError(notImplErr);
            });
        });
    },
    sendPostRequestAsync: function () {
        return __awaiter(this, void 0, void 0, function () {
            var notImplErr;
            return __generator(this, function (_a) {
                notImplErr = "Network interface - sendPostRequestAsync() has not been implemented";
                throw AuthError.createUnexpectedError(notImplErr);
            });
        });
    }
};
// Default crypto implementation
var DEFAULT_CRYPTO_IMPLEMENTATION = {
    createNewGuid: function () {
        var notImplErr = "Crypto interface - createNewGuid() has not been implemented";
        throw AuthError.createUnexpectedError(notImplErr);
    },
    base64Decode: function () {
        var notImplErr = "Crypto interface - base64Decode() has not been implemented";
        throw AuthError.createUnexpectedError(notImplErr);
    },
    base64Encode: function () {
        var notImplErr = "Crypto interface - base64Encode() has not been implemented";
        throw AuthError.createUnexpectedError(notImplErr);
    },
    generatePkceCodes: function () {
        return __awaiter(this, void 0, void 0, function () {
            var notImplErr;
            return __generator(this, function (_a) {
                notImplErr = "Crypto interface - generatePkceCodes() has not been implemented";
                throw AuthError.createUnexpectedError(notImplErr);
            });
        });
    }
};
/**
 * Function that sets the default options when not explicitly configured from app developer
 *
 * @param TStorageOptions
 * @param TSystemOptions
 * @param TFrameworkOptions
 *
 * @returns MsalConfiguration object
 */
function buildModuleConfiguration(_a) {
    var userSystemOptions = _a.systemOptions, userLoggerOption = _a.loggerOptions, storageImplementation = _a.storageInterface, networkImplementation = _a.networkInterface, cryptoImplementation = _a.cryptoInterface;
    var overlayedConfig = {
        systemOptions: userSystemOptions || DEFAULT_SYSTEM_OPTIONS,
        loggerOptions: userLoggerOption || DEFAULT_LOGGER_IMPLEMENTATION,
        storageInterface: storageImplementation || DEFAULT_STORAGE_IMPLEMENTATION,
        networkInterface: networkImplementation || DEFAULT_NETWORK_IMPLEMENTATION,
        cryptoInterface: cryptoImplementation || DEFAULT_CRYPTO_IMPLEMENTATION
    };
    return overlayedConfig;
}

/**
 * Access token cache item which is used to manage tokens and token renewal.
 */
var AccessTokenCacheItem = /** @class */ (function () {
    function AccessTokenCacheItem(key, value) {
        this.key = key;
        this.value = value;
    }
    return AccessTokenCacheItem;
}());

/**
 * ClientAuthErrorMessage class containing string constants used by error codes and messages.
 */
var ClientAuthErrorMessage = {
    clientInfoDecodingError: {
        code: "client_info_decoding_error",
        desc: "The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."
    },
    clientInfoEmptyError: {
        code: "client_info_empty_error",
        desc: "The client info was empty. Please review the trace to determine the root cause."
    },
    idTokenParsingError: {
        code: "id_token_parsing_error",
        desc: "ID token cannot be parsed. Please review stack trace to determine root cause."
    },
    nullOrEmptyIdToken: {
        code: "null_or_empty_id_token",
        desc: "The idToken is null or empty. Please review the trace to determine the root cause."
    },
    tokenRequestCacheError: {
        code: "token_request_cache_error",
        desc: "The token request could not be fetched from the cache correctly."
    },
    endpointResolutionError: {
        code: "endpoints_resolution_error",
        desc: "Error: could not resolve endpoints. Please check network and try again."
    },
    invalidAuthorityType: {
        code: "invalid_authority_type",
        desc: "The given authority is not a valid type of authority supported by MSAL. Please review the trace to determine the root cause."
    },
    hashNotDeserialized: {
        code: "hash_not_deserialized",
        desc: "The hash parameters could not be deserialized. Please review the trace to determine the root cause."
    },
    blankGuidGenerated: {
        code: "blank_guid_generated",
        desc: "The guid generated was blank. Please review the trace to determine the root cause."
    },
    stateMismatchError: {
        code: "state_mismatch",
        desc: "State mismatch error. Please check your network. Continued requests may cause cache overflow."
    },
    nonceMismatchError: {
        code: "nonce_mismatch",
        desc: "Nonce mismatch error. This may be caused by a race condition in concurrent requests."
    },
    accountMismatchError: {
        code: "account_mismatch",
        desc: "The cached account and account which made the token request do not match."
    },
    invalidIdToken: {
        code: "invalid_id_token",
        desc: "Invalid ID token format."
    },
    noTokensFoundError: {
        code: "no_tokens_found",
        desc: "No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."
    },
    cacheParseError: {
        code: "cache_parse_error",
        desc: "Could not parse cache key."
    },
    userLoginRequiredError: {
        code: "user_login_error",
        desc: "User login is required."
    },
    multipleMatchingTokens: {
        code: "multiple_matching_tokens",
        desc: "The cache contains multiple tokens satisfying the requirements. " +
            "Call AcquireToken again providing more requirements such as authority, resource, or account."
    },
    tokenRequestCannotBeMade: {
        code: "request_cannot_be_made",
        desc: "Token request cannot be made without authorization code or refresh token."
    },
};
/**
 * Error thrown when there is an error in the client code running on the browser.
 */
var ClientAuthError = /** @class */ (function (_super) {
    __extends(ClientAuthError, _super);
    function ClientAuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ClientAuthError";
        Object.setPrototypeOf(_this, ClientAuthError.prototype);
        return _this;
    }
    /**
     * Creates an error thrown when client info object doesn't decode correctly.
     * @param caughtError
     */
    ClientAuthError.createClientInfoDecodingError = function (caughtError) {
        return new ClientAuthError(ClientAuthErrorMessage.clientInfoDecodingError.code, ClientAuthErrorMessage.clientInfoDecodingError.desc + " Failed with error: " + caughtError);
    };
    /**
     * Creates an error thrown if the client info is empty.
     * @param rawClientInfo
     */
    ClientAuthError.createClientInfoEmptyError = function (rawClientInfo) {
        return new ClientAuthError(ClientAuthErrorMessage.clientInfoEmptyError.code, ClientAuthErrorMessage.clientInfoEmptyError.desc + " Given Object: " + rawClientInfo);
    };
    /**
     * Creates an error thrown when the id token extraction errors out.
     * @param err
     */
    ClientAuthError.createIdTokenParsingError = function (caughtExtractionError) {
        return new ClientAuthError(ClientAuthErrorMessage.idTokenParsingError.code, ClientAuthErrorMessage.idTokenParsingError.desc + " Failed with error: " + caughtExtractionError);
    };
    /**
     * Creates an error thrown when the id token string is null or empty.
     * @param invalidRawTokenString
     */
    ClientAuthError.createIdTokenNullOrEmptyError = function (invalidRawTokenString) {
        return new ClientAuthError(ClientAuthErrorMessage.nullOrEmptyIdToken.code, ClientAuthErrorMessage.nullOrEmptyIdToken.desc + " Raw ID Token Value: " + invalidRawTokenString);
    };
    /**
     * Creates an error thrown when the token request could not be retrieved from the cache
     * @param errDetail
     */
    ClientAuthError.createTokenRequestCacheError = function (errDetail) {
        return new ClientAuthError(ClientAuthErrorMessage.tokenRequestCacheError.code, ClientAuthErrorMessage.tokenRequestCacheError.desc + " Error Detail: " + errDetail);
    };
    /**
     * Creates an error thrown when the endpoint discovery doesn't complete correctly.
     */
    ClientAuthError.createEndpointDiscoveryIncompleteError = function (errDetail) {
        return new ClientAuthError(ClientAuthErrorMessage.endpointResolutionError.code, ClientAuthErrorMessage.endpointResolutionError.desc + " Detail: " + errDetail);
    };
    /**
     * Creates an error thrown if authority type is not valid.
     * @param invalidAuthorityError
     */
    ClientAuthError.createInvalidAuthorityTypeError = function (givenUrl) {
        return new ClientAuthError(ClientAuthErrorMessage.invalidAuthorityType.code, ClientAuthErrorMessage.invalidAuthorityType.desc + " Given Url: " + givenUrl);
    };
    /**
     * Creates an error thrown when the hash cannot be deserialized.
     * @param invalidAuthorityError
     */
    ClientAuthError.createHashNotDeserializedError = function (hashParamObj) {
        return new ClientAuthError(ClientAuthErrorMessage.hashNotDeserialized.code, ClientAuthErrorMessage.hashNotDeserialized.desc + " Given Object: " + hashParamObj);
    };
    /**
     * Creates an error thrown when two states do not match.
     */
    ClientAuthError.createStateMismatchError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.stateMismatchError.code, ClientAuthErrorMessage.stateMismatchError.desc);
    };
    /**
     * Creates an error thrown when the nonce does not match.
     */
    ClientAuthError.createNonceMismatchError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.nonceMismatchError.code, ClientAuthErrorMessage.nonceMismatchError.desc);
    };
    /**
     * Creates an error thrown when the cached account and response account do not match.
     */
    ClientAuthError.createAccountMismatchError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.accountMismatchError.code, ClientAuthErrorMessage.accountMismatchError.desc);
    };
    /**
     * Throws error if idToken is not correctly formed
     * @param idToken
     */
    ClientAuthError.createInvalidIdTokenError = function (idToken) {
        return new ClientAuthError(ClientAuthErrorMessage.invalidIdToken.code, ClientAuthErrorMessage.invalidIdToken.desc + " Given token: " + JSON.stringify(idToken));
    };
    /**
     * Creates an error thrown when the authorization code required for a token request is null or empty.
     */
    ClientAuthError.createNoTokensFoundError = function (scopes) {
        return new ClientAuthError(ClientAuthErrorMessage.noTokensFoundError.code, ClientAuthErrorMessage.noTokensFoundError.desc + " Scopes: " + scopes);
    };
    /**
     * Creates an error in cache parsing.
     */
    ClientAuthError.createCacheParseError = function (cacheKey) {
        return new ClientAuthError(ClientAuthErrorMessage.cacheParseError.code, ClientAuthErrorMessage.cacheParseError.desc + " Cache key: " + cacheKey);
    };
    /**
     * Throws error when renewing token without login.
     */
    ClientAuthError.createUserLoginRequiredError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userLoginRequiredError.code, ClientAuthErrorMessage.userLoginRequiredError.desc);
    };
    /**
     * Throws error when multiple tokens are in cache for the given scope.
     * @param scope
     */
    ClientAuthError.createMultipleMatchingTokensInCacheError = function (scope) {
        return new ClientAuthError(ClientAuthErrorMessage.multipleMatchingTokens.code, "Cache error for scope " + scope + ": " + ClientAuthErrorMessage.multipleMatchingTokens.desc + ".");
    };
    /**
     * Throws error when no auth code or refresh token is given to ServerTokenRequestParameters.
     */
    ClientAuthError.createTokenRequestCannotBeMadeError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.tokenRequestCannotBeMade.code, ClientAuthErrorMessage.tokenRequestCannotBeMade.desc);
    };
    return ClientAuthError;
}(AuthError));

/**
 * @hidden
 */
var StringUtils = /** @class */ (function () {
    function StringUtils() {
    }
    /**
     * decode a JWT
     *
     * @param jwtToken
     */
    StringUtils.decodeJwt = function (jwtToken) {
        if (StringUtils.isEmpty(jwtToken)) {
            throw ClientAuthError.createIdTokenNullOrEmptyError(jwtToken);
        }
        var idTokenPartsRegex = /^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/;
        var matches = idTokenPartsRegex.exec(jwtToken);
        if (!matches || matches.length < 4) {
            throw ClientAuthError.createIdTokenParsingError("Given token is malformed: " + JSON.stringify(jwtToken));
        }
        var crackedToken = {
            header: matches[1],
            JWSPayload: matches[2],
            JWSSig: matches[3]
        };
        return crackedToken;
    };
    /**
     * Check if a string is empty.
     *
     * @param str
     */
    StringUtils.isEmpty = function (str) {
        return (typeof str === "undefined" || !str || 0 === str.length);
    };
    /**
     * Parses string into an object.
     *
     * @param query
     */
    StringUtils.queryStringToObject = function (query) {
        var match; // Regex for replacing addition symbol with a space
        var pl = /\+/g;
        var search = /([^&=]+)=([^&]*)/g;
        var decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); };
        var obj = {};
        match = search.exec(query);
        while (match) {
            obj[decode(match[1])] = decode(match[2]);
            match = search.exec(query);
        }
        return obj;
    };
    /**
     * Trims entries and converts them to lower case.
     *
     * @param arr
     */
    StringUtils.trimAndConvertArrayEntriesToLowerCase = function (arr) {
        return arr.map(function (entry) { return entry.trim().toLowerCase(); });
    };
    return StringUtils;
}());

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
var Constants = {
    LIBRARY_NAME: "MSAL.JS",
    // Prefix for all library cache entries
    CACHE_PREFIX: "msal",
    // Resource delimiter - used for certain cache entries
    RESOURCE_DELIM: "|",
    // Placeholder for non-existent account ids/objects
    NO_ACCOUNT: "NO_ACCOUNT",
    // Claims
    CLAIMS: "claims",
    // Consumer UTID
    CONSUMER_UTID: "9188040d-6c67-4c5b-b112-36a304b66dad",
    // Default scopes
    OPENID_SCOPE: "openid",
    PROFILE_SCOPE: "profile",
    OFFLINE_ACCESS_SCOPE: "offline_access",
    // Default response type for authorization code flow
    CODE_RESPONSE_TYPE: "code",
    CODE_GRANT_TYPE: "authorization_code",
    RT_GRANT_TYPE: "refresh_token",
    FRAGMENT_RESPONSE_MODE: "fragment",
    S256_CODE_CHALLENGE_METHOD: "S256",
    URL_FORM_CONTENT_TYPE: "application/x-www-form-urlencoded"
};
/**
 * Request header names
 */
var HEADER_NAMES;
(function (HEADER_NAMES) {
    HEADER_NAMES["CONTENT_TYPE"] = "Content-Type";
})(HEADER_NAMES || (HEADER_NAMES = {}));
/**
 * Temporary cache keys for MSAL, deleted after any request.
 */
var TemporaryCacheKeys;
(function (TemporaryCacheKeys) {
    TemporaryCacheKeys["AUTHORITY"] = "authority";
    TemporaryCacheKeys["ACQUIRE_TOKEN_ACCOUNT"] = "acquireToken.account";
    TemporaryCacheKeys["SESSION_STATE"] = "session.state";
    TemporaryCacheKeys["REQUEST_STATE"] = "request.state";
    TemporaryCacheKeys["NONCE_IDTOKEN"] = "nonce.idtoken";
    TemporaryCacheKeys["ORIGIN_URI"] = "request.origin";
    TemporaryCacheKeys["RENEW_STATUS"] = "token.renew.status";
    TemporaryCacheKeys["URL_HASH"] = "urlHash";
    TemporaryCacheKeys["REQUEST_PARAMS"] = "request.params";
    TemporaryCacheKeys["REDIRECT_REQUEST"] = "redirect.request";
    TemporaryCacheKeys["SCOPES"] = "scopes";
})(TemporaryCacheKeys || (TemporaryCacheKeys = {}));
/**
 * Persistent cache keys MSAL which stay while user is logged in.
 */
var PersistentCacheKeys;
(function (PersistentCacheKeys) {
    PersistentCacheKeys["ID_TOKEN"] = "idtoken";
    PersistentCacheKeys["CLIENT_INFO"] = "client.info";
    PersistentCacheKeys["ADAL_ID_TOKEN"] = "adal.idtoken";
    PersistentCacheKeys["ERROR"] = "error";
    PersistentCacheKeys["ERROR_DESC"] = "error.description";
})(PersistentCacheKeys || (PersistentCacheKeys = {}));
/**
 * List of pre-established trusted host URLs.
 */
var AADTrustedHostList = [
    "login.windows.net",
    "login.chinacloudapi.cn",
    "login.cloudgovapi.us",
    "login.microsoftonline.com",
    "login.microsoftonline.de",
    "login.microsoftonline.us"
];
/**
 * String constants related to AAD Authority
 */
var AADAuthorityConstants;
(function (AADAuthorityConstants) {
    AADAuthorityConstants["COMMON"] = "common";
    AADAuthorityConstants["ORGANIZATIONS"] = "organizations";
    AADAuthorityConstants["CONSUMERS"] = "consumers";
})(AADAuthorityConstants || (AADAuthorityConstants = {}));
/**
 * Keys in the hashParams sent by AAD Server
 */
var AADServerParamKeys;
(function (AADServerParamKeys) {
    AADServerParamKeys["CLIENT_ID"] = "client_id";
    AADServerParamKeys["RESOURCE"] = "resource";
    AADServerParamKeys["REDIRECT_URI"] = "redirect_uri";
    AADServerParamKeys["RESPONSE_TYPE"] = "response_type";
    AADServerParamKeys["RESPONSE_MODE"] = "response_mode";
    AADServerParamKeys["GRANT_TYPE"] = "grant_type";
    AADServerParamKeys["CLAIMS"] = "claims";
    AADServerParamKeys["SCOPE"] = "scope";
    AADServerParamKeys["ERROR"] = "error";
    AADServerParamKeys["ERROR_DESCRIPTION"] = "error_description";
    AADServerParamKeys["ACCESS_TOKEN"] = "access_token";
    AADServerParamKeys["ID_TOKEN"] = "id_token";
    AADServerParamKeys["REFRESH_TOKEN"] = "refresh_token";
    AADServerParamKeys["EXPIRES_IN"] = "expires_in";
    AADServerParamKeys["STATE"] = "state";
    AADServerParamKeys["NONCE"] = "nonce";
    AADServerParamKeys["PROMPT"] = "prompt";
    AADServerParamKeys["SESSION_STATE"] = "session_state";
    AADServerParamKeys["CLIENT_INFO"] = "client_info";
    AADServerParamKeys["CODE"] = "code";
    AADServerParamKeys["CODE_CHALLENGE"] = "code_challenge";
    AADServerParamKeys["CODE_CHALLENGE_METHOD"] = "code_challenge_method";
    AADServerParamKeys["CODE_VERIFIER"] = "code_verifier";
    AADServerParamKeys["CLIENT_REQUEST_ID"] = "client-request-id";
    AADServerParamKeys["X_CLIENT_SKU"] = "x-client-SKU";
    AADServerParamKeys["X_CLIENT_VER"] = "x-client-Ver";
    AADServerParamKeys["POST_LOGOUT_URI"] = "post_logout_redirect_uri";
})(AADServerParamKeys || (AADServerParamKeys = {}));
/**
 * IdToken claim string constants
 */
var IdTokenClaimName;
(function (IdTokenClaimName) {
    IdTokenClaimName["ISSUER"] = "iss";
    IdTokenClaimName["OBJID"] = "oid";
    IdTokenClaimName["SUBJECT"] = "sub";
    IdTokenClaimName["TENANTID"] = "tid";
    IdTokenClaimName["VERSION"] = "ver";
    IdTokenClaimName["PREF_USERNAME"] = "preferred_username";
    IdTokenClaimName["NAME"] = "name";
    IdTokenClaimName["NONCE"] = "nonce";
    IdTokenClaimName["EXPIRATION"] = "exp";
    IdTokenClaimName["HOME_OBJID"] = "home_oid";
    IdTokenClaimName["SESSIONID"] = "sid";
    IdTokenClaimName["CLOUD_INSTANCE_HOSTNAME"] = "cloud_instance_host_name";
})(IdTokenClaimName || (IdTokenClaimName = {}));
/**
 * we considered making this "enum" in the request instead of string, however it looks like the allowed list of
 * prompt values kept changing over past couple of years. There are some undocumented prompt values for some
 * internal partners too, hence the choice of generic "string" type instead of the "enum"
 */
var PromptState = {
    LOGIN: "login",
    SELECT_ACCOUNT: "select_account",
    CONSENT: "consent",
    NONE: "none",
};
/**
 * SSO Types - generated to populate hints
 */
var SSOTypes;
(function (SSOTypes) {
    SSOTypes["ACCOUNT"] = "account";
    SSOTypes["SID"] = "sid";
    SSOTypes["LOGIN_HINT"] = "login_hint";
    SSOTypes["ID_TOKEN"] = "id_token";
    SSOTypes["DOMAIN_HINT"] = "domain_hint";
    SSOTypes["ORGANIZATIONS"] = "organizations";
    SSOTypes["CONSUMERS"] = "consumers";
    SSOTypes["ACCOUNT_ID"] = "accountIdentifier";
    SSOTypes["HOMEACCOUNT_ID"] = "homeAccountIdentifier";
})(SSOTypes || (SSOTypes = {}));
/**
 * Disallowed extra query parameters.
 */
var BlacklistedEQParams = [
    SSOTypes.SID,
    SSOTypes.LOGIN_HINT
];

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * The CacheHelpers class contains a set of helper functions used by the module to manage cache items.
 */
var CacheHelpers = /** @class */ (function () {
    function CacheHelpers(cacheImpl) {
        this.cacheStorage = cacheImpl;
    }
    /**
     * Create acquireTokenAccountKey to cache account object
     * @param accountId
     * @param state
     */
    CacheHelpers.prototype.generateAcquireTokenAccountKey = function (accountId) {
        return "" + TemporaryCacheKeys.ACQUIRE_TOKEN_ACCOUNT + Constants.RESOURCE_DELIM + accountId;
    };
    /**
     * Create authorityKey to cache authority
     * @param state
     */
    CacheHelpers.prototype.generateAuthorityKey = function (state) {
        return "" + TemporaryCacheKeys.AUTHORITY + Constants.RESOURCE_DELIM + state;
    };
    /**
     * Create Nonce key to cache nonce
     * @param state
     */
    CacheHelpers.prototype.generateNonceKey = function (state) {
        return "" + TemporaryCacheKeys.NONCE_IDTOKEN + Constants.RESOURCE_DELIM + state;
    };
    /**
     * Sets the cachekeys for and stores the account information in cache
     * @param account
     * @param state
     */
    CacheHelpers.prototype.setAccountCache = function (account) {
        // Cache acquireTokenAccountKey
        var accountId = account && account.homeAccountIdentifier ? account.homeAccountIdentifier : Constants.NO_ACCOUNT;
        var acquireTokenAccountKey = this.generateAcquireTokenAccountKey(accountId);
        this.cacheStorage.setItem(acquireTokenAccountKey, JSON.stringify(account));
    };
    /**
     * Sets the cacheKey for and stores the authority information in cache
     * @param state
     * @param authority
     */
    CacheHelpers.prototype.setAuthorityCache = function (authority, state) {
        // Cache authorityKey
        var authorityKey = this.generateAuthorityKey(state);
        this.cacheStorage.setItem(authorityKey, authority.canonicalAuthority);
    };
    /**
     * Updates account, authority, and state in cache
     * @param serverAuthenticationRequest
     * @param account
     */
    CacheHelpers.prototype.updateCacheEntries = function (serverAuthenticationRequest, account) {
        // Cache account and state
        if (account) {
            this.setAccountCache(account);
        }
        // Cache the request state
        this.cacheStorage.setItem(TemporaryCacheKeys.REQUEST_STATE, serverAuthenticationRequest.state);
        // Cache the nonce
        this.cacheStorage.setItem(this.generateNonceKey(serverAuthenticationRequest.state), serverAuthenticationRequest.nonce);
        // Cache authorityKey
        this.setAuthorityCache(serverAuthenticationRequest.authorityInstance, serverAuthenticationRequest.state);
    };
    /**
     * Reset all temporary cache items
     * @param state
     */
    CacheHelpers.prototype.resetTempCacheItems = function (state) {
        var _this = this;
        // check state and remove associated cache items
        this.cacheStorage.getKeys().forEach(function (key) {
            if (!StringUtils.isEmpty(state) && key.indexOf(state) !== -1) {
                var splitKey = key.split(Constants.RESOURCE_DELIM);
                var keyState = splitKey.length > 1 ? splitKey[splitKey.length - 1] : null;
                if (keyState === state) {
                    _this.cacheStorage.removeItem(key);
                }
            }
        });
        // delete generic interactive request parameters
        this.cacheStorage.removeItem(TemporaryCacheKeys.REQUEST_STATE);
        this.cacheStorage.removeItem(TemporaryCacheKeys.ORIGIN_URI);
        this.cacheStorage.removeItem(TemporaryCacheKeys.REDIRECT_REQUEST);
    };
    /**
     * Get all access tokens in the cache
     * @param clientId
     * @param homeAccountIdentifier
     */
    CacheHelpers.prototype.getAllAccessTokens = function (clientId, authority, resource, homeAccountIdentifier) {
        var _this = this;
        var results = this.cacheStorage.getKeys().reduce(function (tokens, key) {
            var keyMatches = key.match(clientId) && key.match(authority) && key.match(resource) && key.match(homeAccountIdentifier);
            if (keyMatches) {
                var value = _this.cacheStorage.getItem(key);
                if (value) {
                    try {
                        var parseAtKey = JSON.parse(key);
                        var newAccessTokenCacheItem = new AccessTokenCacheItem(parseAtKey, JSON.parse(value));
                        return tokens.concat([newAccessTokenCacheItem]);
                    }
                    catch (e) {
                        throw ClientAuthError.createCacheParseError(key);
                    }
                }
            }
            return tokens;
        }, []);
        return results;
    };
    /**
     * Remove all access tokens in the cache
     * @param clientId
     * @param homeAccountIdentifier
     */
    CacheHelpers.prototype.removeAllAccessTokens = function (clientId, authority, resource, homeAccountIdentifier) {
        var _this = this;
        this.cacheStorage.getKeys().forEach(function (key) {
            var keyMatches = key.match(clientId) && key.match(authority) && key.match(resource) && key.match(homeAccountIdentifier);
            if (keyMatches) {
                _this.cacheStorage.removeItem(key);
            }
        });
    };
    return CacheHelpers;
}());

/**
 * accountIdentifier       combination of idToken.uid and idToken.utid
 * homeAccountIdentifier   combination of clientInfo.uid and clientInfo.utid
 * userName                idToken.preferred_username
 * name                    idToken.name
 * idToken                 idToken
 * sid                     idToken.sid - session identifier
 * environment             idtoken.issuer (the authority that issues the token)
 */
var Account = /** @class */ (function () {
    /**
     * Creates an Account Object
     * @praram accountIdentifier
     * @param homeAccountIdentifier
     * @param userName
     * @param name
     * @param idToken
     * @param sid
     * @param environment
     */
    function Account(accountIdentifier, homeAccountIdentifier, idTokenClaims, rawIdToken) {
        this.accountIdentifier = accountIdentifier;
        this.homeAccountIdentifier = homeAccountIdentifier;
        this.userName = idTokenClaims.preferred_username;
        this.name = idTokenClaims.name;
        // will be deprecated soon
        this.idToken = rawIdToken;
        this.idTokenClaims = idTokenClaims;
        this.sid = idTokenClaims.sid;
        this.environment = idTokenClaims.iss;
    }
    /**
     * @param idToken
     * @param clientInfo
     */
    Account.createAccount = function (idToken, clientInfo, crypto) {
        // create accountIdentifier
        var accountIdentifier = idToken.claims.oid || idToken.claims.sub;
        // create homeAccountIdentifier
        var uid = clientInfo ? clientInfo.uid : "";
        var utid = clientInfo ? clientInfo.utid : "";
        var homeAccountIdentifier;
        if (!StringUtils.isEmpty(uid) && !StringUtils.isEmpty(utid)) {
            homeAccountIdentifier = crypto.base64Encode(uid) + "." + crypto.base64Encode(utid);
        }
        return new Account(accountIdentifier, homeAccountIdentifier, idToken.claims, idToken.rawIdToken);
    };
    /**
     * Utils function to compare two Account objects - used to check if the same user account is logged in
     *
     * @param a1: Account object
     * @param a2: Account object
     */
    Account.compareAccounts = function (a1, a2) {
        if (!(a1 && a1.homeAccountIdentifier) || !(a2 && a2.homeAccountIdentifier)) {
            return false;
        }
        return a1.homeAccountIdentifier === a2.homeAccountIdentifier;
    };
    return Account;
}());

/**
 * Id Token representation class. Parses id token string and generates claims object.
 */
var IdToken = /** @class */ (function () {
    function IdToken(rawIdToken, crypto) {
        if (StringUtils.isEmpty(rawIdToken)) {
            throw ClientAuthError.createIdTokenNullOrEmptyError(rawIdToken);
        }
        this.rawIdToken = rawIdToken;
        this.claims = IdToken.extractIdToken(rawIdToken, crypto);
    }
    /**
     * Extract IdToken by decoding the RAWIdToken
     *
     * @param encodedIdToken
     */
    IdToken.extractIdToken = function (encodedIdToken, crypto) {
        // id token will be decoded to get the username
        var decodedToken = StringUtils.decodeJwt(encodedIdToken);
        if (!decodedToken) {
            return null;
        }
        try {
            var base64IdToken = decodedToken.JWSPayload;
            // base64Decode() should throw an error if there is an issue
            var base64Decoded = crypto.base64Decode(base64IdToken);
            return JSON.parse(base64Decoded);
        }
        catch (err) {
            throw ClientAuthError.createIdTokenParsingError(JSON.stringify(err));
        }
    };
    return IdToken;
}());

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Function to build a client info object
 * @param rawClientInfo
 * @param crypto
 */
function buildClientInfo(rawClientInfo, crypto) {
    if (!rawClientInfo || StringUtils.isEmpty(rawClientInfo)) {
        throw ClientAuthError.createClientInfoEmptyError(rawClientInfo);
    }
    try {
        var decodedClientInfo = crypto.base64Decode(rawClientInfo);
        return JSON.parse(decodedClientInfo);
    }
    catch (e) {
        throw ClientAuthError.createClientInfoDecodingError(e);
    }
}

var name = "@azure/msal-common";
var author = {
	name: "Microsoft",
	email: "nugetaad@microsoft.com",
	url: "https://www.microsoft.com"
};
var license = "MIT";
var repository = {
	type: "git",
	url: "https://github.com/AzureAD/microsoft-authentication-library-for-js.git"
};
var version = "1.0.0-alpha.0";
var description = "Microsoft Authentication Library for js";
var keywords = [
	"implicit",
	"authorization code",
	"PKCE",
	"js",
	"AAD",
	"msal",
	"oauth"
];
var main = "./dist/index.js";
var module = "./dist/index.es.js";
var types = "./dist/src/index.d.ts";
var browserslist = [
	"last 1 version",
	"> 1%",
	"maintained node versions",
	"not dead"
];
var engines = {
	node: ">=0.8.0"
};
var directories = {
	test: "test"
};
var files = [
	"dist"
];
var scripts = {
	clean: "shx rm -rf dist lib",
	"clean:coverage": "rimraf ../../.nyc_output/*",
	lint: "eslint src --ext .ts",
	test: "mocha",
	"test:coverage": "nyc --reporter=text mocha",
	"test:coverage:only": "npm run clean:coverage && npm run test:coverage",
	"build:modules": "rollup -c",
	"build:modules:watch": "rollup -cw",
	build: "npm run clean && npm run lint && npm run build:modules",
	prepack: "npm run build"
};
var devDependencies = {
	"@babel/core": "^7.7.2",
	"@babel/plugin-proposal-class-properties": "^7.7.0",
	"@babel/plugin-proposal-object-rest-spread": "^7.6.2",
	"@babel/polyfill": "^7.7.0",
	"@babel/preset-env": "^7.7.1",
	"@babel/preset-typescript": "^7.7.2",
	"@babel/register": "^7.7.0",
	"@istanbuljs/nyc-config-babel": "^2.1.1",
	"@rollup/plugin-json": "^4.0.0",
	"@types/chai": "^4.2.5",
	"@types/chai-as-promised": "^7.1.2",
	"@types/mocha": "^5.2.7",
	"@types/sinon": "^7.5.0",
	"@typescript-eslint/eslint-plugin": "^2.4.0",
	"@typescript-eslint/eslint-plugin-tslint": "^2.4.0",
	"@typescript-eslint/parser": "^2.4.0",
	"babel-plugin-istanbul": "^5.2.0",
	chai: "^4.2.0",
	"chai-as-promised": "^7.1.1",
	eslint: "^6.5.1",
	husky: "^3.0.9",
	mocha: "^6.2.2",
	nyc: "^14.1.1",
	rimraf: "^3.0.0",
	rollup: "^1.24.0",
	"rollup-plugin-typescript2": "^0.24.3",
	"rollup-plugin-uglify": "^6.0.3",
	shx: "^0.3.2",
	sinon: "^7.5.0",
	tslib: "^1.10.0",
	tslint: "^5.20.0",
	typescript: "^3.6.4"
};
var dependencies = {
};
var pkg = {
	name: name,
	author: author,
	license: license,
	repository: repository,
	version: version,
	description: description,
	keywords: keywords,
	main: main,
	module: module,
	types: types,
	browserslist: browserslist,
	engines: engines,
	directories: directories,
	files: files,
	scripts: scripts,
	devDependencies: devDependencies,
	dependencies: dependencies
};

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Log message level.
 */
var LogLevel;
(function (LogLevel) {
    LogLevel[LogLevel["Error"] = 0] = "Error";
    LogLevel[LogLevel["Warning"] = 1] = "Warning";
    LogLevel[LogLevel["Info"] = 2] = "Info";
    LogLevel[LogLevel["Verbose"] = 3] = "Verbose";
})(LogLevel || (LogLevel = {}));
/**
 * Class which facilitates logging of messages to a specific place.
 */
var Logger = /** @class */ (function () {
    function Logger(loggerOptions) {
        // Current log level, defaults to info.
        this.level = LogLevel.Info;
        if (loggerOptions) {
            this.localCallback = loggerOptions.loggerCallback;
            this.piiLoggingEnabled = loggerOptions.piiLoggingEnabled;
        }
    }
    /**
     * Log message with required options.
     */
    Logger.prototype.logMessage = function (logMessage, options) {
        if ((options.logLevel > this.level) || (!this.piiLoggingEnabled && options.containsPii)) {
            return;
        }
        var timestamp = new Date().toUTCString();
        var log;
        if (!StringUtils.isEmpty(this.correlationId)) {
            log = timestamp + ":" + this.correlationId + "-" + pkg.version + "-" + LogLevel[options.logLevel] + " " + logMessage;
        }
        else {
            log = timestamp + ":" + pkg.version + "-" + LogLevel[options.logLevel] + " " + logMessage;
        }
        this.executeCallback(options.logLevel, log, options.containsPii);
    };
    /**
     * Execute callback with message.
     */
    Logger.prototype.executeCallback = function (level, message, containsPii) {
        if (this.localCallback) {
            this.localCallback(level, message, containsPii);
        }
    };
    /**
     * Logs error messages.
     */
    Logger.prototype.error = function (message, correlationId) {
        this.logMessage(message, {
            logLevel: LogLevel.Error,
            containsPii: false,
            correlationId: correlationId || ""
        });
    };
    /**
     * Logs error messages with PII.
     */
    Logger.prototype.errorPii = function (message, correlationId) {
        this.logMessage(message, {
            logLevel: LogLevel.Error,
            containsPii: true,
            correlationId: correlationId || ""
        });
    };
    /**
     * Logs warning messages.
     */
    Logger.prototype.warning = function (message, correlationId) {
        this.logMessage(message, {
            logLevel: LogLevel.Warning,
            containsPii: false,
            correlationId: correlationId || ""
        });
    };
    /**
     * Logs warning messages with PII.
     */
    Logger.prototype.warningPii = function (message, correlationId) {
        this.logMessage(message, {
            logLevel: LogLevel.Warning,
            containsPii: true,
            correlationId: correlationId || ""
        });
    };
    /**
     * Logs info messages.
     */
    Logger.prototype.info = function (message, correlationId) {
        this.logMessage(message, {
            logLevel: LogLevel.Info,
            containsPii: false,
            correlationId: correlationId || ""
        });
    };
    /**
     * Logs info messages with PII.
     */
    Logger.prototype.infoPii = function (message, correlationId) {
        this.logMessage(message, {
            logLevel: LogLevel.Info,
            containsPii: true,
            correlationId: correlationId || ""
        });
    };
    /**
     * Logs verbose messages.
     */
    Logger.prototype.verbose = function (message, correlationId) {
        this.logMessage(message, {
            logLevel: LogLevel.Verbose,
            containsPii: false,
            correlationId: correlationId || ""
        });
    };
    /**
     * Logs verbose messages with PII.
     */
    Logger.prototype.verbosePii = function (message, correlationId) {
        this.logMessage(message, {
            logLevel: LogLevel.Verbose,
            containsPii: true,
            correlationId: correlationId || ""
        });
    };
    /**
     * Returns whether PII Logging is enabled or not.
     */
    Logger.prototype.isPiiLoggingEnabled = function () {
        return this.piiLoggingEnabled;
    };
    return Logger;
}());

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * AuthModule class
 *
 * Parent object instance which will construct requests to send to and handle responses from the Microsoft STS using the authorization code flow.
 *
 */
var AuthModule = /** @class */ (function () {
    function AuthModule(configuration) {
        // Set the configuration
        this.config = buildModuleConfiguration(configuration);
        // Initialize the logger
        this.logger = new Logger(this.config.loggerOptions);
        // Initialize crypto
        this.cryptoObj = this.config.cryptoInterface;
        // Initialize storage interface
        this.cacheStorage = this.config.storageInterface;
        // Initialize storage helper object
        this.cacheManager = new CacheHelpers(this.cacheStorage);
        // Set the network interface
        this.networkClient = this.config.networkInterface;
    }
    // #endregion
    // #region Getters and Setters
    /**
     * Returns the signed in account
     * (the account object is created at the time of successful login)
     * or null when no state is found
     * @returns {@link Account} - the account object stored in MSAL
     */
    AuthModule.prototype.getAccount = function () {
        if (this.account) {
            return this.account;
        }
        // Get id token and client info from cache
        var rawIdToken = this.cacheStorage.getItem(PersistentCacheKeys.ID_TOKEN);
        var rawClientInfo = this.cacheStorage.getItem(PersistentCacheKeys.CLIENT_INFO);
        if (!StringUtils.isEmpty(rawIdToken) && !StringUtils.isEmpty(rawClientInfo)) {
            var idToken = new IdToken(rawIdToken, this.cryptoObj);
            var clientInfo = buildClientInfo(rawClientInfo, this.cryptoObj);
            this.account = Account.createAccount(idToken, clientInfo, this.cryptoObj);
            return this.account;
        }
        // if login is not yet done, return null
        return null;
    };
    return AuthModule;
}());

var DEFAULT_AUTH_OPTIONS = {
    clientId: "",
    // Temporary until server allows CORS for public clients
    tmp_clientSecret: "",
    authority: null,
    validateAuthority: true,
    redirectUri: "",
    postLogoutRedirectUri: ""
};
/**
 * Function that sets the default options when not explicitly configured from app developer
 *
 * @param TAuthOptions
 * @param TStorageOptions
 * @param TSystemOptions
 * @param TFrameworkOptions
 *
 * @returns TConfiguration object
 */
function buildPublicClientSPAConfiguration(_a) {
    var auth = _a.auth, loggerOptions = _a.loggerOptions, storageInterface = _a.storageInterface, networkInterface = _a.networkInterface, cryptoInterface = _a.cryptoInterface;
    var baseConfig = buildModuleConfiguration({ loggerOptions: loggerOptions, storageInterface: storageInterface, networkInterface: networkInterface, cryptoInterface: cryptoInterface });
    var overlayedConfig = __assign({ auth: __assign(__assign({}, DEFAULT_AUTH_OPTIONS), auth) }, baseConfig);
    return overlayedConfig;
}

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Base abstract class for server request params class which validates request parameters, checks for SSO, and returns URL or request body content.
 */
var ServerRequestParameters = /** @class */ (function () {
    function ServerRequestParameters(clientId, redirectUri, cryptoImpl) {
        this.clientId = clientId;
        this.cryptoObj = cryptoImpl;
        this.redirectUri = redirectUri;
        // Telemetry Info
        this.xClientSku = Constants.LIBRARY_NAME;
        this.xClientVer = pkg.version;
    }
    return ServerRequestParameters;
}());

/**
 * ClientConfigurationErrorMessage class containing string constants used by error codes and messages.
 */
var ClientConfigurationErrorMessage = {
    redirectUriNotSet: {
        code: "redirect_uri_empty",
        desc: "A redirect URI is required for all calls, and none has been set."
    },
    postLogoutUriNotSet: {
        code: "post_logout_uri_empty",
        desc: "A post logout redirect has not been set."
    },
    claimsRequestParsingError: {
        code: "claims_request_parsing_error",
        desc: "Could not parse the given claims request object."
    },
    authorityUriInsecure: {
        code: "authority_uri_insecure",
        desc: "Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"
    },
    urlParseError: {
        code: "url_parse_error",
        desc: "URL could not be parsed into appropriate segments."
    },
    urlEmptyError: {
        code: "empty_url_error",
        desc: "URL was empty or null."
    },
    scopesRequiredError: {
        code: "scopes_required",
        desc: "Scopes are required to obtain an access token."
    },
    emptyScopesError: {
        code: "empty_input_scopes_error",
        desc: "Scopes cannot be passed as empty array."
    },
    nonArrayScopesError: {
        code: "nonarray_input_scopes_error",
        desc: "Scopes cannot be passed as non-array."
    },
    clientIdSingleScopeError: {
        code: "clientid_input_scopes_error",
        desc: "Client ID can only be provided as a single scope."
    },
    invalidPrompt: {
        code: "invalid_prompt_value",
        desc: "Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",
    },
    tokenRequestEmptyError: {
        code: "token_request_empty",
        desc: "Token request was empty and not found in cache."
    }
};
/**
 * Error thrown when there is an error in configuration of the MSAL.js library.
 */
var ClientConfigurationError = /** @class */ (function (_super) {
    __extends(ClientConfigurationError, _super);
    function ClientConfigurationError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ClientConfigurationError";
        Object.setPrototypeOf(_this, ClientConfigurationError.prototype);
        return _this;
    }
    /**
     * Creates an error thrown when the redirect uri is empty (not set by caller)
     */
    ClientConfigurationError.createRedirectUriEmptyError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.redirectUriNotSet.code, ClientConfigurationErrorMessage.redirectUriNotSet.desc);
    };
    /**
     * Creates an error thrown when the post-logout redirect uri is empty (not set by caller)
     */
    ClientConfigurationError.createPostLogoutRedirectUriEmptyError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.postLogoutUriNotSet.code, ClientConfigurationErrorMessage.postLogoutUriNotSet.desc);
    };
    /**
     * Creates an error thrown when the claims request could not be successfully parsed
     */
    ClientConfigurationError.createClaimsRequestParsingError = function (claimsRequestParseError) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.claimsRequestParsingError.code, ClientConfigurationErrorMessage.claimsRequestParsingError.desc + " Given value: " + claimsRequestParseError);
    };
    /**
     * Creates an error thrown if authority uri is given an insecure protocol.
     * @param urlString
     */
    ClientConfigurationError.createInsecureAuthorityUriError = function (urlString) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.authorityUriInsecure.code, ClientConfigurationErrorMessage.authorityUriInsecure.desc + " Given URI: " + urlString);
    };
    /**
     * Creates an error thrown if URL string does not parse into separate segments.
     * @param urlString
     */
    ClientConfigurationError.createUrlParseError = function (urlParseError) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.urlParseError.code, ClientConfigurationErrorMessage.urlParseError.desc + " Given Error: " + urlParseError);
    };
    /**
     * Creates an error thrown if URL string is empty or null.
     * @param urlString
     */
    ClientConfigurationError.createUrlEmptyError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.urlEmptyError.code, ClientConfigurationErrorMessage.urlEmptyError.desc);
    };
    /**
     * Error thrown when input scopes are required.
     * @param inputScopes
     */
    ClientConfigurationError.createScopesRequiredError = function (inputScopes) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.scopesRequiredError.code, ClientConfigurationErrorMessage.scopesRequiredError.desc + " Given Scopes: " + inputScopes);
    };
    /**
     * Error thrown when scopes are not an array
     * @param inputScopes
     */
    ClientConfigurationError.createScopesNonArrayError = function (inputScopes) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.nonArrayScopesError.code, ClientConfigurationErrorMessage.nonArrayScopesError.desc + " Given Scopes: " + inputScopes.toString());
    };
    /**
     * Error thrown when scopes are empty.
     * @param scopesValue
     */
    ClientConfigurationError.createEmptyScopesArrayError = function (inputScopes) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.emptyScopesError.code, ClientConfigurationErrorMessage.emptyScopesError.desc + " Given Scopes: " + inputScopes.toString());
    };
    /**
     * Error thrown when client id scope is not provided as single scope.
     * @param inputScopes
     */
    ClientConfigurationError.createClientIdSingleScopeError = function (inputScopes) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.clientIdSingleScopeError.code, ClientConfigurationErrorMessage.clientIdSingleScopeError.desc + " Given Scopes: " + inputScopes.toString());
    };
    /**
     * Error thrown when prompt is not an allowed type.
     * @param promptValue
     */
    ClientConfigurationError.createInvalidPromptError = function (promptValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidPrompt.code, ClientConfigurationErrorMessage.invalidPrompt.desc + " Given value: " + promptValue);
    };
    /**
     * Throws error when token request is empty and nothing cached in storage.
     */
    ClientConfigurationError.createEmptyTokenRequestError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.tokenRequestEmptyError.code, ClientConfigurationErrorMessage.tokenRequestEmptyError.desc);
    };
    return ClientConfigurationError;
}(ClientAuthError));

/**
 * The ScopeSet class creates a set of scopes. Scopes are case-insensitive, unique values, so the Set object in JS makes
 * the most sense to implement for this class. All scopes are trimmed and converted to lower case strings to ensure uniqueness of strings.
 */
var ScopeSet = /** @class */ (function () {
    function ScopeSet(inputScopes, appClientId, scopesRequired) {
        this.clientId = appClientId;
        this.scopesRequired = scopesRequired;
        // Validate and filter scopes (validate function throws if validation fails)
        this.validateInputScopes(inputScopes);
        var scopeArr = inputScopes ? StringUtils.trimAndConvertArrayEntriesToLowerCase(__spreadArrays(inputScopes)) : [];
        this.scopes = new Set(scopeArr);
        this.originalScopes = new Set(this.scopes);
        if (!this.scopesRequired) {
            this.appendScope(this.clientId);
        }
        this.replaceDefaultScopes();
    }
    /**
     * Factory method to create ScopeSet from string
     * @param inputScopeString
     * @param appClientId
     * @param scopesRequired
     */
    ScopeSet.fromString = function (inputScopeString, appClientId, scopesRequired) {
        var inputScopes = inputScopeString.split(" ");
        return new ScopeSet(inputScopes, appClientId, scopesRequired);
    };
    /**
     * Replace client id with the default scopes used for token acquisition.
     */
    ScopeSet.prototype.replaceDefaultScopes = function () {
        if (this.scopes.has(this.clientId)) {
            this.removeScope(this.clientId);
            this.appendScope(Constants.OPENID_SCOPE);
            this.appendScope(Constants.PROFILE_SCOPE);
        }
        this.appendScope(Constants.OFFLINE_ACCESS_SCOPE);
    };
    /**
     * Used to validate the scopes input parameter requested  by the developer.
     * @param {Array<string>} inputScopes - Developer requested permissions. Not all scopes are guaranteed to be included in the access token returned.
     * @param {boolean} scopesRequired - Boolean indicating whether the scopes array is required or not
     */
    ScopeSet.prototype.validateInputScopes = function (inputScopes) {
        if (this.scopesRequired) {
            // Scopes are required but not given
            if (!inputScopes) {
                throw ClientConfigurationError.createScopesRequiredError(inputScopes);
            }
            // Check that scopes is not an empty array
            if (inputScopes.length < 1) {
                throw ClientConfigurationError.createEmptyScopesArrayError(inputScopes);
            }
        }
        // Check that scopes is an array object
        if (inputScopes && !Array.isArray(inputScopes)) {
            throw ClientConfigurationError.createScopesNonArrayError(inputScopes);
        }
    };
    /**
     * Check if a given scope is present in this set of scopes.
     * @param scope
     */
    ScopeSet.prototype.containsScope = function (scope) {
        return this.scopes.has(scope);
    };
    /**
     * Check if a set of scopes is present in this set of scopes.
     * @param scopeSet
     */
    ScopeSet.prototype.containsScopeSet = function (scopeSet) {
        var _this = this;
        return this.scopes.size >= scopeSet.scopes.size && scopeSet.asArray().every(function (scope) { return _this.containsScope(scope); });
    };
    /**
     * Appends single scope if passed
     * @param newScope
     */
    ScopeSet.prototype.appendScope = function (newScope) {
        this.scopes.add(newScope);
    };
    /**
     * Appends multiple scopes if passed
     * @param newScopes
     */
    ScopeSet.prototype.appendScopes = function (newScopes) {
        var newScopeSet = new ScopeSet(newScopes, this.clientId, false);
        this.scopes = this.unionScopeSets(newScopeSet);
    };
    /**
     * Removes element from set of scopes.
     * @param scope
     */
    ScopeSet.prototype.removeScope = function (scope) {
        this.scopes.delete(scope);
    };
    /**
     * Combines an array of scopes with the current set of scopes.
     * @param otherScopes
     */
    ScopeSet.prototype.unionScopeSets = function (otherScopes) {
        return new Set(__spreadArrays(otherScopes.asArray(), Array.from(this.scopes)));
    };
    /**
     * Check if scopes intersect between this set and another.
     * @param otherScopes
     */
    ScopeSet.prototype.intersectingScopeSets = function (otherScopes) {
        return this.unionScopeSets(otherScopes).size < (this.scopes.size + otherScopes.getScopeCount());
    };
    /**
     * Returns size of set of scopes.
     */
    ScopeSet.prototype.getScopeCount = function () {
        return this.scopes.size;
    };
    /**
     * Returns true if the set of original scopes only contained client-id
     */
    ScopeSet.prototype.isLoginScopeSet = function () {
        var hasLoginScopes = (this.originalScopes.has(this.clientId) ||
            this.originalScopes.has(Constants.OPENID_SCOPE) ||
            this.originalScopes.has(Constants.PROFILE_SCOPE));
        return this.originalScopes && hasLoginScopes;
    };
    /**
     * Returns the scopes as an array of string values
     */
    ScopeSet.prototype.asArray = function () {
        return Array.from(this.scopes);
    };
    /**
     * Returns the original scopes as an array (no extra scopes to consent)
     */
    ScopeSet.prototype.getOriginalScopesAsArray = function () {
        return Array.from(this.originalScopes);
    };
    /**
     * Prints scopes into a space-delimited string
     */
    ScopeSet.prototype.printScopes = function () {
        if (this.scopes) {
            var scopeArr = this.asArray();
            return scopeArr.join(" ");
        }
        return "";
    };
    return ScopeSet;
}());

/**
 * Function which validates claims request passed in by the user.
 * @param request
 */
function validateClaimsRequest(request) {
    if (!request.claimsRequest) {
        return;
    }
    try {
        JSON.parse(request.claimsRequest);
    }
    catch (e) {
        throw ClientConfigurationError.createClaimsRequestParsingError(e);
    }
    // TODO: More validation will be added when the server team tells us how they have actually implemented claims
}

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Class which provides helpers for OAuth 2.0 protocol specific values
 */
var ProtocolUtils = /** @class */ (function () {
    function ProtocolUtils() {
    }
    /**
     * Appends user state with random guid, or returns random guid.
     * @param userState
     * @param randomGuid
     */
    ProtocolUtils.setRequestState = function (userState, randomGuid) {
        return userState && !StringUtils.isEmpty(userState) ? "" + randomGuid + Constants.RESOURCE_DELIM + userState : randomGuid;
    };
    /**
     *
     * Extracts user state value from the state sent with the authentication request.
     * @returns {string} scope.
     * @ignore
     */
    ProtocolUtils.getUserRequestState = function (serverResponseState) {
        if (serverResponseState) {
            var splitIndex = serverResponseState.indexOf(Constants.RESOURCE_DELIM);
            if (splitIndex > -1 && splitIndex + 1 < serverResponseState.length) {
                return serverResponseState.substring(splitIndex + 1);
            }
        }
        return "";
    };
    return ProtocolUtils;
}());

/**
 * This class extends the ServerRequestParameters class. This class validates URL request parameters, checks for SSO and generates required URL.
 */
var ServerCodeRequestParameters = /** @class */ (function (_super) {
    __extends(ServerCodeRequestParameters, _super);
    function ServerCodeRequestParameters(authority, clientId, userRequest, cachedAccount, redirectUri, cryptoImpl, isLoginCall) {
        var _this = _super.call(this, clientId, redirectUri, cryptoImpl) || this;
        _this.authorityInstance = authority;
        _this.userRequest = userRequest;
        _this.responseType = Constants.CODE_RESPONSE_TYPE;
        _this.account = (userRequest && userRequest.account) || cachedAccount;
        // Set scopes, append extra scopes if there is a login call.
        _this.scopes = new ScopeSet(_this.userRequest && _this.userRequest.scopes, _this.clientId, !isLoginCall);
        if (isLoginCall) {
            _this.appendExtraScopes();
        }
        // Set random vars
        var randomGuid = _this.cryptoObj.createNewGuid();
        _this.state = ProtocolUtils.setRequestState(_this.userRequest && _this.userRequest.userRequestState, randomGuid);
        _this.nonce = _this.cryptoObj.createNewGuid();
        _this.correlationId = _this.userRequest.correlationId || _this.cryptoObj.createNewGuid();
        return _this;
    }
    /**
     * Appends extraScopesToConsent if passed
     */
    ServerCodeRequestParameters.prototype.appendExtraScopes = function () {
        if (this.userRequest && this.scopes) {
            if (this.userRequest.extraScopesToConsent) {
                this.scopes.appendScopes(this.userRequest.extraScopesToConsent);
            }
        }
    };
    /**
     * Check to see if there are SSO params set in the Request
     * @param request
     */
    ServerCodeRequestParameters.prototype.hasSSOParam = function () {
        var isSSORequest = this.userRequest && (this.account || this.userRequest.sid || this.userRequest.loginHint);
        return !!this.account || !!isSSORequest;
    };
    /**
     * Utility to populate QueryParameters and ExtraQueryParameters to ServerRequestParamerers
     * @param adalIdTokenObject
     */
    ServerCodeRequestParameters.prototype.populateQueryParams = function (adalIdTokenObject) {
        var queryParameters = {};
        if (this.userRequest) {
            // add the prompt parameter to serverRequestParameters if passed
            if (this.userRequest.prompt) {
                this.validatePromptParameter(this.userRequest.prompt);
            }
            // Add claims challenge to serverRequestParameters if passed
            if (this.userRequest.claimsRequest) {
                validateClaimsRequest(this.userRequest);
            }
            // if the developer provides one of these, give preference to developer choice
            if (this.hasSSOParam()) {
                queryParameters = this.constructUnifiedCacheQueryParameter(null);
            }
        }
        // ADAL token SSO
        if (adalIdTokenObject) {
            queryParameters = this.constructUnifiedCacheQueryParameter(adalIdTokenObject);
        }
        /*
         * adds sid/login_hint if not populated; populates domain_hint
         * this.logger.verbose("Calling addHint parameters");
         */
        queryParameters = this.addHintParameters(queryParameters);
        // sanity check for developer passed extraQueryParameters
        var eQParams;
        if (this.userRequest) {
            eQParams = this.sanitizeEQParams(this.userRequest);
        }
        // Populate the extraQueryParameters to be sent to the server
        this.queryParameters = this.generateQueryParametersString(queryParameters);
        this.extraQueryParameters = this.generateQueryParametersString(eQParams);
    };
    /**
     * Create navigation url.
     */
    ServerCodeRequestParameters.prototype.createNavigateUrl = function () {
        return __awaiter(this, void 0, void 0, function () {
            var str, authEndpoint, requestUrl;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.createParamString()];
                    case 1:
                        str = _a.sent();
                        authEndpoint = this.authorityInstance.authorizationEndpoint;
                        // if the endpoint already has queryparams, lets add to it, otherwise add the first one
                        if (authEndpoint.indexOf("?") < 0) {
                            authEndpoint += "?";
                        }
                        else {
                            authEndpoint += "&";
                        }
                        requestUrl = "" + authEndpoint + str.join("&");
                        return [2 /*return*/, requestUrl];
                }
            });
        });
    };
    /**
     * Create a query parameter string.
     */
    ServerCodeRequestParameters.prototype.createParamString = function () {
        return __awaiter(this, void 0, void 0, function () {
            var str, _a;
            return __generator(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        str = [];
                        str.push(AADServerParamKeys.RESPONSE_TYPE + "=" + this.responseType);
                        str.push(AADServerParamKeys.SCOPE + "=" + encodeURIComponent(this.scopes.printScopes()));
                        str.push(AADServerParamKeys.CLIENT_ID + "=" + encodeURIComponent(this.clientId));
                        str.push(AADServerParamKeys.REDIRECT_URI + "=" + encodeURIComponent(this.redirectUri));
                        str.push(AADServerParamKeys.STATE + "=" + encodeURIComponent(this.state));
                        str.push(AADServerParamKeys.NONCE + "=" + encodeURIComponent(this.nonce));
                        str.push(AADServerParamKeys.CLIENT_INFO + "=1");
                        str.push(AADServerParamKeys.X_CLIENT_SKU + "=" + this.xClientSku);
                        str.push(AADServerParamKeys.X_CLIENT_VER + "=" + this.xClientVer);
                        // Add codes here. May want to add optional step to allow for non-PKCE auth code flows
                        _a = this;
                        return [4 /*yield*/, this.cryptoObj.generatePkceCodes()];
                    case 1:
                        // Add codes here. May want to add optional step to allow for non-PKCE auth code flows
                        _a.generatedPkce = _b.sent();
                        str.push(AADServerParamKeys.CODE_CHALLENGE + "=" + encodeURIComponent(this.generatedPkce.challenge));
                        str.push(AADServerParamKeys.CODE_CHALLENGE_METHOD + "=" + Constants.S256_CODE_CHALLENGE_METHOD);
                        // Append resource
                        if (this.userRequest && this.userRequest.resource) {
                            str.push(AADServerParamKeys.RESOURCE + "=" + encodeURIComponent(this.userRequest.resource));
                        }
                        // Append prompt
                        if (this.userRequest && this.userRequest.prompt) {
                            str.push(AADServerParamKeys.PROMPT + "=" + (encodeURIComponent(this.userRequest.prompt)));
                        }
                        // Append claims request
                        if (this.userRequest && this.userRequest.claimsRequest) {
                            str.push(AADServerParamKeys.CLAIMS + "=" + encodeURIComponent(this.userRequest.claimsRequest));
                        }
                        // Append query params
                        if (this.queryParameters) {
                            str.push(this.queryParameters);
                        }
                        // Append extra query params
                        if (this.extraQueryParameters) {
                            str.push(this.extraQueryParameters);
                        }
                        str.push(AADServerParamKeys.CLIENT_REQUEST_ID + "=" + encodeURIComponent(this.correlationId));
                        str.push(AADServerParamKeys.RESPONSE_MODE + "=" + Constants.FRAGMENT_RESPONSE_MODE);
                        return [2 /*return*/, str];
                }
            });
        });
    };
    /**
     * Utility to test if valid prompt value is passed in the request
     * @param request
     */
    ServerCodeRequestParameters.prototype.validatePromptParameter = function (prompt) {
        if ([PromptState.LOGIN, PromptState.SELECT_ACCOUNT, PromptState.CONSENT, PromptState.NONE].indexOf(prompt) < 0) {
            throw ClientConfigurationError.createInvalidPromptError(prompt);
        }
    };
    /**
     * Constructs extraQueryParameters to be sent to the server for the AuthenticationParameters set by the developer
     * in any login() or acquireToken() calls
     * @param idTokenObject
     * @param extraQueryParameters
     * @param sid
     * @param loginHint
     */
    // TODO: check how this behaves when domain_hint only is sent in extraparameters and idToken has no upn.
    ServerCodeRequestParameters.prototype.constructUnifiedCacheQueryParameter = function (idTokenObject) {
        // preference order: account > sid > login_hint
        var ssoType;
        var ssoData;
        var serverReqParam = {};
        // if account info is passed, account.sid > account.login_hint
        if (this.userRequest) {
            if (this.account) {
                var account = this.account;
                if (account.sid) {
                    ssoType = SSOTypes.SID;
                    ssoData = account.sid;
                }
                else if (account.userName) {
                    ssoType = SSOTypes.LOGIN_HINT;
                    ssoData = account.userName;
                }
            }
            // sid from request
            else if (this.userRequest.sid) {
                ssoType = SSOTypes.SID;
                ssoData = this.userRequest.sid;
            }
            // loginHint from request
            else if (this.userRequest.loginHint) {
                ssoType = SSOTypes.LOGIN_HINT;
                ssoData = this.userRequest.loginHint;
            }
        }
        // adalIdToken retrieved from cache
        else if (idTokenObject) {
            if (idTokenObject.claims && idTokenObject.claims.preferred_username) {
                ssoType = SSOTypes.ID_TOKEN;
                ssoData = idTokenObject.claims.preferred_username;
            }
            else {
                ssoType = SSOTypes.ORGANIZATIONS;
                ssoData = null;
            }
        }
        serverReqParam = this.addSSOParameter(ssoType, ssoData);
        // add the HomeAccountIdentifier info/ domain_hint
        if (this.account && this.account.homeAccountIdentifier) {
            serverReqParam = this.addSSOParameter(SSOTypes.HOMEACCOUNT_ID, this.account.homeAccountIdentifier, serverReqParam);
        }
        return serverReqParam;
    };
    /**
     * Adds login_hint to authorization URL which is used to pre-fill the username field of sign in page for the user if known ahead of time
     * domain_hint can be one of users/organizations which when added skips the email based discovery process of the user
     * domain_req utid received as part of the clientInfo
     * login_req uid received as part of clientInfo
     * Also does a sanity check for extraQueryParameters passed by the user to ensure no repeat queryParameters
     *
     * @param {@link Account} account - Account for which the token is requested
     * @param queryparams
     * @param {@link ServerRequestParameters}
     */
    ServerCodeRequestParameters.prototype.addHintParameters = function (qParams) {
        /*
         * This is a final check for all queryParams added so far; preference order: sid > login_hint
         * sid cannot be passed along with login_hint or domain_hint, hence we check both are not populated yet in queryParameters
         */
        if (this.account && !qParams[SSOTypes.SID]) {
            // sid - populate only if login_hint is not already populated and the account has sid
            var populateSID = !qParams[SSOTypes.LOGIN_HINT] && this.account.sid && this.userRequest.prompt === PromptState.NONE;
            if (populateSID) {
                qParams = this.addSSOParameter(SSOTypes.SID, this.account.sid, qParams);
            }
            // login_hint - account.userName
            else {
                var populateLoginHint = !qParams[SSOTypes.LOGIN_HINT] && this.account.userName && !StringUtils.isEmpty(this.account.userName);
                if (populateLoginHint) {
                    qParams = this.addSSOParameter(SSOTypes.LOGIN_HINT, this.account.userName, qParams);
                }
            }
        }
        return qParams;
    };
    /**
     * Add SID to extraQueryParameters
     * @param sid
     */
    ServerCodeRequestParameters.prototype.addSSOParameter = function (ssoType, ssoData, ssoParam) {
        if (!ssoParam) {
            ssoParam = {};
        }
        if (!ssoData) {
            return ssoParam;
        }
        switch (ssoType) {
            case SSOTypes.SID: {
                ssoParam[SSOTypes.SID] = ssoData;
                break;
            }
            case SSOTypes.ID_TOKEN: {
                ssoParam[SSOTypes.LOGIN_HINT] = ssoData;
                ssoParam[SSOTypes.DOMAIN_HINT] = SSOTypes.ORGANIZATIONS;
                break;
            }
            case SSOTypes.LOGIN_HINT: {
                ssoParam[SSOTypes.LOGIN_HINT] = ssoData;
                break;
            }
            case SSOTypes.ORGANIZATIONS: {
                ssoParam[SSOTypes.DOMAIN_HINT] = SSOTypes.ORGANIZATIONS;
                break;
            }
            case SSOTypes.CONSUMERS: {
                ssoParam[SSOTypes.DOMAIN_HINT] = SSOTypes.CONSUMERS;
                break;
            }
            case SSOTypes.HOMEACCOUNT_ID: {
                var homeAccountId = ssoData.split(".");
                var utid = this.cryptoObj.base64Decode(homeAccountId[1]);
                if (utid === Constants.CONSUMER_UTID) {
                    ssoParam[SSOTypes.DOMAIN_HINT] = SSOTypes.CONSUMERS;
                }
                else {
                    ssoParam[SSOTypes.DOMAIN_HINT] = SSOTypes.ORGANIZATIONS;
                }
                break;
            }
        }
        return ssoParam;
    };
    /**
     * Removes unnecessary or duplicate query parameters from extraQueryParameters
     * @param request
     */
    ServerCodeRequestParameters.prototype.sanitizeEQParams = function (request) {
        var eQParams = request.extraQueryParameters;
        if (!eQParams) {
            return null;
        }
        if (request.claimsRequest) {
            // this.logger.warning("Removed duplicate claims from extraQueryParameters. Please use either the claimsRequest field OR pass as extraQueryParameter - not both.");
            delete eQParams[Constants.CLAIMS];
        }
        BlacklistedEQParams.forEach(function (param) {
            if (eQParams[param]) {
                // this.logger.warning("Removed duplicate " + param + " from extraQueryParameters. Please use the " + param + " field in request object.");
                delete eQParams[param];
            }
        });
        return eQParams;
    };
    /**
     * Utility to generate a QueryParameterString from a Key-Value mapping of extraQueryParameters passed
     * @param extraQueryParameters
     */
    ServerCodeRequestParameters.prototype.generateQueryParametersString = function (queryParameters) {
        var paramsString = null;
        if (queryParameters) {
            Object.keys(queryParameters).forEach(function (key) {
                if (paramsString == null) {
                    paramsString = key + "=" + encodeURIComponent(queryParameters[key]);
                }
                else {
                    paramsString += "&" + key + "=" + encodeURIComponent(queryParameters[key]);
                }
            });
        }
        return paramsString;
    };
    return ServerCodeRequestParameters;
}(ServerRequestParameters));

/**
 * This class extends the ServerRequestParameters class. This class validates token request parameters and generates a form body and headers required for the request.
 */
var ServerTokenRequestParameters = /** @class */ (function (_super) {
    __extends(ServerTokenRequestParameters, _super);
    function ServerTokenRequestParameters(clientId, clientSecret, tokenRequest, codeResponse, redirectUri, cryptoImpl, refreshToken) {
        var _this = _super.call(this, clientId, redirectUri, cryptoImpl) || this;
        _this.clientSecret = clientSecret;
        _this.tokenRequest = tokenRequest;
        _this.codeResponse = codeResponse;
        _this.refreshToken = refreshToken;
        // Set scopes, always required for token request/exchange
        _this.scopes = new ScopeSet(_this.tokenRequest && _this.tokenRequest.scopes, _this.clientId, true);
        // Set correlation id
        _this.correlationId = _this.tokenRequest.correlationId || _this.cryptoObj.createNewGuid();
        return _this;
    }
    /**
     * Creates headers required for token request.
     */
    ServerTokenRequestParameters.prototype.createRequestHeaders = function () {
        var headers = new Map();
        headers.set(HEADER_NAMES.CONTENT_TYPE, Constants.URL_FORM_CONTENT_TYPE);
        return headers;
    };
    /**
     * Creates string of parameters to send to server in request body.
     */
    ServerTokenRequestParameters.prototype.createRequestBody = function () {
        var paramString = this.createParamString();
        return paramString.join("&");
    };
    /**
     * Helper creates an array of key value string pairs.
     */
    ServerTokenRequestParameters.prototype.createParamString = function () {
        var str = [];
        str.push(AADServerParamKeys.CLIENT_ID + "=" + encodeURIComponent(this.clientId));
        str.push(AADServerParamKeys.SCOPE + "=" + encodeURIComponent(this.scopes.printScopes()));
        str.push(AADServerParamKeys.REDIRECT_URI + "=" + encodeURIComponent(this.redirectUri));
        // If there is a code response or refresh token, push relevant variables. Throw error otherwise.
        if (this.codeResponse) {
            str.push(AADServerParamKeys.CODE + "=" + encodeURIComponent(this.codeResponse.code));
            str.push(AADServerParamKeys.CODE_VERIFIER + "=" + encodeURIComponent(this.tokenRequest.codeVerifier));
            str.push(AADServerParamKeys.GRANT_TYPE + "=" + Constants.CODE_GRANT_TYPE);
        }
        else if (!StringUtils.isEmpty(this.refreshToken)) {
            str.push(AADServerParamKeys.REFRESH_TOKEN + "=" + this.refreshToken);
            str.push(AADServerParamKeys.GRANT_TYPE + "=" + Constants.RT_GRANT_TYPE);
        }
        else {
            throw ClientAuthError.createTokenRequestCannotBeMadeError();
        }
        // Temporary until server allows CORS requests from browser without client secret
        str.push("client_secret=" + this.clientSecret);
        return str;
    };
    return ServerTokenRequestParameters;
}(ServerRequestParameters));

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Utility class which exposes functions for managing date and time operations.
 */
var TimeUtils = /** @class */ (function () {
    function TimeUtils() {
    }
    /**
     * Returns time in seconds for expiration based on string value passed in.
     *
     * @param expiresIn
     */
    TimeUtils.parseExpiresInSeconds = function (expiresIn) {
        // if AAD did not send "expires_in" property, use default expiration of 3599 seconds, for some reason AAD sends 3599 as "expires_in" value instead of 3600
        return expiresIn || 3599;
    };
    /**
     * return the current time in Unix time (seconds).
     */
    TimeUtils.nowSeconds = function () {
        // Date.getTime() returns in milliseconds.
        return Math.round(new Date().getTime() / 1000.0);
    };
    return TimeUtils;
}());

/**
 * Url object class which can perform various transformations on url strings.
 */
var UrlString = /** @class */ (function () {
    function UrlString(url) {
        this._urlString = url;
        if (this._urlString && StringUtils.isEmpty(this.getHash())) {
            this._urlString = this.canonicalizeUri(url);
        }
    }
    Object.defineProperty(UrlString.prototype, "urlString", {
        get: function () {
            return this._urlString;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Ensure urls are lower case and end with a / character.
     * @param url
     */
    UrlString.prototype.canonicalizeUri = function (url) {
        if (url) {
            url = url.toLowerCase();
        }
        if (url && !url.endsWith("/")) {
            url += "/";
        }
        return url;
    };
    /**
     * Throws if urlString passed is not a valid authority URI string.
     */
    UrlString.prototype.validateAsUri = function () {
        // Attempts to parse url for uri components
        var components;
        try {
            components = this.getUrlComponents();
        }
        catch (e) {
            throw ClientConfigurationError.createUrlParseError(e);
        }
        // Throw error if uri is insecure.
        if (!components.Protocol || components.Protocol.toLowerCase() !== "https:") {
            throw ClientConfigurationError.createInsecureAuthorityUriError(this.urlString);
        }
        // Throw error if path segments are not parseable.
        if (!components.PathSegments || components.PathSegments.length < 1) {
            throw ClientConfigurationError.createUrlParseError("Given url string: " + this.urlString);
        }
    };
    /**
     * Function to remove query string params from url. Returns the new url.
     * @param url
     * @param name
     */
    UrlString.prototype.urlRemoveQueryStringParameter = function (name) {
        if (StringUtils.isEmpty(this.urlString)) {
            throw ClientConfigurationError.createUrlEmptyError();
        }
        var regex = new RegExp("(\\&" + name + "=)[^\&]+");
        this._urlString = this.urlString.replace(regex, "");
        // name=value&
        regex = new RegExp("(" + name + "=)[^\&]+&");
        this._urlString = this.urlString.replace(regex, "");
        // name=value
        regex = new RegExp("(" + name + "=)[^\&]+");
        this._urlString = this.urlString.replace(regex, "");
        return this.urlString;
    };
    /**
     * Given a url like https://a:b/common/d?e=f#g, and a tenantId, returns https://a:b/tenantId/d
     * @param href The url
     * @param tenantId The tenant id to replace
     */
    UrlString.prototype.replaceTenantPath = function (tenantId) {
        var urlObject = this.getUrlComponents();
        var pathArray = urlObject.PathSegments;
        if (tenantId && (pathArray.length !== 0 && (pathArray[0] === AADAuthorityConstants.COMMON || pathArray[0] === AADAuthorityConstants.ORGANIZATIONS))) {
            pathArray[0] = tenantId;
        }
        return UrlString.constructAuthorityUriFromObject(urlObject);
    };
    /**
     * Returns the anchor part(#) of the URL
     */
    UrlString.prototype.getHash = function () {
        var hashIndex1 = this.urlString.indexOf("#");
        var hashIndex2 = this.urlString.indexOf("#/");
        if (hashIndex2 > -1) {
            return this.urlString.substring(hashIndex2 + 2);
        }
        else if (hashIndex1 > -1) {
            return this.urlString.substring(hashIndex1 + 1);
        }
        return "";
    };
    /**
     * Returns deserialized portion of URL hash
     */
    UrlString.prototype.getDeserializedHash = function () {
        var hash = this.getHash();
        var deserializedHash = StringUtils.queryStringToObject(hash);
        if (!deserializedHash) {
            throw ClientAuthError.createHashNotDeserializedError(JSON.stringify(deserializedHash));
        }
        return deserializedHash;
    };
    /**
     * Parses out the components from a url string.
     * @returns An object with the various components. Please cache this value insted of calling this multiple times on the same url.
     */
    UrlString.prototype.getUrlComponents = function () {
        // Throws error if url is empty
        if (!this.urlString) {
            throw ClientConfigurationError.createUrlEmptyError();
        }
        // https://gist.github.com/curtisz/11139b2cfcaef4a261e0
        var regEx = RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");
        // If url string does not match regEx, we throw an error
        var match = this.urlString.match(regEx);
        if (!match) {
            throw ClientConfigurationError.createUrlParseError("Given url string: " + this.urlString);
        }
        // Url component object
        var urlComponents = {
            Protocol: match[1],
            HostNameAndPort: match[4],
            AbsolutePath: match[5]
        };
        var pathSegments = urlComponents.AbsolutePath.split("/");
        pathSegments = pathSegments.filter(function (val) { return val && val.length > 0; }); // remove empty elements
        urlComponents.PathSegments = pathSegments;
        return urlComponents;
    };
    UrlString.constructAuthorityUriFromObject = function (urlObject) {
        return new UrlString(urlObject.Protocol + "//" + urlObject.HostNameAndPort + "/" + urlObject.PathSegments.join("/"));
    };
    /**
     * Check if the hash of the URL string contains known properties
     */
    UrlString.hashContainsKnownProperties = function (url) {
        if (StringUtils.isEmpty(url)) {
            return false;
        }
        var urlString = new UrlString(url);
        var parameters = urlString.getDeserializedHash();
        return !!(parameters.error_description ||
            parameters.error ||
            parameters.state);
    };
    return UrlString;
}());

/**
 * Key to cache access tokens, id tokens, and refresh tokens. Helps manage token renewal.
 */
var AccessTokenKey = /** @class */ (function () {
    function AccessTokenKey(authority, clientId, scopes, resource, uid, utid, cryptoObj) {
        var authorityUri = new UrlString(authority);
        this.authority = authorityUri.urlString;
        this.clientId = clientId;
        this.scopes = scopes;
        this.resource = resource;
        if (!StringUtils.isEmpty(uid) && !StringUtils.isEmpty(utid)) {
            this.homeAccountIdentifier = cryptoObj.base64Encode(uid) + "." + cryptoObj.base64Encode(utid);
        }
    }
    return AccessTokenKey;
}());

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Value of access token cache item which is stored in cache. Helps manage token renewal.
 */
var AccessTokenValue = /** @class */ (function () {
    function AccessTokenValue(tokenType, accessToken, idToken, refreshToken, expiresOn, extExpiresOn) {
        this.tokenType = tokenType;
        this.accessToken = accessToken;
        this.idToken = idToken;
        this.refreshToken = refreshToken;
        this.expiresOnSec = expiresOn;
        this.extExpiresOnSec = extExpiresOn;
    }
    return AccessTokenValue;
}());

/**
 * Error thrown when there is an error with the server code, for example, unavailability.
 */
var ServerError = /** @class */ (function (_super) {
    __extends(ServerError, _super);
    function ServerError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ServerError";
        Object.setPrototypeOf(_this, ServerError.prototype);
        return _this;
    }
    return ServerError;
}(AuthError));

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Function which validates server authorization code response.
 * @param serverResponseHash
 * @param cachedState
 * @param cryptoObj
 */
function validateServerAuthorizationCodeResponse(serverResponseHash, cachedState, cryptoObj) {
    if (serverResponseHash.state !== cachedState) {
        throw ClientAuthError.createStateMismatchError();
    }
    // Check for error
    if (serverResponseHash.error || serverResponseHash.error_description) {
        throw new ServerError(serverResponseHash.error, serverResponseHash.error_description);
    }
    if (serverResponseHash.client_info) {
        buildClientInfo(serverResponseHash.client_info, cryptoObj);
    }
}

/**
 * Class that handles response parsing.
 */
var ResponseHandler = /** @class */ (function () {
    function ResponseHandler(clientId, cacheStorage, cacheManager, cryptoObj, logger) {
        this.clientId = clientId;
        this.cacheStorage = cacheStorage;
        this.cacheManager = cacheManager;
        this.cryptoObj = cryptoObj;
        this.logger = logger;
    }
    /**
     * Returns a new response with the data from original response filled with the relevant IdToken data.
     * - raw id token
     * - id token claims
     * - unique id (oid or sub claim of token)
     * - tenant id (tid claim of token)
     * @param originalResponse
     * @param idTokenObj
     */
    ResponseHandler.setResponseIdToken = function (originalResponse, idTokenObj) {
        if (!originalResponse) {
            return null;
        }
        else if (!idTokenObj) {
            return originalResponse;
        }
        var expiresSeconds = Number(idTokenObj.claims.exp);
        if (expiresSeconds && !originalResponse.expiresOn) {
            originalResponse.expiresOn = new Date(expiresSeconds * 1000);
        }
        return __assign(__assign({}, originalResponse), { idToken: idTokenObj.rawIdToken, idTokenClaims: idTokenObj.claims, uniqueId: idTokenObj.claims.oid || idTokenObj.claims.sub, tenantId: idTokenObj.claims.tid });
    };
    /**
     * Validates and handles a response from the server, and returns a constructed object with the authorization code and state.
     * @param serverParams
     */
    ResponseHandler.prototype.handleServerCodeResponse = function (serverParams) {
        try {
            // Validate hash fragment response parameters
            validateServerAuthorizationCodeResponse(serverParams, this.cacheStorage.getItem(TemporaryCacheKeys.REQUEST_STATE), this.cryptoObj);
            // Cache client info
            if (serverParams.client_info) {
                this.cacheStorage.setItem(PersistentCacheKeys.CLIENT_INFO, serverParams.client_info);
            }
            // Create response object
            var response = {
                code: serverParams.code,
                userRequestState: serverParams.state
            };
            return response;
        }
        catch (e) {
            this.cacheManager.resetTempCacheItems(serverParams && serverParams.state);
            throw e;
        }
    };
    /**
     * Helper function which saves or updates the token in the cache and constructs the final token response to send back to the user.
     * @param originalTokenResponse
     * @param authority
     * @param resource
     * @param serverTokenResponse
     * @param clientInfo
     */
    ResponseHandler.prototype.saveToken = function (originalTokenResponse, authority, resource, serverTokenResponse, clientInfo) {
        var _this = this;
        // Set consented scopes in response
        var responseScopes = ScopeSet.fromString(serverTokenResponse.scope, this.clientId, true);
        var responseScopeArray = responseScopes.asArray();
        // Expiration calculation
        var expiresIn = TimeUtils.parseExpiresInSeconds(serverTokenResponse.expires_in);
        var expirationSec = TimeUtils.nowSeconds() + expiresIn;
        var extendedExpirationSec = expirationSec + TimeUtils.parseExpiresInSeconds(serverTokenResponse.ext_expires_in);
        // Get id token
        if (!StringUtils.isEmpty(originalTokenResponse.idToken)) {
            this.cacheStorage.setItem(PersistentCacheKeys.ID_TOKEN, originalTokenResponse.idToken);
        }
        // Save access token in cache
        var newAccessTokenValue = new AccessTokenValue(serverTokenResponse.token_type, serverTokenResponse.access_token, originalTokenResponse.idToken, serverTokenResponse.refresh_token, expirationSec.toString(), extendedExpirationSec.toString());
        var homeAccountIdentifier = originalTokenResponse.account && originalTokenResponse.account.homeAccountIdentifier;
        var accessTokenCacheItems = this.cacheManager.getAllAccessTokens(this.clientId, authority || "", resource || "", homeAccountIdentifier || "");
        // If no items in cache with these parameters, set new item.
        if (accessTokenCacheItems.length < 1) {
            this.logger.info("No tokens found, creating new item.");
            var newTokenKey = new AccessTokenKey(authority, this.clientId, serverTokenResponse.scope, resource, clientInfo && clientInfo.uid, clientInfo && clientInfo.utid, this.cryptoObj);
            this.cacheStorage.setItem(JSON.stringify(newTokenKey), JSON.stringify(newAccessTokenValue));
        }
        else {
            // Check if scopes are intersecting. If they are, combine scopes and replace cache item.
            accessTokenCacheItems.forEach(function (accessTokenCacheItem) {
                var cachedScopes = ScopeSet.fromString(accessTokenCacheItem.key.scopes, _this.clientId, true);
                if (cachedScopes.intersectingScopeSets(responseScopes)) {
                    _this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
                    cachedScopes.appendScopes(responseScopeArray);
                    accessTokenCacheItem.key.scopes = cachedScopes.printScopes();
                    if (StringUtils.isEmpty(newAccessTokenValue.idToken)) {
                        newAccessTokenValue.idToken = accessTokenCacheItem.value.idToken;
                    }
                    _this.cacheStorage.setItem(JSON.stringify(accessTokenCacheItem.key), JSON.stringify(newAccessTokenValue));
                }
            });
        }
        // Save tokens in response and return
        return __assign(__assign({}, originalTokenResponse), { scopes: responseScopeArray, accessToken: serverTokenResponse.access_token, refreshToken: serverTokenResponse.refresh_token, expiresOn: new Date(expirationSec * 1000) });
    };
    /**
     * Gets account cached with given key. Returns null if parsing could not be completed.
     * @param accountKey
     */
    ResponseHandler.prototype.getCachedAccount = function (accountKey) {
        try {
            return JSON.parse(this.cacheStorage.getItem(accountKey));
        }
        catch (e) {
            this.logger.warning("Account could not be parsed: " + JSON.stringify(e));
            return null;
        }
    };
    /**
     * Returns a constructed token response based on given string. Also manages the cache updates and cleanups.
     * @param serverTokenResponse
     * @param authorityString
     * @param resource
     * @param state
     */
    ResponseHandler.prototype.createTokenResponse = function (serverTokenResponse, authorityString, resource, state) {
        var tokenResponse = {
            uniqueId: "",
            tenantId: "",
            tokenType: "",
            idToken: null,
            idTokenClaims: null,
            accessToken: "",
            refreshToken: "",
            scopes: [],
            expiresOn: null,
            account: null,
            userRequestState: ""
        };
        // Retrieve current id token object
        var idTokenObj;
        var cachedIdToken = this.cacheStorage.getItem(PersistentCacheKeys.ID_TOKEN);
        if (serverTokenResponse.id_token) {
            idTokenObj = new IdToken(serverTokenResponse.id_token, this.cryptoObj);
            tokenResponse = ResponseHandler.setResponseIdToken(tokenResponse, idTokenObj);
        }
        else if (cachedIdToken) {
            idTokenObj = new IdToken(cachedIdToken, this.cryptoObj);
            tokenResponse = ResponseHandler.setResponseIdToken(tokenResponse, idTokenObj);
        }
        else {
            idTokenObj = null;
        }
        var clientInfo = null;
        var cachedAccount = null;
        if (idTokenObj) {
            // If state is empty, refresh token is being used
            if (!StringUtils.isEmpty(state)) {
                this.logger.info("State was detected - nonce should be available.");
                // check nonce integrity if refresh token is not used - throw an error if not matched        
                if (!idTokenObj.claims.nonce) {
                    throw ClientAuthError.createInvalidIdTokenError(idTokenObj);
                }
                var nonce = this.cacheStorage.getItem(this.cacheManager.generateNonceKey(state));
                if (idTokenObj.claims.nonce !== nonce) {
                    throw ClientAuthError.createNonceMismatchError();
                }
            }
            // Retrieve client info
            clientInfo = buildClientInfo(this.cacheStorage.getItem(PersistentCacheKeys.CLIENT_INFO), this.cryptoObj);
            // Create account object for request
            tokenResponse.account = Account.createAccount(idTokenObj, clientInfo, this.cryptoObj);
            // Save the access token if it exists
            var accountKey = this.cacheManager.generateAcquireTokenAccountKey(tokenResponse.account.homeAccountIdentifier);
            // Get cached account
            cachedAccount = this.getCachedAccount(accountKey);
        }
        // Return user set state in the response
        tokenResponse.userRequestState = ProtocolUtils.getUserRequestState(state);
        this.cacheManager.resetTempCacheItems(state);
        if (!cachedAccount || !tokenResponse.account || Account.compareAccounts(cachedAccount, tokenResponse.account)) {
            return this.saveToken(tokenResponse, authorityString, resource, serverTokenResponse, clientInfo);
        }
        else {
            this.logger.error("Accounts do not match.");
            this.logger.errorPii("Cached Account: " + JSON.stringify(cachedAccount) + ", New Account: " + JSON.stringify(tokenResponse.account));
            throw ClientAuthError.createAccountMismatchError();
        }
    };
    return ResponseHandler;
}());

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Function which validates server authorization token response.
 * @param serverResponse
 */
function validateServerAuthorizationTokenResponse(serverResponse) {
    // Check for error
    if (serverResponse.error || serverResponse.error_description) {
        var errString = serverResponse.error_codes + " - [" + serverResponse.timestamp + "]: " + serverResponse.error_description + " - Correlation ID: " + serverResponse.correlation_id + " - Trace ID: " + serverResponse.trace_id;
        throw new ServerError(serverResponse.error, errString);
    }
}

/**
 * The authority class validates the authority URIs used by the user, and retrieves the OpenID Configuration Data from the
 * endpoint. It will store the pertinent config data in this object for use during token calls.
 */
var Authority = /** @class */ (function () {
    function Authority(authority, networkInterface) {
        this.canonicalAuthority = authority;
        this._canonicalAuthority.validateAsUri();
        this.networkInterface = networkInterface;
    }
    Object.defineProperty(Authority.prototype, "canonicalAuthority", {
        /**
         * A URL that is the authority set by the developer
         */
        get: function () {
            return this._canonicalAuthority.urlString;
        },
        /**
         * Sets canonical authority.
         */
        set: function (url) {
            this._canonicalAuthority = new UrlString(url);
            this._canonicalAuthorityUrlComponents = null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "canonicalAuthorityUrlComponents", {
        /**
         * Get authority components.
         */
        get: function () {
            if (!this._canonicalAuthorityUrlComponents) {
                this._canonicalAuthorityUrlComponents = this._canonicalAuthority.getUrlComponents();
            }
            return this._canonicalAuthorityUrlComponents;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "tenant", {
        /**
         * Get tenant for authority.
         */
        get: function () {
            return this._canonicalAuthorityUrlComponents.PathSegments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "authorizationEndpoint", {
        /**
         * OAuth /authorize endpoint for requests
         */
        get: function () {
            if (this.discoveryComplete()) {
                return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);
            }
            else {
                throw ClientAuthError.createEndpointDiscoveryIncompleteError("Discovery incomplete.");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "tokenEndpoint", {
        /**
         * OAuth /token endpoint for requests
         */
        get: function () {
            if (this.discoveryComplete()) {
                return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);
            }
            else {
                throw ClientAuthError.createEndpointDiscoveryIncompleteError("Discovery incomplete.");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "endSessionEndpoint", {
        /**
         * OAuth logout endpoint for requests
         */
        get: function () {
            if (this.discoveryComplete()) {
                return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);
            }
            else {
                throw ClientAuthError.createEndpointDiscoveryIncompleteError("Discovery incomplete.");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "selfSignedJwtAudience", {
        /**
         * OAuth issuer for requests
         */
        get: function () {
            if (this.discoveryComplete()) {
                return this.replaceTenant(this.tenantDiscoveryResponse.issuer);
            }
            else {
                throw ClientAuthError.createEndpointDiscoveryIncompleteError("Discovery incomplete.");
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Replaces tenant in url path with current tenant. Defaults to common.
     * @param urlString
     */
    Authority.prototype.replaceTenant = function (urlString) {
        return urlString.replace("{tenant}", this.tenant);
    };
    Object.defineProperty(Authority.prototype, "defaultOpenIdConfigurationEndpoint", {
        /**
         * The default open id configuration endpoint for any canonical authority.
         */
        get: function () {
            return this.canonicalAuthority + "v2.0/.well-known/openid-configuration";
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Boolean that returns whethr or not tenant discovery has been completed.
     */
    Authority.prototype.discoveryComplete = function () {
        return !!this.tenantDiscoveryResponse;
    };
    /**
     * Gets OAuth endpoints from the given OpenID configuration endpoint.
     * @param openIdConfigurationEndpoint
     */
    Authority.prototype.discoverEndpoints = function (openIdConfigurationEndpoint) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.networkInterface.sendGetRequestAsync(openIdConfigurationEndpoint)];
            });
        });
    };
    /**
     * Perform endpoint discovery to discover the /authorize, /token and logout endpoints.
     */
    Authority.prototype.resolveEndpointsAsync = function () {
        return __awaiter(this, void 0, void 0, function () {
            var openIdConfigEndpoint, _a;
            return __generator(this, function (_b) {
                switch (_b.label) {
                    case 0: return [4 /*yield*/, this.getOpenIdConfigurationAsync()];
                    case 1:
                        openIdConfigEndpoint = _b.sent();
                        _a = this;
                        return [4 /*yield*/, this.discoverEndpoints(openIdConfigEndpoint)];
                    case 2:
                        _a.tenantDiscoveryResponse = _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return Authority;
}());

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Authority types supported by MSAL.
 */
var AuthorityType;
(function (AuthorityType) {
    AuthorityType[AuthorityType["Aad"] = 0] = "Aad";
    AuthorityType[AuthorityType["Adfs"] = 1] = "Adfs";
    AuthorityType[AuthorityType["B2C"] = 2] = "B2C";
})(AuthorityType || (AuthorityType = {}));

/**
 * The AadAuthority class extends the Authority class and adds functionality specific to the Azure AD OAuth Authority.
 */
var AadAuthority = /** @class */ (function (_super) {
    __extends(AadAuthority, _super);
    function AadAuthority(authority, networkInterface) {
        return _super.call(this, authority, networkInterface) || this;
    }
    Object.defineProperty(AadAuthority.prototype, "authorityType", {
        // Set authority type to AAD
        get: function () {
            return AuthorityType.Aad;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AadAuthority.prototype, "isValidationEnabled", {
        get: function () {
            // Hardcoded to true for now - may change depending on requirements
            return true;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AadAuthority.prototype, "aadInstanceDiscoveryEndpointUrl", {
        get: function () {
            return AadAuthority.aadInstanceDiscoveryEndpoint + "?api-version=1.0&authorization_endpoint=" + this.canonicalAuthority + "oauth2/v2.0/authorize";
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Returns a promise which resolves to the OIDC endpoint
     * Only responds with the endpoint
     */
    AadAuthority.prototype.getOpenIdConfigurationAsync = function () {
        return __awaiter(this, void 0, void 0, function () {
            var response;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.isValidationEnabled || this.isInTrustedHostList(this.canonicalAuthorityUrlComponents.HostNameAndPort)) {
                            return [2 /*return*/, this.defaultOpenIdConfigurationEndpoint];
                        }
                        return [4 /*yield*/, this.networkInterface.sendGetRequestAsync(this.aadInstanceDiscoveryEndpointUrl)];
                    case 1:
                        response = _a.sent();
                        return [2 /*return*/, response.tenant_discovery_endpoint];
                }
            });
        });
    };
    /**
     * Checks to see if the host is in a list of trusted hosts
     * @param {string} The host to look up
     */
    AadAuthority.prototype.isInTrustedHostList = function (host) {
        return AADTrustedHostList.includes(host);
    };
    // Default AAD Instance Discovery Endpoint
    AadAuthority.aadInstanceDiscoveryEndpoint = "https://login.microsoftonline.com/common/discovery/instance";
    return AadAuthority;
}(Authority));

var AuthorityFactory = /** @class */ (function () {
    function AuthorityFactory() {
    }
    /**
     * Parse the url and determine the type of authority
     */
    AuthorityFactory.detectAuthorityFromUrl = function (authorityString) {
        var authorityUrl = new UrlString(authorityString);
        var components = authorityUrl.getUrlComponents();
        var pathSegments = components.PathSegments;
        switch (pathSegments[0]) {
            case "tfp":
                // tfp denotes a b2c url
                return AuthorityType.B2C;
            default:
                // default authority is always AAD
                return AuthorityType.Aad;
        }
    };
    /**
     * Create an authority object of the correct type based on the url
     * Performs basic authority validation - checks to see if the authority is of a valid type (eg aad, b2c)
     */
    AuthorityFactory.createInstance = function (authorityUrl, networkInterface) {
        // Return null if authority url is empty
        if (StringUtils.isEmpty(authorityUrl)) {
            return null;
        }
        var type = AuthorityFactory.detectAuthorityFromUrl(authorityUrl);
        // Depending on above detection, create the right type.
        switch (type) {
            case AuthorityType.Aad:
                return new AadAuthority(authorityUrl, networkInterface);
            default:
                throw ClientConfigurationError.createInvalidAuthorityTypeError("Given Url: " + authorityUrl);
        }
    };
    // default authority
    AuthorityFactory.DEFAULT_AUTHORITY = "https://login.microsoftonline.com/common";
    return AuthorityFactory;
}());

/**
 * AuthorizationCodeModule class
 *
 * Object instance which will construct requests to send to and handle responses
 * from the Microsoft STS using the authorization code flow.
 */
var AuthorizationCodeModule = /** @class */ (function (_super) {
    __extends(AuthorizationCodeModule, _super);
    function AuthorizationCodeModule(configuration) {
        var _this = 
        // Implement base module
        _super.call(this, {
            systemOptions: configuration.systemOptions,
            loggerOptions: configuration.loggerOptions,
            storageInterface: configuration.storageInterface,
            networkInterface: configuration.networkInterface,
            cryptoInterface: configuration.cryptoInterface
        }) || this;
        // Implement defaults in config
        _this.clientConfig = buildPublicClientSPAConfiguration(configuration);
        if (_this.clientConfig.auth.tmp_clientSecret) {
            _this.logger.warning("Client secret is a temporary parameter that will not be carried forward in production versions of this library.");
        }
        // Initialize default authority instance
        _this.defaultAuthorityInstance = AuthorityFactory.createInstance(_this.clientConfig.auth.authority || AuthorityFactory.DEFAULT_AUTHORITY, _this.networkClient);
        return _this;
    }
    /**
     * Creates a url for logging in a user. This will by default append the client id to the list of scopes,
     * allowing you to retrieve an id token in the subsequent code exchange. Also performs validation of the request parameters.
     * Including any SSO parameters (account, sid, login_hint) will short circuit the authentication and allow you to retrieve a code without interaction.
     * @param request
     */
    AuthorizationCodeModule.prototype.createLoginUrl = function (request) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.createUrl(request, true)];
            });
        });
    };
    /**
     * Creates a url for logging in a user. Also performs validation of the request parameters.
     * Including any SSO parameters (account, sid, login_hint) will short circuit the authentication and allow you to retrieve a code without interaction.
     * @param request
     */
    AuthorizationCodeModule.prototype.createAcquireTokenUrl = function (request) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.createUrl(request, false)];
            });
        });
    };
    /**
     * Helper function which creates URL. If isLoginCall is true, MSAL appends client id scope to retrieve id token from the service.
     * @param request
     * @param isLoginCall
     */
    AuthorizationCodeModule.prototype.createUrl = function (request, isLoginCall) {
        return __awaiter(this, void 0, void 0, function () {
            var acquireTokenAuthority, e_1, requestParameters, adalIdToken, adalIdTokenString, urlNavigate, tokenRequest, e_2;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        acquireTokenAuthority = (request && request.authority) ? AuthorityFactory.createInstance(request.authority, this.networkClient) : this.defaultAuthorityInstance;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, acquireTokenAuthority.resolveEndpointsAsync()];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        e_1 = _a.sent();
                        throw ClientAuthError.createEndpointDiscoveryIncompleteError(e_1);
                    case 4:
                        _a.trys.push([4, 6, , 7]);
                        requestParameters = new ServerCodeRequestParameters(acquireTokenAuthority, this.clientConfig.auth.clientId, request, this.getAccount(), this.getRedirectUri(), this.cryptoObj, isLoginCall);
                        adalIdToken = null;
                        if (!requestParameters.hasSSOParam()) {
                            adalIdTokenString = this.cacheStorage.getItem(PersistentCacheKeys.ADAL_ID_TOKEN);
                            if (!StringUtils.isEmpty(adalIdTokenString)) {
                                adalIdToken = new IdToken(adalIdTokenString, this.cryptoObj);
                                this.cacheStorage.removeItem(PersistentCacheKeys.ADAL_ID_TOKEN);
                            }
                        }
                        // Update required cache entries for request.
                        this.cacheManager.updateCacheEntries(requestParameters, request.account);
                        // Populate query parameters (sid/login_hint/domain_hint) and any other extraQueryParameters set by the developer.
                        requestParameters.populateQueryParams(adalIdToken);
                        return [4 /*yield*/, requestParameters.createNavigateUrl()];
                    case 5:
                        urlNavigate = _a.sent();
                        tokenRequest = {
                            scopes: requestParameters.scopes.getOriginalScopesAsArray(),
                            resource: request.resource,
                            codeVerifier: requestParameters.generatedPkce.verifier,
                            extraQueryParameters: request.extraQueryParameters,
                            authority: requestParameters.authorityInstance.canonicalAuthority,
                            correlationId: requestParameters.correlationId
                        };
                        this.cacheStorage.setItem(TemporaryCacheKeys.REQUEST_PARAMS, this.cryptoObj.base64Encode(JSON.stringify(tokenRequest)));
                        return [2 /*return*/, urlNavigate];
                    case 6:
                        e_2 = _a.sent();
                        // Reset cache items before re-throwing.
                        this.cacheManager.resetTempCacheItems(requestParameters && requestParameters.state);
                        throw e_2;
                    case 7: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Given an authorization code, it will perform a token exchange using cached values from a previous call to
     * createLoginUrl() or createAcquireTokenUrl(). You must call this AFTER using one of those APIs first. You should
     * also use the handleFragmentResponse() API to pass the codeResponse to this function afterwards.
     * @param codeResponse
     */
    AuthorizationCodeModule.prototype.acquireToken = function (codeResponse) {
        return __awaiter(this, void 0, void 0, function () {
            var tokenRequest, acquireTokenAuthority, e_3, tokenEndpoint, tokenReqParams, e_4;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 5, , 6]);
                        tokenRequest = this.getCachedRequest(codeResponse.userRequestState);
                        // If no code response is given, we cannot acquire a token.
                        if (!codeResponse || !codeResponse.code) {
                            throw ClientAuthError.createTokenRequestCannotBeMadeError();
                        }
                        acquireTokenAuthority = (tokenRequest && tokenRequest.authority) ? AuthorityFactory.createInstance(tokenRequest.authority, this.networkClient) : this.defaultAuthorityInstance;
                        if (!!acquireTokenAuthority.discoveryComplete()) return [3 /*break*/, 4];
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, acquireTokenAuthority.resolveEndpointsAsync()];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        e_3 = _a.sent();
                        throw ClientAuthError.createEndpointDiscoveryIncompleteError(e_3);
                    case 4:
                        tokenEndpoint = acquireTokenAuthority.tokenEndpoint;
                        tokenReqParams = new ServerTokenRequestParameters(this.clientConfig.auth.clientId, this.clientConfig.auth.tmp_clientSecret, tokenRequest, codeResponse, this.getRedirectUri(), this.cryptoObj);
                        // User helper to retrieve token response.
                        return [2 /*return*/, this.getTokenResponse(tokenEndpoint, tokenReqParams, tokenRequest, codeResponse)];
                    case 5:
                        e_4 = _a.sent();
                        // Reset cache items and set account to null before re-throwing.
                        this.cacheManager.resetTempCacheItems(codeResponse && codeResponse.userRequestState);
                        this.account = null;
                        throw e_4;
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Retrieves a token from cache if it is still valid, or uses the cached refresh token to renew
     * the given token and returns the renewed token. Will throw an error if login is not completed (unless
     * id tokens are not being renewed).
     * @param request
     */
    AuthorizationCodeModule.prototype.renewToken = function (request) {
        return __awaiter(this, void 0, void 0, function () {
            var account, requestScopes, acquireTokenAuthority, e_5, cachedTokenItem, expirationSec, offsetCurrentTimeSec, cachedScopes, defaultTokenResponse, tokenEndpoint, tokenReqParams, e_6;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 5, , 6]);
                        // Cannot renew token if no request object is given.
                        if (!request) {
                            throw ClientConfigurationError.createEmptyTokenRequestError();
                        }
                        account = request.account || this.getAccount();
                        requestScopes = new ScopeSet(request.scopes, this.clientConfig.auth.clientId, true);
                        // If this is an id token renewal, and no account is present, throw an error.
                        if (requestScopes.isLoginScopeSet()) {
                            if (!account) {
                                throw ClientAuthError.createUserLoginRequiredError();
                            }
                        }
                        acquireTokenAuthority = request.authority ? AuthorityFactory.createInstance(request.authority, this.networkClient) : this.defaultAuthorityInstance;
                        if (!!acquireTokenAuthority.discoveryComplete()) return [3 /*break*/, 4];
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, acquireTokenAuthority.resolveEndpointsAsync()];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        e_5 = _a.sent();
                        throw ClientAuthError.createEndpointDiscoveryIncompleteError(e_5);
                    case 4:
                        cachedTokenItem = this.getCachedTokens(requestScopes, acquireTokenAuthority.canonicalAuthority, request.resource, account && account.homeAccountIdentifier);
                        expirationSec = Number(cachedTokenItem.value.expiresOnSec);
                        offsetCurrentTimeSec = TimeUtils.nowSeconds() + this.clientConfig.systemOptions.tokenRenewalOffsetSeconds;
                        // Check if refresh is forced, or if tokens are expired. If neither are true, return a token response with the found token entry.
                        if (!request.forceRefresh && expirationSec && expirationSec > offsetCurrentTimeSec) {
                            cachedScopes = ScopeSet.fromString(cachedTokenItem.key.scopes, this.clientConfig.auth.clientId, true);
                            defaultTokenResponse = {
                                uniqueId: "",
                                tenantId: "",
                                scopes: cachedScopes.asArray(),
                                tokenType: cachedTokenItem.value.tokenType,
                                idToken: "",
                                idTokenClaims: null,
                                accessToken: cachedTokenItem.value.accessToken,
                                refreshToken: cachedTokenItem.value.refreshToken,
                                expiresOn: new Date(expirationSec * 1000),
                                account: account,
                                userRequestState: ""
                            };
                            // Only populate id token if it exists in cache item.
                            return [2 /*return*/, StringUtils.isEmpty(cachedTokenItem.value.idToken) ? defaultTokenResponse :
                                    ResponseHandler.setResponseIdToken(defaultTokenResponse, new IdToken(cachedTokenItem.value.idToken, this.cryptoObj))];
                        }
                        else {
                            // Renew the tokens.
                            request.authority = cachedTokenItem.key.authority;
                            tokenEndpoint = acquireTokenAuthority.tokenEndpoint;
                            tokenReqParams = new ServerTokenRequestParameters(this.clientConfig.auth.clientId, this.clientConfig.auth.tmp_clientSecret, request, null, this.getRedirectUri(), this.cryptoObj, cachedTokenItem.value.refreshToken);
                            // User helper to retrieve token response.
                            return [2 /*return*/, this.getTokenResponse(tokenEndpoint, tokenReqParams, request)];
                        }
                    case 5:
                        e_6 = _a.sent();
                        // Reset cache items and set account to null before re-throwing.
                        this.cacheManager.resetTempCacheItems();
                        this.account = null;
                        throw e_6;
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    // #region Logout
    /**
     * Use to log out the current user, and redirect the user to the postLogoutRedirectUri.
     * Default behaviour is to redirect the user to `window.location.href`.
     * @param authorityUri
     */
    AuthorizationCodeModule.prototype.logout = function (authorityUri) {
        return __awaiter(this, void 0, void 0, function () {
            var currentAccount, homeAccountIdentifier, postLogoutRedirectUri, acquireTokenAuthority, e_7, logoutUri;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        currentAccount = this.getAccount();
                        homeAccountIdentifier = currentAccount ? currentAccount.homeAccountIdentifier : "";
                        // Remove all pertinent access tokens.
                        this.cacheManager.removeAllAccessTokens(this.clientConfig.auth.clientId, authorityUri, "", homeAccountIdentifier);
                        // Clear remaining cache items.
                        this.cacheStorage.clear();
                        // Clear current account.
                        this.account = null;
                        postLogoutRedirectUri = "";
                        try {
                            postLogoutRedirectUri = "?" + AADServerParamKeys.POST_LOGOUT_URI + "=" + encodeURIComponent(this.getPostLogoutRedirectUri());
                        }
                        catch (e) { }
                        acquireTokenAuthority = (authorityUri) ? AuthorityFactory.createInstance(authorityUri, this.networkClient) : this.defaultAuthorityInstance;
                        if (!!acquireTokenAuthority.discoveryComplete()) return [3 /*break*/, 4];
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, acquireTokenAuthority.resolveEndpointsAsync()];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        e_7 = _a.sent();
                        throw ClientAuthError.createEndpointDiscoveryIncompleteError(e_7);
                    case 4:
                        logoutUri = "" + acquireTokenAuthority.endSessionEndpoint + postLogoutRedirectUri;
                        return [2 /*return*/, logoutUri];
                }
            });
        });
    };
    // #endregion
    // #region Response Handling
    /**
     * Handles the hash fragment response from public client code request. Returns a code response used by
     * the client to exchange for a token in acquireToken.
     * @param hashFragment
     */
    AuthorizationCodeModule.prototype.handleFragmentResponse = function (hashFragment) {
        // Handle responses.
        var responseHandler = new ResponseHandler(this.clientConfig.auth.clientId, this.cacheStorage, this.cacheManager, this.cryptoObj, this.logger);
        // Deserialize hash fragment response parameters.
        var hashUrlString = new UrlString(hashFragment);
        var serverParams = hashUrlString.getDeserializedHash();
        // Get code response
        return responseHandler.handleServerCodeResponse(serverParams);
    };
    // #endregion
    // #region Helpers
    /**
     * Gets the token exchange parameters from the cache. Throws an error if nothing is found.
     */
    AuthorizationCodeModule.prototype.getCachedRequest = function (state) {
        try {
            // Get token request from cache and parse as TokenExchangeParameters.
            var encodedTokenRequest = this.cacheStorage.getItem(TemporaryCacheKeys.REQUEST_PARAMS);
            var parsedRequest = JSON.parse(this.cryptoObj.base64Decode(encodedTokenRequest));
            this.cacheStorage.removeItem(TemporaryCacheKeys.REQUEST_PARAMS);
            // Get cached authority and use if no authority is given.
            if (!parsedRequest.authority) {
                var authorityKey = this.cacheManager.generateAuthorityKey(state);
                var cachedAuthority = this.cacheStorage.getItem(authorityKey);
                parsedRequest.authority = cachedAuthority;
            }
            return parsedRequest;
        }
        catch (err) {
            throw ClientAuthError.createTokenRequestCacheError(err);
        }
    };
    /**
     * Gets all cached tokens based on the given criteria.
     * @param requestScopes
     * @param authorityUri
     * @param resourceId
     * @param homeAccountIdentifier
     */
    AuthorizationCodeModule.prototype.getCachedTokens = function (requestScopes, authorityUri, resourceId, homeAccountIdentifier) {
        var _this = this;
        // Get all access tokens with matching authority, resource id and home account ID
        var tokenCacheItems = this.cacheManager.getAllAccessTokens(this.clientConfig.auth.clientId, authorityUri || "", resourceId || "", homeAccountIdentifier || "");
        if (tokenCacheItems.length === 0) {
            throw ClientAuthError.createNoTokensFoundError(requestScopes.printScopes());
        }
        // Filter cache items based on available scopes.
        var filteredCacheItems = tokenCacheItems.filter(function (cacheItem) {
            var cachedScopes = ScopeSet.fromString(cacheItem.key.scopes, _this.clientConfig.auth.clientId, true);
            return cachedScopes.containsScopeSet(requestScopes);
        });
        // If cache items contains too many matching tokens, throw error.
        if (filteredCacheItems.length > 1) {
            throw ClientAuthError.createMultipleMatchingTokensInCacheError(requestScopes.printScopes());
        }
        else if (filteredCacheItems.length === 1) {
            // Return single cache item.
            return filteredCacheItems[0];
        }
        // If cache items are empty, throw error.
        throw ClientAuthError.createNoTokensFoundError(requestScopes.printScopes());
    };
    /**
     * Makes a request to the token endpoint with the given parameters and parses the response.
     * @param tokenEndpoint
     * @param tokenReqParams
     * @param tokenRequest
     * @param codeResponse
     */
    AuthorizationCodeModule.prototype.getTokenResponse = function (tokenEndpoint, tokenReqParams, tokenRequest, codeResponse) {
        return __awaiter(this, void 0, void 0, function () {
            var acquiredTokenResponse, responseHandler, tokenResponse;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.networkClient.sendPostRequestAsync(tokenEndpoint, {
                            body: tokenReqParams.createRequestBody(),
                            headers: tokenReqParams.createRequestHeaders()
                        })];
                    case 1:
                        acquiredTokenResponse = _a.sent();
                        // Validate response. This function throws a server error if an error is returned by the server.
                        validateServerAuthorizationTokenResponse(acquiredTokenResponse);
                        responseHandler = new ResponseHandler(this.clientConfig.auth.clientId, this.cacheStorage, this.cacheManager, this.cryptoObj, this.logger);
                        tokenResponse = responseHandler.createTokenResponse(acquiredTokenResponse, tokenRequest.authority, tokenRequest.resource, codeResponse && codeResponse.userRequestState);
                        // Set current account to received response account, if any.
                        this.account = tokenResponse.account;
                        return [2 /*return*/, tokenResponse];
                }
            });
        });
    };
    // #endregion
    // #region Getters and setters
    /**
     *
     * Use to get the redirect uri configured in MSAL or null.
     * Evaluates redirectUri if its a function, otherwise simply returns its value.
     * @returns {string} redirect URL
     *
     */
    AuthorizationCodeModule.prototype.getRedirectUri = function () {
        if (this.clientConfig.auth.redirectUri) {
            if (typeof this.clientConfig.auth.redirectUri === "function") {
                return this.clientConfig.auth.redirectUri();
            }
            else if (!StringUtils.isEmpty(this.clientConfig.auth.redirectUri)) {
                return this.clientConfig.auth.redirectUri;
            }
        }
        // This should never throw unless window.location.href is returning empty.
        throw ClientConfigurationError.createRedirectUriEmptyError();
    };
    /**
     * Use to get the post logout redirect uri configured in MSAL or null.
     * Evaluates postLogoutredirectUri if its a function, otherwise simply returns its value.
     *
     * @returns {string} post logout redirect URL
     */
    AuthorizationCodeModule.prototype.getPostLogoutRedirectUri = function () {
        if (this.clientConfig.auth.postLogoutRedirectUri) {
            if (typeof this.clientConfig.auth.postLogoutRedirectUri === "function") {
                return this.clientConfig.auth.postLogoutRedirectUri();
            }
            else if (!StringUtils.isEmpty(this.clientConfig.auth.postLogoutRedirectUri)) {
                return this.clientConfig.auth.postLogoutRedirectUri;
            }
        }
        // This should never throw unless window.location.href is returning empty.
        throw ClientConfigurationError.createPostLogoutRedirectUriEmptyError();
    };
    return AuthorizationCodeModule;
}(AuthModule));

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * Builds a response that only sets state
 * @param responseState
 */
function buildResponseStateOnly(responseState) {
    return {
        userRequestState: responseState
    };
}

export { Account, AuthError, AuthErrorMessage, Authority, AuthorityFactory, AuthorizationCodeModule, ClientAuthError, ClientAuthErrorMessage, ClientConfigurationError, ClientConfigurationErrorMessage, Constants, LogLevel, PersistentCacheKeys, StringUtils, TemporaryCacheKeys, UrlString, buildResponseStateOnly };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguZXMuanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9lcnJvci9BdXRoRXJyb3IudHMiLCIuLi9zcmMvYXBwL2NvbmZpZy9Nb2R1bGVDb25maWd1cmF0aW9uLnRzIiwiLi4vc3JjL2NhY2hlL0FjY2Vzc1Rva2VuQ2FjaGVJdGVtLnRzIiwiLi4vc3JjL2Vycm9yL0NsaWVudEF1dGhFcnJvci50cyIsIi4uL3NyYy91dGlscy9TdHJpbmdVdGlscy50cyIsIi4uL3NyYy91dGlscy9Db25zdGFudHMudHMiLCIuLi9zcmMvY2FjaGUvQ2FjaGVIZWxwZXJzLnRzIiwiLi4vc3JjL2F1dGgvQWNjb3VudC50cyIsIi4uL3NyYy9hdXRoL0lkVG9rZW4udHMiLCIuLi9zcmMvYXV0aC9DbGllbnRJbmZvLnRzIiwiLi4vc3JjL2xvZ2dlci9Mb2dnZXIudHMiLCIuLi9zcmMvYXBwL21vZHVsZS9BdXRoTW9kdWxlLnRzIiwiLi4vc3JjL2FwcC9jb25maWcvUHVibGljQ2xpZW50U1BBQ29uZmlndXJhdGlvbi50cyIsIi4uL3NyYy9zZXJ2ZXIvU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMudHMiLCIuLi9zcmMvZXJyb3IvQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLnRzIiwiLi4vc3JjL2F1dGgvU2NvcGVTZXQudHMiLCIuLi9zcmMvcmVxdWVzdC9BdXRoZW50aWNhdGlvblBhcmFtZXRlcnMudHMiLCIuLi9zcmMvdXRpbHMvUHJvdG9jb2xVdGlscy50cyIsIi4uL3NyYy9zZXJ2ZXIvU2VydmVyQ29kZVJlcXVlc3RQYXJhbWV0ZXJzLnRzIiwiLi4vc3JjL3NlcnZlci9TZXJ2ZXJUb2tlblJlcXVlc3RQYXJhbWV0ZXJzLnRzIiwiLi4vc3JjL3V0aWxzL1RpbWVVdGlscy50cyIsIi4uL3NyYy91cmwvVXJsU3RyaW5nLnRzIiwiLi4vc3JjL2NhY2hlL0FjY2Vzc1Rva2VuS2V5LnRzIiwiLi4vc3JjL2NhY2hlL0FjY2Vzc1Rva2VuVmFsdWUudHMiLCIuLi9zcmMvZXJyb3IvU2VydmVyRXJyb3IudHMiLCIuLi9zcmMvc2VydmVyL1NlcnZlckF1dGhvcml6YXRpb25Db2RlUmVzcG9uc2UudHMiLCIuLi9zcmMvcmVzcG9uc2UvUmVzcG9uc2VIYW5kbGVyLnRzIiwiLi4vc3JjL3NlcnZlci9TZXJ2ZXJBdXRob3JpemF0aW9uVG9rZW5SZXNwb25zZS50cyIsIi4uL3NyYy9hdXRoL2F1dGhvcml0eS9BdXRob3JpdHkudHMiLCIuLi9zcmMvYXV0aC9hdXRob3JpdHkvQXV0aG9yaXR5VHlwZS50cyIsIi4uL3NyYy9hdXRoL2F1dGhvcml0eS9BYWRBdXRob3JpdHkudHMiLCIuLi9zcmMvYXV0aC9hdXRob3JpdHkvQXV0aG9yaXR5RmFjdG9yeS50cyIsIi4uL3NyYy9hcHAvbW9kdWxlL0F1dGhvcml6YXRpb25Db2RlTW9kdWxlLnRzIiwiLi4vc3JjL3Jlc3BvbnNlL0F1dGhSZXNwb25zZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBBdXRoRXJyb3JNZXNzYWdlIGNsYXNzIGNvbnRhaW5pbmcgc3RyaW5nIGNvbnN0YW50cyB1c2VkIGJ5IGVycm9yIGNvZGVzIGFuZCBtZXNzYWdlcy5cclxuICovXHJcbmV4cG9ydCBjb25zdCBBdXRoRXJyb3JNZXNzYWdlID0ge1xyXG4gICAgdW5leHBlY3RlZEVycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJ1bmV4cGVjdGVkX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJVbmV4cGVjdGVkIGVycm9yIGluIGF1dGhlbnRpY2F0aW9uLlwiXHJcbiAgICB9XHJcbn07XHJcblxyXG4vKipcclxuICogR2VuZXJhbCBlcnJvciBjbGFzcyB0aHJvd24gYnkgdGhlIE1TQUwuanMgbGlicmFyeS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBBdXRoRXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcblxyXG4gICAgLy8gU2hvcnQgc3RyaW5nIGRlbm90aW5nIGVycm9yXHJcbiAgICBlcnJvckNvZGU6IHN0cmluZztcclxuICAgIC8vIERldGFpbGVkIGRlc2NyaXB0aW9uIG9mIGVycm9yXHJcbiAgICBlcnJvck1lc3NhZ2U6IHN0cmluZztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihlcnJvckNvZGU6IHN0cmluZywgZXJyb3JNZXNzYWdlPzogc3RyaW5nKSB7XHJcbiAgICAgICAgc3VwZXIoZXJyb3JNZXNzYWdlKTtcclxuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgQXV0aEVycm9yLnByb3RvdHlwZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZXJyb3JDb2RlID0gZXJyb3JDb2RlO1xyXG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IFwiQXV0aEVycm9yXCI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIGVycm9yIHRoYXQgaXMgdGhyb3duIHdoZW4gc29tZXRoaW5nIHVuZXhwZWN0ZWQgaGFwcGVucyBpbiB0aGUgbGlicmFyeS5cclxuICAgICAqIEBwYXJhbSBlcnJEZXNjIFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlVW5leHBlY3RlZEVycm9yKGVyckRlc2M6IHN0cmluZyk6IEF1dGhFcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBdXRoRXJyb3IoQXV0aEVycm9yTWVzc2FnZS51bmV4cGVjdGVkRXJyb3IuY29kZSwgYCR7QXV0aEVycm9yTWVzc2FnZS51bmV4cGVjdGVkRXJyb3IuZGVzY306ICR7ZXJyRGVzY31gKTtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgSUNhY2hlU3RvcmFnZSB9IGZyb20gXCIuLi8uLi9jYWNoZS9JQ2FjaGVTdG9yYWdlXCI7XHJcbmltcG9ydCB7IElOZXR3b3JrTW9kdWxlIH0gZnJvbSBcIi4uLy4uL25ldHdvcmsvSU5ldHdvcmtNb2R1bGVcIjtcclxuaW1wb3J0IHsgSUNyeXB0bywgUGtjZUNvZGVzIH0gZnJvbSBcIi4uLy4uL2NyeXB0by9JQ3J5cHRvXCI7XHJcbmltcG9ydCB7IEF1dGhFcnJvciB9IGZyb20gXCIuLi8uLi9lcnJvci9BdXRoRXJyb3JcIjtcclxuaW1wb3J0IHsgSUxvZ2dlckNhbGxiYWNrIH0gZnJvbSBcIi4uLy4uL2xvZ2dlci9Mb2dnZXJcIjtcclxuXHJcbi8vIFRva2VuIHJlbmV3YWwgb2Zmc2V0IGRlZmF1bHQgaW4gc2Vjb25kc1xyXG5jb25zdCBERUZBVUxUX1RPS0VOX1JFTkVXQUxfT0ZGU0VUX1NFQyA9IDMwMDtcclxuXHJcbi8qKlxyXG4gKiBVc2UgdGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IHRvIGNvbmZpZ3VyZSBNU0FMIE1vZHVsZXMgYW5kIGluaXRpYWxpemUgdGhlIGJhc2UgaW50ZXJmYWNlcyBmb3IgTVNBTC5cclxuICpcclxuICogVGhpcyBvYmplY3QgYWxsb3dzIHlvdSB0byBjb25maWd1cmUgaW1wb3J0YW50IGVsZW1lbnRzIG9mIE1TQUwgZnVuY3Rpb25hbGl0eTpcclxuICogLSBsb2dnZXI6IGxvZ2dpbmcgZm9yIGFwcGxpY2F0aW9uXHJcbiAqIC0gc3RvcmFnZTogdGhpcyBpcyB3aGVyZSB5b3UgY29uZmlndXJlIHN0b3JhZ2UgaW1wbGVtZW50YXRpb24uXHJcbiAqIC0gbmV0d29yazogdGhpcyBpcyB3aGVyZSB5b3UgY2FuIGNvbmZpZ3VyZSBuZXR3b3JrIGltcGxlbWVudGF0aW9uLlxyXG4gKiAtIGNyeXB0bzogaW1wbGVtZW50YXRpb24gb2YgY3J5cHRvIGZ1bmN0aW9uc1xyXG4gKi9cclxuZXhwb3J0IHR5cGUgTW9kdWxlQ29uZmlndXJhdGlvbiA9IHtcclxuICAgIHN5c3RlbU9wdGlvbnM/OiBTeXN0ZW1PcHRpb25zLFxyXG4gICAgbG9nZ2VyT3B0aW9ucz86IExvZ2dlck9wdGlvbnMsXHJcbiAgICBzdG9yYWdlSW50ZXJmYWNlPzogSUNhY2hlU3RvcmFnZSxcclxuICAgIG5ldHdvcmtJbnRlcmZhY2U/OiBJTmV0d29ya01vZHVsZSxcclxuICAgIGNyeXB0b0ludGVyZmFjZT86IElDcnlwdG9cclxufTtcclxuXHJcbi8qKlxyXG4gKiBUZWxlbWV0cnkgQ29uZmlnIE9wdGlvbnNcclxuICogLSBhcHBsaWNhdGlvbk5hbWUgICAgICAgICAgICAgIC0gTmFtZSBvZiB0aGUgY29uc3VtaW5nIGFwcHMgYXBwbGljYXRpb25cclxuICogLSBhcHBsaWNhdGlvblZlcnNpb24gICAgICAgICAgIC0gVmVyaXNvbiBvZiB0aGUgY29uc3VtaW5nIGFwcGxpY2F0aW9uXHJcbiAqIC0gdGVsZW1ldHJ5RW1pdHRlciAgICAgICAgICAgICAtIEZ1bmN0aW9uIHdoZXJlIHRlbGVtZXRyeSBldmVudHMgYXJlIGZsdXNoZWQgdG9cclxuICovXHJcbmV4cG9ydCB0eXBlIFRlbGVtZXRyeU9wdGlvbnMgPSB7XHJcbiAgICBhcHBsaWNhdGlvbk5hbWU6IHN0cmluZztcclxuICAgIGFwcGxpY2F0aW9uVmVyc2lvbjogc3RyaW5nO1xyXG4gICAgLy8gVE9ETywgYWRkIG9ubHlBZGRGYWlsdXJlVGVsZW1ldHJ5IG9wdGlvblxyXG59O1xyXG5cclxuLyoqXHJcbiAqIExpYnJhcnkgU3BlY2lmaWMgT3B0aW9uc1xyXG4gKlxyXG4gKiAtIHRva2VuUmVuZXdhbE9mZnNldFNlY29uZHMgICAgLSBzZXRzIHRoZSB3aW5kb3cgb2Ygb2Zmc2V0IG5lZWRlZCB0byByZW5ldyB0aGUgdG9rZW4gYmVmb3JlIGV4cGlyeVxyXG4gKiAtIHRlbGVtZXRyeSAgICAgICAgICAgICAgICAgICAgLSBUZWxlbWV0cnkgb3B0aW9ucyBmb3IgbGlicmFyeSBuZXR3b3JrIHJlcXVlc3RzXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBTeXN0ZW1PcHRpb25zID0ge1xyXG4gICAgdG9rZW5SZW5ld2FsT2Zmc2V0U2Vjb25kcz86IG51bWJlcjtcclxuICAgIHRlbGVtZXRyeT86IFRlbGVtZXRyeU9wdGlvbnNcclxufTtcclxuXHJcbi8qKlxyXG4gKiBMb2dnZXIgb3B0aW9ucyB0byBjb25maWd1cmUgdGhlIGxvZ2dpbmcgdGhhdCBNU0FMIGRvZXMuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBMb2dnZXJPcHRpb25zID0ge1xyXG4gICAgbG9nZ2VyQ2FsbGJhY2s/OiBJTG9nZ2VyQ2FsbGJhY2ssXHJcbiAgICBwaWlMb2dnaW5nRW5hYmxlZD86IGJvb2xlYW5cclxufTtcclxuXHJcbi8vIERlZmF1bHQgbW9kdWxlIHN5c3RlbSBvcHRpb25zXHJcbmNvbnN0IERFRkFVTFRfU1lTVEVNX09QVElPTlM6IFN5c3RlbU9wdGlvbnMgPSB7XHJcbiAgICB0b2tlblJlbmV3YWxPZmZzZXRTZWNvbmRzOiBERUZBVUxUX1RPS0VOX1JFTkVXQUxfT0ZGU0VUX1NFQyxcclxuICAgIHRlbGVtZXRyeTogbnVsbFxyXG59O1xyXG5cclxuLy8gRGVmYXVsdCBsb2dnZXIgaW1wbGVtZW50YXRpb25cclxuY29uc3QgREVGQVVMVF9MT0dHRVJfSU1QTEVNRU5UQVRJT046IExvZ2dlck9wdGlvbnMgPSB7XHJcbiAgICBsb2dnZXJDYWxsYmFjazogKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG5vdEltcGxFcnIgPSBcIkxvZ2dlciAtIGxvZ2dlckNhbGxiYWNrSW50ZXJmYWNlKCkgaGFzIG5vdCBiZWVuIGltcGxlbWVudGVkLlwiO1xyXG4gICAgICAgIHRocm93IEF1dGhFcnJvci5jcmVhdGVVbmV4cGVjdGVkRXJyb3Iobm90SW1wbEVycik7XHJcbiAgICB9LFxyXG4gICAgcGlpTG9nZ2luZ0VuYWJsZWQ6IGZhbHNlXHJcbn07XHJcblxyXG4vLyBEZWZhdWx0IHN0b3JhZ2UgaW1wbGVtZW50YXRpb25cclxuY29uc3QgREVGQVVMVF9TVE9SQUdFX0lNUExFTUVOVEFUSU9OOiBJQ2FjaGVTdG9yYWdlID0ge1xyXG4gICAgY2xlYXI6ICgpID0+IHtcclxuICAgICAgICBjb25zdCBub3RJbXBsRXJyID0gXCJTdG9yYWdlIGludGVyZmFjZSAtIGNsZWFyKCkgaGFzIG5vdCBiZWVuIGltcGxlbWVudGVkIGZvciB0aGUgY2FjaGVTdG9yYWdlIGludGVyZmFjZS5cIjtcclxuICAgICAgICB0aHJvdyBBdXRoRXJyb3IuY3JlYXRlVW5leHBlY3RlZEVycm9yKG5vdEltcGxFcnIpO1xyXG4gICAgfSxcclxuICAgIGNvbnRhaW5zS2V5OiAoKTogYm9vbGVhbiA9PiB7XHJcbiAgICAgICAgY29uc3Qgbm90SW1wbEVyciA9IFwiU3RvcmFnZSBpbnRlcmZhY2UgLSBjb250YWluc0tleSgpIGhhcyBub3QgYmVlbiBpbXBsZW1lbnRlZCBmb3IgdGhlIGNhY2hlU3RvcmFnZSBpbnRlcmZhY2UuXCI7XHJcbiAgICAgICAgdGhyb3cgQXV0aEVycm9yLmNyZWF0ZVVuZXhwZWN0ZWRFcnJvcihub3RJbXBsRXJyKTtcclxuICAgIH0sXHJcbiAgICBnZXRJdGVtOiAoKTogc3RyaW5nID0+IHtcclxuICAgICAgICBjb25zdCBub3RJbXBsRXJyID0gXCJTdG9yYWdlIGludGVyZmFjZSAtIGdldEl0ZW0oKSBoYXMgbm90IGJlZW4gaW1wbGVtZW50ZWQgZm9yIHRoZSBjYWNoZVN0b3JhZ2UgaW50ZXJmYWNlLlwiO1xyXG4gICAgICAgIHRocm93IEF1dGhFcnJvci5jcmVhdGVVbmV4cGVjdGVkRXJyb3Iobm90SW1wbEVycik7XHJcbiAgICB9LFxyXG4gICAgZ2V0S2V5czogKCk6IHN0cmluZ1tdID0+IHtcclxuICAgICAgICBjb25zdCBub3RJbXBsRXJyID0gXCJTdG9yYWdlIGludGVyZmFjZSAtIGdldEtleXMoKSBoYXMgbm90IGJlZW4gaW1wbGVtZW50ZWQgZm9yIHRoZSBjYWNoZVN0b3JhZ2UgaW50ZXJmYWNlLlwiO1xyXG4gICAgICAgIHRocm93IEF1dGhFcnJvci5jcmVhdGVVbmV4cGVjdGVkRXJyb3Iobm90SW1wbEVycik7XHJcbiAgICB9LFxyXG4gICAgcmVtb3ZlSXRlbTogKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG5vdEltcGxFcnIgPSBcIlN0b3JhZ2UgaW50ZXJmYWNlIC0gcmVtb3ZlSXRlbSgpIGhhcyBub3QgYmVlbiBpbXBsZW1lbnRlZCBmb3IgdGhlIGNhY2hlU3RvcmFnZSBpbnRlcmZhY2UuXCI7XHJcbiAgICAgICAgdGhyb3cgQXV0aEVycm9yLmNyZWF0ZVVuZXhwZWN0ZWRFcnJvcihub3RJbXBsRXJyKTtcclxuICAgIH0sXHJcbiAgICBzZXRJdGVtOiAoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgbm90SW1wbEVyciA9IFwiU3RvcmFnZSBpbnRlcmZhY2UgLSBzZXRJdGVtKCkgaGFzIG5vdCBiZWVuIGltcGxlbWVudGVkIGZvciB0aGUgY2FjaGVTdG9yYWdlIGludGVyZmFjZS5cIjtcclxuICAgICAgICB0aHJvdyBBdXRoRXJyb3IuY3JlYXRlVW5leHBlY3RlZEVycm9yKG5vdEltcGxFcnIpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuLy8gRGVmYXVsdCBuZXR3b3JrIGltcGxlbWVudGF0aW9uXHJcbmNvbnN0IERFRkFVTFRfTkVUV09SS19JTVBMRU1FTlRBVElPTjogSU5ldHdvcmtNb2R1bGUgPSB7XHJcbiAgICBhc3luYyBzZW5kR2V0UmVxdWVzdEFzeW5jPFQ+KCk6IFByb21pc2U8VD4ge1xyXG4gICAgICAgIGNvbnN0IG5vdEltcGxFcnIgPSBcIk5ldHdvcmsgaW50ZXJmYWNlIC0gc2VuZEdldFJlcXVlc3RBc3luYygpIGhhcyBub3QgYmVlbiBpbXBsZW1lbnRlZFwiO1xyXG4gICAgICAgIHRocm93IEF1dGhFcnJvci5jcmVhdGVVbmV4cGVjdGVkRXJyb3Iobm90SW1wbEVycik7XHJcbiAgICB9LFxyXG4gICAgYXN5bmMgc2VuZFBvc3RSZXF1ZXN0QXN5bmM8VD4oKTogUHJvbWlzZTxUPiB7XHJcbiAgICAgICAgY29uc3Qgbm90SW1wbEVyciA9IFwiTmV0d29yayBpbnRlcmZhY2UgLSBzZW5kUG9zdFJlcXVlc3RBc3luYygpIGhhcyBub3QgYmVlbiBpbXBsZW1lbnRlZFwiO1xyXG4gICAgICAgIHRocm93IEF1dGhFcnJvci5jcmVhdGVVbmV4cGVjdGVkRXJyb3Iobm90SW1wbEVycik7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vLyBEZWZhdWx0IGNyeXB0byBpbXBsZW1lbnRhdGlvblxyXG5jb25zdCBERUZBVUxUX0NSWVBUT19JTVBMRU1FTlRBVElPTjogSUNyeXB0byA9IHtcclxuICAgIGNyZWF0ZU5ld0d1aWQ6ICgpOiBzdHJpbmcgPT4ge1xyXG4gICAgICAgIGNvbnN0IG5vdEltcGxFcnIgPSBcIkNyeXB0byBpbnRlcmZhY2UgLSBjcmVhdGVOZXdHdWlkKCkgaGFzIG5vdCBiZWVuIGltcGxlbWVudGVkXCI7XHJcbiAgICAgICAgdGhyb3cgQXV0aEVycm9yLmNyZWF0ZVVuZXhwZWN0ZWRFcnJvcihub3RJbXBsRXJyKTtcclxuICAgIH0sXHJcbiAgICBiYXNlNjREZWNvZGU6ICgpOiBzdHJpbmcgPT4ge1xyXG4gICAgICAgIGNvbnN0IG5vdEltcGxFcnIgPSBcIkNyeXB0byBpbnRlcmZhY2UgLSBiYXNlNjREZWNvZGUoKSBoYXMgbm90IGJlZW4gaW1wbGVtZW50ZWRcIjtcclxuICAgICAgICB0aHJvdyBBdXRoRXJyb3IuY3JlYXRlVW5leHBlY3RlZEVycm9yKG5vdEltcGxFcnIpO1xyXG4gICAgfSxcclxuICAgIGJhc2U2NEVuY29kZTogKCk6IHN0cmluZyA9PiB7XHJcbiAgICAgICAgY29uc3Qgbm90SW1wbEVyciA9IFwiQ3J5cHRvIGludGVyZmFjZSAtIGJhc2U2NEVuY29kZSgpIGhhcyBub3QgYmVlbiBpbXBsZW1lbnRlZFwiO1xyXG4gICAgICAgIHRocm93IEF1dGhFcnJvci5jcmVhdGVVbmV4cGVjdGVkRXJyb3Iobm90SW1wbEVycik7XHJcbiAgICB9LFxyXG4gICAgYXN5bmMgZ2VuZXJhdGVQa2NlQ29kZXMoKTogUHJvbWlzZTxQa2NlQ29kZXM+IHtcclxuICAgICAgICBjb25zdCBub3RJbXBsRXJyID0gXCJDcnlwdG8gaW50ZXJmYWNlIC0gZ2VuZXJhdGVQa2NlQ29kZXMoKSBoYXMgbm90IGJlZW4gaW1wbGVtZW50ZWRcIjtcclxuICAgICAgICB0aHJvdyBBdXRoRXJyb3IuY3JlYXRlVW5leHBlY3RlZEVycm9yKG5vdEltcGxFcnIpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEZ1bmN0aW9uIHRoYXQgc2V0cyB0aGUgZGVmYXVsdCBvcHRpb25zIHdoZW4gbm90IGV4cGxpY2l0bHkgY29uZmlndXJlZCBmcm9tIGFwcCBkZXZlbG9wZXJcclxuICpcclxuICogQHBhcmFtIFRTdG9yYWdlT3B0aW9uc1xyXG4gKiBAcGFyYW0gVFN5c3RlbU9wdGlvbnNcclxuICogQHBhcmFtIFRGcmFtZXdvcmtPcHRpb25zXHJcbiAqXHJcbiAqIEByZXR1cm5zIE1zYWxDb25maWd1cmF0aW9uIG9iamVjdFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkTW9kdWxlQ29uZmlndXJhdGlvbih7IHN5c3RlbU9wdGlvbnM6IHVzZXJTeXN0ZW1PcHRpb25zLCBsb2dnZXJPcHRpb25zOiB1c2VyTG9nZ2VyT3B0aW9uLCBzdG9yYWdlSW50ZXJmYWNlOiBzdG9yYWdlSW1wbGVtZW50YXRpb24sIG5ldHdvcmtJbnRlcmZhY2U6IG5ldHdvcmtJbXBsZW1lbnRhdGlvbiwgY3J5cHRvSW50ZXJmYWNlOiBjcnlwdG9JbXBsZW1lbnRhdGlvbiB9OiBNb2R1bGVDb25maWd1cmF0aW9uKTogTW9kdWxlQ29uZmlndXJhdGlvbiB7XHJcbiAgICBjb25zdCBvdmVybGF5ZWRDb25maWc6IE1vZHVsZUNvbmZpZ3VyYXRpb24gPSB7XHJcbiAgICAgICAgc3lzdGVtT3B0aW9uczogdXNlclN5c3RlbU9wdGlvbnMgfHwgREVGQVVMVF9TWVNURU1fT1BUSU9OUyxcclxuICAgICAgICBsb2dnZXJPcHRpb25zOiB1c2VyTG9nZ2VyT3B0aW9uIHx8IERFRkFVTFRfTE9HR0VSX0lNUExFTUVOVEFUSU9OLFxyXG4gICAgICAgIHN0b3JhZ2VJbnRlcmZhY2U6IHN0b3JhZ2VJbXBsZW1lbnRhdGlvbiB8fCBERUZBVUxUX1NUT1JBR0VfSU1QTEVNRU5UQVRJT04sXHJcbiAgICAgICAgbmV0d29ya0ludGVyZmFjZTogbmV0d29ya0ltcGxlbWVudGF0aW9uIHx8IERFRkFVTFRfTkVUV09SS19JTVBMRU1FTlRBVElPTixcclxuICAgICAgICBjcnlwdG9JbnRlcmZhY2U6IGNyeXB0b0ltcGxlbWVudGF0aW9uIHx8IERFRkFVTFRfQ1JZUFRPX0lNUExFTUVOVEFUSU9OXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIG92ZXJsYXllZENvbmZpZztcclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQWNjZXNzVG9rZW5LZXkgfSBmcm9tIFwiLi9BY2Nlc3NUb2tlbktleVwiO1xyXG5pbXBvcnQgeyBBY2Nlc3NUb2tlblZhbHVlIH0gZnJvbSBcIi4vQWNjZXNzVG9rZW5WYWx1ZVwiO1xyXG5cclxuLyoqXHJcbiAqIEFjY2VzcyB0b2tlbiBjYWNoZSBpdGVtIHdoaWNoIGlzIHVzZWQgdG8gbWFuYWdlIHRva2VucyBhbmQgdG9rZW4gcmVuZXdhbC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBBY2Nlc3NUb2tlbkNhY2hlSXRlbSB7XHJcblxyXG4gICAga2V5OiBBY2Nlc3NUb2tlbktleTtcclxuICAgIHZhbHVlOiBBY2Nlc3NUb2tlblZhbHVlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGtleTogQWNjZXNzVG9rZW5LZXksIHZhbHVlOiBBY2Nlc3NUb2tlblZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5pbXBvcnQgeyBBdXRoRXJyb3IgfSBmcm9tIFwiLi9BdXRoRXJyb3JcIjtcclxuaW1wb3J0IHsgSWRUb2tlbiB9IGZyb20gXCIuLi9hdXRoL0lkVG9rZW5cIjtcclxuXHJcbi8qKlxyXG4gKiBDbGllbnRBdXRoRXJyb3JNZXNzYWdlIGNsYXNzIGNvbnRhaW5pbmcgc3RyaW5nIGNvbnN0YW50cyB1c2VkIGJ5IGVycm9yIGNvZGVzIGFuZCBtZXNzYWdlcy5cclxuICovXHJcbmV4cG9ydCBjb25zdCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlID0ge1xyXG4gICAgY2xpZW50SW5mb0RlY29kaW5nRXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcImNsaWVudF9pbmZvX2RlY29kaW5nX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJUaGUgY2xpZW50IGluZm8gY291bGQgbm90IGJlIHBhcnNlZC9kZWNvZGVkIGNvcnJlY3RseS4gUGxlYXNlIHJldmlldyB0aGUgdHJhY2UgdG8gZGV0ZXJtaW5lIHRoZSByb290IGNhdXNlLlwiXHJcbiAgICB9LFxyXG4gICAgY2xpZW50SW5mb0VtcHR5RXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcImNsaWVudF9pbmZvX2VtcHR5X2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJUaGUgY2xpZW50IGluZm8gd2FzIGVtcHR5LiBQbGVhc2UgcmV2aWV3IHRoZSB0cmFjZSB0byBkZXRlcm1pbmUgdGhlIHJvb3QgY2F1c2UuXCJcclxuICAgIH0sXHJcbiAgICBpZFRva2VuUGFyc2luZ0Vycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJpZF90b2tlbl9wYXJzaW5nX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJJRCB0b2tlbiBjYW5ub3QgYmUgcGFyc2VkLiBQbGVhc2UgcmV2aWV3IHN0YWNrIHRyYWNlIHRvIGRldGVybWluZSByb290IGNhdXNlLlwiXHJcbiAgICB9LFxyXG4gICAgbnVsbE9yRW1wdHlJZFRva2VuOiB7XHJcbiAgICAgICAgY29kZTogXCJudWxsX29yX2VtcHR5X2lkX3Rva2VuXCIsXHJcbiAgICAgICAgZGVzYzogXCJUaGUgaWRUb2tlbiBpcyBudWxsIG9yIGVtcHR5LiBQbGVhc2UgcmV2aWV3IHRoZSB0cmFjZSB0byBkZXRlcm1pbmUgdGhlIHJvb3QgY2F1c2UuXCJcclxuICAgIH0sXHJcbiAgICB0b2tlblJlcXVlc3RDYWNoZUVycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJ0b2tlbl9yZXF1ZXN0X2NhY2hlX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJUaGUgdG9rZW4gcmVxdWVzdCBjb3VsZCBub3QgYmUgZmV0Y2hlZCBmcm9tIHRoZSBjYWNoZSBjb3JyZWN0bHkuXCJcclxuICAgIH0sXHJcbiAgICBlbmRwb2ludFJlc29sdXRpb25FcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiZW5kcG9pbnRzX3Jlc29sdXRpb25fZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIkVycm9yOiBjb3VsZCBub3QgcmVzb2x2ZSBlbmRwb2ludHMuIFBsZWFzZSBjaGVjayBuZXR3b3JrIGFuZCB0cnkgYWdhaW4uXCJcclxuICAgIH0sXHJcbiAgICBpbnZhbGlkQXV0aG9yaXR5VHlwZToge1xyXG4gICAgICAgIGNvZGU6IFwiaW52YWxpZF9hdXRob3JpdHlfdHlwZVwiLFxyXG4gICAgICAgIGRlc2M6IFwiVGhlIGdpdmVuIGF1dGhvcml0eSBpcyBub3QgYSB2YWxpZCB0eXBlIG9mIGF1dGhvcml0eSBzdXBwb3J0ZWQgYnkgTVNBTC4gUGxlYXNlIHJldmlldyB0aGUgdHJhY2UgdG8gZGV0ZXJtaW5lIHRoZSByb290IGNhdXNlLlwiXHJcbiAgICB9LFxyXG4gICAgaGFzaE5vdERlc2VyaWFsaXplZDoge1xyXG4gICAgICAgIGNvZGU6IFwiaGFzaF9ub3RfZGVzZXJpYWxpemVkXCIsXHJcbiAgICAgICAgZGVzYzogXCJUaGUgaGFzaCBwYXJhbWV0ZXJzIGNvdWxkIG5vdCBiZSBkZXNlcmlhbGl6ZWQuIFBsZWFzZSByZXZpZXcgdGhlIHRyYWNlIHRvIGRldGVybWluZSB0aGUgcm9vdCBjYXVzZS5cIlxyXG4gICAgfSxcclxuICAgIGJsYW5rR3VpZEdlbmVyYXRlZDoge1xyXG4gICAgICAgIGNvZGU6IFwiYmxhbmtfZ3VpZF9nZW5lcmF0ZWRcIixcclxuICAgICAgICBkZXNjOiBcIlRoZSBndWlkIGdlbmVyYXRlZCB3YXMgYmxhbmsuIFBsZWFzZSByZXZpZXcgdGhlIHRyYWNlIHRvIGRldGVybWluZSB0aGUgcm9vdCBjYXVzZS5cIlxyXG4gICAgfSxcclxuICAgIHN0YXRlTWlzbWF0Y2hFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwic3RhdGVfbWlzbWF0Y2hcIixcclxuICAgICAgICBkZXNjOiBcIlN0YXRlIG1pc21hdGNoIGVycm9yLiBQbGVhc2UgY2hlY2sgeW91ciBuZXR3b3JrLiBDb250aW51ZWQgcmVxdWVzdHMgbWF5IGNhdXNlIGNhY2hlIG92ZXJmbG93LlwiXHJcbiAgICB9LFxyXG4gICAgbm9uY2VNaXNtYXRjaEVycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJub25jZV9taXNtYXRjaFwiLFxyXG4gICAgICAgIGRlc2M6IFwiTm9uY2UgbWlzbWF0Y2ggZXJyb3IuIFRoaXMgbWF5IGJlIGNhdXNlZCBieSBhIHJhY2UgY29uZGl0aW9uIGluIGNvbmN1cnJlbnQgcmVxdWVzdHMuXCJcclxuICAgIH0sXHJcbiAgICBhY2NvdW50TWlzbWF0Y2hFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiYWNjb3VudF9taXNtYXRjaFwiLFxyXG4gICAgICAgIGRlc2M6IFwiVGhlIGNhY2hlZCBhY2NvdW50IGFuZCBhY2NvdW50IHdoaWNoIG1hZGUgdGhlIHRva2VuIHJlcXVlc3QgZG8gbm90IG1hdGNoLlwiXHJcbiAgICB9LFxyXG4gICAgaW52YWxpZElkVG9rZW46IHtcclxuICAgICAgICBjb2RlOiBcImludmFsaWRfaWRfdG9rZW5cIixcclxuICAgICAgICBkZXNjOiBcIkludmFsaWQgSUQgdG9rZW4gZm9ybWF0LlwiXHJcbiAgICB9LFxyXG4gICAgbm9Ub2tlbnNGb3VuZEVycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJub190b2tlbnNfZm91bmRcIixcclxuICAgICAgICBkZXNjOiBcIk5vIHRva2VucyB3ZXJlIGZvdW5kIGZvciB0aGUgZ2l2ZW4gc2NvcGVzLCBhbmQgbm8gYXV0aG9yaXphdGlvbiBjb2RlIHdhcyBwYXNzZWQgdG8gYWNxdWlyZVRva2VuLiBZb3UgbXVzdCByZXRyaWV2ZSBhbiBhdXRob3JpemF0aW9uIGNvZGUgYmVmb3JlIG1ha2luZyBhIGNhbGwgdG8gYWNxdWlyZVRva2VuKCkuXCJcclxuICAgIH0sXHJcbiAgICBjYWNoZVBhcnNlRXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcImNhY2hlX3BhcnNlX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJDb3VsZCBub3QgcGFyc2UgY2FjaGUga2V5LlwiXHJcbiAgICB9LFxyXG4gICAgdXNlckxvZ2luUmVxdWlyZWRFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwidXNlcl9sb2dpbl9lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwiVXNlciBsb2dpbiBpcyByZXF1aXJlZC5cIlxyXG4gICAgfSxcclxuICAgIG11bHRpcGxlTWF0Y2hpbmdUb2tlbnM6IHtcclxuICAgICAgICBjb2RlOiBcIm11bHRpcGxlX21hdGNoaW5nX3Rva2Vuc1wiLFxyXG4gICAgICAgIGRlc2M6IFwiVGhlIGNhY2hlIGNvbnRhaW5zIG11bHRpcGxlIHRva2VucyBzYXRpc2Z5aW5nIHRoZSByZXF1aXJlbWVudHMuIFwiICtcclxuICAgICAgICAgICAgXCJDYWxsIEFjcXVpcmVUb2tlbiBhZ2FpbiBwcm92aWRpbmcgbW9yZSByZXF1aXJlbWVudHMgc3VjaCBhcyBhdXRob3JpdHksIHJlc291cmNlLCBvciBhY2NvdW50LlwiXHJcbiAgICB9LFxyXG4gICAgdG9rZW5SZXF1ZXN0Q2Fubm90QmVNYWRlOiB7XHJcbiAgICAgICAgY29kZTogXCJyZXF1ZXN0X2Nhbm5vdF9iZV9tYWRlXCIsXHJcbiAgICAgICAgZGVzYzogXCJUb2tlbiByZXF1ZXN0IGNhbm5vdCBiZSBtYWRlIHdpdGhvdXQgYXV0aG9yaXphdGlvbiBjb2RlIG9yIHJlZnJlc2ggdG9rZW4uXCJcclxuICAgIH0sXHJcbn07XHJcblxyXG4vKipcclxuICogRXJyb3IgdGhyb3duIHdoZW4gdGhlcmUgaXMgYW4gZXJyb3IgaW4gdGhlIGNsaWVudCBjb2RlIHJ1bm5pbmcgb24gdGhlIGJyb3dzZXIuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ2xpZW50QXV0aEVycm9yIGV4dGVuZHMgQXV0aEVycm9yIHtcclxuICAgICAgICBcclxuICAgIGNvbnN0cnVjdG9yKGVycm9yQ29kZTogc3RyaW5nLCBlcnJvck1lc3NhZ2U/OiBzdHJpbmcpIHtcclxuICAgICAgICBzdXBlcihlcnJvckNvZGUsIGVycm9yTWVzc2FnZSk7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gXCJDbGllbnRBdXRoRXJyb3JcIjtcclxuXHJcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIENsaWVudEF1dGhFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBlcnJvciB0aHJvd24gd2hlbiBjbGllbnQgaW5mbyBvYmplY3QgZG9lc24ndCBkZWNvZGUgY29ycmVjdGx5LlxyXG4gICAgICogQHBhcmFtIGNhdWdodEVycm9yIFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlQ2xpZW50SW5mb0RlY29kaW5nRXJyb3IoY2F1Z2h0RXJyb3I6IHN0cmluZyk6IENsaWVudEF1dGhFcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5jbGllbnRJbmZvRGVjb2RpbmdFcnJvci5jb2RlLFxyXG4gICAgICAgICAgICBgJHtDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmNsaWVudEluZm9EZWNvZGluZ0Vycm9yLmRlc2N9IEZhaWxlZCB3aXRoIGVycm9yOiAke2NhdWdodEVycm9yfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBlcnJvciB0aHJvd24gaWYgdGhlIGNsaWVudCBpbmZvIGlzIGVtcHR5LlxyXG4gICAgICogQHBhcmFtIHJhd0NsaWVudEluZm8gXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVDbGllbnRJbmZvRW1wdHlFcnJvcihyYXdDbGllbnRJbmZvOiBzdHJpbmcpOiBDbGllbnRBdXRoRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2UuY2xpZW50SW5mb0VtcHR5RXJyb3IuY29kZSxcclxuICAgICAgICAgICAgYCR7Q2xpZW50QXV0aEVycm9yTWVzc2FnZS5jbGllbnRJbmZvRW1wdHlFcnJvci5kZXNjfSBHaXZlbiBPYmplY3Q6ICR7cmF3Q2xpZW50SW5mb31gKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gZXJyb3IgdGhyb3duIHdoZW4gdGhlIGlkIHRva2VuIGV4dHJhY3Rpb24gZXJyb3JzIG91dC5cclxuICAgICAqIEBwYXJhbSBlcnIgXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVJZFRva2VuUGFyc2luZ0Vycm9yKGNhdWdodEV4dHJhY3Rpb25FcnJvcjogc3RyaW5nKTogQ2xpZW50QXV0aEVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmlkVG9rZW5QYXJzaW5nRXJyb3IuY29kZSxcclxuICAgICAgICAgICAgYCR7Q2xpZW50QXV0aEVycm9yTWVzc2FnZS5pZFRva2VuUGFyc2luZ0Vycm9yLmRlc2N9IEZhaWxlZCB3aXRoIGVycm9yOiAke2NhdWdodEV4dHJhY3Rpb25FcnJvcn1gKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gZXJyb3IgdGhyb3duIHdoZW4gdGhlIGlkIHRva2VuIHN0cmluZyBpcyBudWxsIG9yIGVtcHR5LlxyXG4gICAgICogQHBhcmFtIGludmFsaWRSYXdUb2tlblN0cmluZyBcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZUlkVG9rZW5OdWxsT3JFbXB0eUVycm9yKGludmFsaWRSYXdUb2tlblN0cmluZzogc3RyaW5nKSA6IENsaWVudEF1dGhFcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5udWxsT3JFbXB0eUlkVG9rZW4uY29kZSxcclxuICAgICAgICAgICAgYCR7Q2xpZW50QXV0aEVycm9yTWVzc2FnZS5udWxsT3JFbXB0eUlkVG9rZW4uZGVzY30gUmF3IElEIFRva2VuIFZhbHVlOiAke2ludmFsaWRSYXdUb2tlblN0cmluZ31gKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gZXJyb3IgdGhyb3duIHdoZW4gdGhlIHRva2VuIHJlcXVlc3QgY291bGQgbm90IGJlIHJldHJpZXZlZCBmcm9tIHRoZSBjYWNoZVxyXG4gICAgICogQHBhcmFtIGVyckRldGFpbCBcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZVRva2VuUmVxdWVzdENhY2hlRXJyb3IoZXJyRGV0YWlsOiBzdHJpbmcpOiBDbGllbnRBdXRoRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2UudG9rZW5SZXF1ZXN0Q2FjaGVFcnJvci5jb2RlLCBcclxuICAgICAgICAgICAgYCR7Q2xpZW50QXV0aEVycm9yTWVzc2FnZS50b2tlblJlcXVlc3RDYWNoZUVycm9yLmRlc2N9IEVycm9yIERldGFpbDogJHtlcnJEZXRhaWx9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIGVycm9yIHRocm93biB3aGVuIHRoZSBlbmRwb2ludCBkaXNjb3ZlcnkgZG9lc24ndCBjb21wbGV0ZSBjb3JyZWN0bHkuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVFbmRwb2ludERpc2NvdmVyeUluY29tcGxldGVFcnJvcihlcnJEZXRhaWw6IHN0cmluZyk6IENsaWVudEF1dGhFcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5lbmRwb2ludFJlc29sdXRpb25FcnJvci5jb2RlLCBcclxuICAgICAgICAgICAgYCR7Q2xpZW50QXV0aEVycm9yTWVzc2FnZS5lbmRwb2ludFJlc29sdXRpb25FcnJvci5kZXNjfSBEZXRhaWw6ICR7ZXJyRGV0YWlsfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBlcnJvciB0aHJvd24gaWYgYXV0aG9yaXR5IHR5cGUgaXMgbm90IHZhbGlkLlxyXG4gICAgICogQHBhcmFtIGludmFsaWRBdXRob3JpdHlFcnJvciBcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZUludmFsaWRBdXRob3JpdHlUeXBlRXJyb3IoZ2l2ZW5Vcmw6IHN0cmluZyk6IENsaWVudEF1dGhFcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5pbnZhbGlkQXV0aG9yaXR5VHlwZS5jb2RlLCBcclxuICAgICAgICAgICAgYCR7Q2xpZW50QXV0aEVycm9yTWVzc2FnZS5pbnZhbGlkQXV0aG9yaXR5VHlwZS5kZXNjfSBHaXZlbiBVcmw6ICR7Z2l2ZW5Vcmx9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIGVycm9yIHRocm93biB3aGVuIHRoZSBoYXNoIGNhbm5vdCBiZSBkZXNlcmlhbGl6ZWQuXHJcbiAgICAgKiBAcGFyYW0gaW52YWxpZEF1dGhvcml0eUVycm9yIFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlSGFzaE5vdERlc2VyaWFsaXplZEVycm9yKGhhc2hQYXJhbU9iajogc3RyaW5nKTogQ2xpZW50QXV0aEVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmhhc2hOb3REZXNlcmlhbGl6ZWQuY29kZSwgXHJcbiAgICAgICAgICAgIGAke0NsaWVudEF1dGhFcnJvck1lc3NhZ2UuaGFzaE5vdERlc2VyaWFsaXplZC5kZXNjfSBHaXZlbiBPYmplY3Q6ICR7aGFzaFBhcmFtT2JqfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBlcnJvciB0aHJvd24gd2hlbiB0d28gc3RhdGVzIGRvIG5vdCBtYXRjaC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZVN0YXRlTWlzbWF0Y2hFcnJvcigpOiBDbGllbnRBdXRoRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2Uuc3RhdGVNaXNtYXRjaEVycm9yLmNvZGUsIFxyXG4gICAgICAgICAgICBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLnN0YXRlTWlzbWF0Y2hFcnJvci5kZXNjKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gZXJyb3IgdGhyb3duIHdoZW4gdGhlIG5vbmNlIGRvZXMgbm90IG1hdGNoLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlTm9uY2VNaXNtYXRjaEVycm9yKCk6IENsaWVudEF1dGhFcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5ub25jZU1pc21hdGNoRXJyb3IuY29kZSwgXHJcbiAgICAgICAgICAgIENsaWVudEF1dGhFcnJvck1lc3NhZ2Uubm9uY2VNaXNtYXRjaEVycm9yLmRlc2MpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiBcclxuICAgICAqIENyZWF0ZXMgYW4gZXJyb3IgdGhyb3duIHdoZW4gdGhlIGNhY2hlZCBhY2NvdW50IGFuZCByZXNwb25zZSBhY2NvdW50IGRvIG5vdCBtYXRjaC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZUFjY291bnRNaXNtYXRjaEVycm9yKCk6IENsaWVudEF1dGhFcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5hY2NvdW50TWlzbWF0Y2hFcnJvci5jb2RlLCBcclxuICAgICAgICAgICAgQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5hY2NvdW50TWlzbWF0Y2hFcnJvci5kZXNjKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRocm93cyBlcnJvciBpZiBpZFRva2VuIGlzIG5vdCBjb3JyZWN0bHkgZm9ybWVkXHJcbiAgICAgKiBAcGFyYW0gaWRUb2tlbiBcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZUludmFsaWRJZFRva2VuRXJyb3IoaWRUb2tlbjogSWRUb2tlbikgOiBDbGllbnRBdXRoRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2UuaW52YWxpZElkVG9rZW4uY29kZSxcclxuICAgICAgICAgICAgYCR7Q2xpZW50QXV0aEVycm9yTWVzc2FnZS5pbnZhbGlkSWRUb2tlbi5kZXNjfSBHaXZlbiB0b2tlbjogJHtKU09OLnN0cmluZ2lmeShpZFRva2VuKX1gKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gZXJyb3IgdGhyb3duIHdoZW4gdGhlIGF1dGhvcml6YXRpb24gY29kZSByZXF1aXJlZCBmb3IgYSB0b2tlbiByZXF1ZXN0IGlzIG51bGwgb3IgZW1wdHkuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVOb1Rva2Vuc0ZvdW5kRXJyb3Ioc2NvcGVzOiBzdHJpbmcpOiBDbGllbnRBdXRoRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2Uubm9Ub2tlbnNGb3VuZEVycm9yLmNvZGUsIFxyXG4gICAgICAgICAgICBgJHtDbGllbnRBdXRoRXJyb3JNZXNzYWdlLm5vVG9rZW5zRm91bmRFcnJvci5kZXNjfSBTY29wZXM6ICR7c2NvcGVzfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBlcnJvciBpbiBjYWNoZSBwYXJzaW5nLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlQ2FjaGVQYXJzZUVycm9yKGNhY2hlS2V5OiBzdHJpbmcpOiBDbGllbnRBdXRoRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2UuY2FjaGVQYXJzZUVycm9yLmNvZGUsIFxyXG4gICAgICAgICAgICBgJHtDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmNhY2hlUGFyc2VFcnJvci5kZXNjfSBDYWNoZSBrZXk6ICR7Y2FjaGVLZXl9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaHJvd3MgZXJyb3Igd2hlbiByZW5ld2luZyB0b2tlbiB3aXRob3V0IGxvZ2luLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlVXNlckxvZ2luUmVxdWlyZWRFcnJvcigpIDogQ2xpZW50QXV0aEVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLnVzZXJMb2dpblJlcXVpcmVkRXJyb3IuY29kZSxcclxuICAgICAgICAgICAgQ2xpZW50QXV0aEVycm9yTWVzc2FnZS51c2VyTG9naW5SZXF1aXJlZEVycm9yLmRlc2MpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhyb3dzIGVycm9yIHdoZW4gbXVsdGlwbGUgdG9rZW5zIGFyZSBpbiBjYWNoZSBmb3IgdGhlIGdpdmVuIHNjb3BlLlxyXG4gICAgICogQHBhcmFtIHNjb3BlIFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlTXVsdGlwbGVNYXRjaGluZ1Rva2Vuc0luQ2FjaGVFcnJvcihzY29wZTogc3RyaW5nKTogQ2xpZW50QXV0aEVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLm11bHRpcGxlTWF0Y2hpbmdUb2tlbnMuY29kZSxcclxuICAgICAgICAgICAgYENhY2hlIGVycm9yIGZvciBzY29wZSAke3Njb3BlfTogJHtDbGllbnRBdXRoRXJyb3JNZXNzYWdlLm11bHRpcGxlTWF0Y2hpbmdUb2tlbnMuZGVzY30uYCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaHJvd3MgZXJyb3Igd2hlbiBubyBhdXRoIGNvZGUgb3IgcmVmcmVzaCB0b2tlbiBpcyBnaXZlbiB0byBTZXJ2ZXJUb2tlblJlcXVlc3RQYXJhbWV0ZXJzLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlVG9rZW5SZXF1ZXN0Q2Fubm90QmVNYWRlRXJyb3IoKTogQ2xpZW50QXV0aEVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLnRva2VuUmVxdWVzdENhbm5vdEJlTWFkZS5jb2RlLCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLnRva2VuUmVxdWVzdENhbm5vdEJlTWFkZS5kZXNjKTtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgRGVjb2RlZEp3dCB9IGZyb20gXCIuLi9hdXRoL0RlY29kZWRKd3RcIjtcclxuaW1wb3J0IHsgQ2xpZW50QXV0aEVycm9yIH0gZnJvbSBcIi4uL2Vycm9yL0NsaWVudEF1dGhFcnJvclwiO1xyXG5cclxuLyoqXHJcbiAqIEBoaWRkZW5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBTdHJpbmdVdGlscyB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogZGVjb2RlIGEgSldUXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGp3dFRva2VuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBkZWNvZGVKd3Qoand0VG9rZW46IHN0cmluZyk6IERlY29kZWRKd3Qge1xyXG4gICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KGp3dFRva2VuKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlSWRUb2tlbk51bGxPckVtcHR5RXJyb3Ioand0VG9rZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBpZFRva2VuUGFydHNSZWdleCA9IC9eKFteXFwuXFxzXSopXFwuKFteXFwuXFxzXSspXFwuKFteXFwuXFxzXSopJC87XHJcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGlkVG9rZW5QYXJ0c1JlZ2V4LmV4ZWMoand0VG9rZW4pO1xyXG4gICAgICAgIGlmICghbWF0Y2hlcyB8fCBtYXRjaGVzLmxlbmd0aCA8IDQpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUlkVG9rZW5QYXJzaW5nRXJyb3IoYEdpdmVuIHRva2VuIGlzIG1hbGZvcm1lZDogJHtKU09OLnN0cmluZ2lmeShqd3RUb2tlbil9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGNyYWNrZWRUb2tlbjogRGVjb2RlZEp3dCA9IHtcclxuICAgICAgICAgICAgaGVhZGVyOiBtYXRjaGVzWzFdLFxyXG4gICAgICAgICAgICBKV1NQYXlsb2FkOiBtYXRjaGVzWzJdLFxyXG4gICAgICAgICAgICBKV1NTaWc6IG1hdGNoZXNbM11cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBjcmFja2VkVG9rZW47XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBhIHN0cmluZyBpcyBlbXB0eS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gc3RyXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBpc0VtcHR5KHN0cjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICh0eXBlb2Ygc3RyID09PSBcInVuZGVmaW5lZFwiIHx8ICFzdHIgfHwgMCA9PT0gc3RyLmxlbmd0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgc3RyaW5nIGludG8gYW4gb2JqZWN0LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBxdWVyeVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgcXVlcnlTdHJpbmdUb09iamVjdDxUPihxdWVyeTogc3RyaW5nKTogVCB7XHJcbiAgICAgICAgbGV0IG1hdGNoOiBBcnJheTxzdHJpbmc+OyAvLyBSZWdleCBmb3IgcmVwbGFjaW5nIGFkZGl0aW9uIHN5bWJvbCB3aXRoIGEgc3BhY2VcclxuICAgICAgICBjb25zdCBwbCA9IC9cXCsvZztcclxuICAgICAgICBjb25zdCBzZWFyY2ggPSAvKFteJj1dKyk9KFteJl0qKS9nO1xyXG4gICAgICAgIGNvbnN0IGRlY29kZSA9IChzOiBzdHJpbmcpOiBzdHJpbmcgPT4gZGVjb2RlVVJJQ29tcG9uZW50KHMucmVwbGFjZShwbCwgXCIgXCIpKTtcclxuICAgICAgICBjb25zdCBvYmo6IHt9ID0ge307XHJcbiAgICAgICAgbWF0Y2ggPSBzZWFyY2guZXhlYyhxdWVyeSk7XHJcbiAgICAgICAgd2hpbGUgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgIG9ialtkZWNvZGUobWF0Y2hbMV0pXSA9IGRlY29kZShtYXRjaFsyXSk7XHJcbiAgICAgICAgICAgIG1hdGNoID0gc2VhcmNoLmV4ZWMocXVlcnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb2JqIGFzIFQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUcmltcyBlbnRyaWVzIGFuZCBjb252ZXJ0cyB0aGVtIHRvIGxvd2VyIGNhc2UuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGFyclxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgdHJpbUFuZENvbnZlcnRBcnJheUVudHJpZXNUb0xvd2VyQ2FzZShhcnI6IEFycmF5PHN0cmluZz4pOiBBcnJheTxzdHJpbmc+IHtcclxuICAgICAgICByZXR1cm4gYXJyLm1hcChlbnRyeSA9PiBlbnRyeS50cmltKCkudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcblxyXG5leHBvcnQgY29uc3QgQ29uc3RhbnRzID0ge1xyXG4gICAgTElCUkFSWV9OQU1FOiBcIk1TQUwuSlNcIixcclxuICAgIC8vIFByZWZpeCBmb3IgYWxsIGxpYnJhcnkgY2FjaGUgZW50cmllc1xyXG4gICAgQ0FDSEVfUFJFRklYOiBcIm1zYWxcIixcclxuICAgIC8vIFJlc291cmNlIGRlbGltaXRlciAtIHVzZWQgZm9yIGNlcnRhaW4gY2FjaGUgZW50cmllc1xyXG4gICAgUkVTT1VSQ0VfREVMSU06IFwifFwiLFxyXG4gICAgLy8gUGxhY2Vob2xkZXIgZm9yIG5vbi1leGlzdGVudCBhY2NvdW50IGlkcy9vYmplY3RzXHJcbiAgICBOT19BQ0NPVU5UOiBcIk5PX0FDQ09VTlRcIixcclxuICAgIC8vIENsYWltc1xyXG4gICAgQ0xBSU1TOiBcImNsYWltc1wiLFxyXG4gICAgLy8gQ29uc3VtZXIgVVRJRFxyXG4gICAgQ09OU1VNRVJfVVRJRDogXCI5MTg4MDQwZC02YzY3LTRjNWItYjExMi0zNmEzMDRiNjZkYWRcIixcclxuICAgIC8vIERlZmF1bHQgc2NvcGVzXHJcbiAgICBPUEVOSURfU0NPUEU6IFwib3BlbmlkXCIsXHJcbiAgICBQUk9GSUxFX1NDT1BFOiBcInByb2ZpbGVcIixcclxuICAgIE9GRkxJTkVfQUNDRVNTX1NDT1BFOiBcIm9mZmxpbmVfYWNjZXNzXCIsXHJcbiAgICAvLyBEZWZhdWx0IHJlc3BvbnNlIHR5cGUgZm9yIGF1dGhvcml6YXRpb24gY29kZSBmbG93XHJcbiAgICBDT0RFX1JFU1BPTlNFX1RZUEU6IFwiY29kZVwiLFxyXG4gICAgQ09ERV9HUkFOVF9UWVBFOiBcImF1dGhvcml6YXRpb25fY29kZVwiLFxyXG4gICAgUlRfR1JBTlRfVFlQRTogXCJyZWZyZXNoX3Rva2VuXCIsXHJcbiAgICBGUkFHTUVOVF9SRVNQT05TRV9NT0RFOiBcImZyYWdtZW50XCIsXHJcbiAgICBTMjU2X0NPREVfQ0hBTExFTkdFX01FVEhPRDogXCJTMjU2XCIsXHJcbiAgICBVUkxfRk9STV9DT05URU5UX1RZUEU6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCJcclxufTtcclxuXHJcbi8qKlxyXG4gKiBSZXF1ZXN0IGhlYWRlciBuYW1lc1xyXG4gKi9cclxuZXhwb3J0IGVudW0gSEVBREVSX05BTUVTIHtcclxuICAgIENPTlRFTlRfVFlQRSA9IFwiQ29udGVudC1UeXBlXCJcclxufTtcclxuXHJcbi8qKlxyXG4gKiBUZW1wb3JhcnkgY2FjaGUga2V5cyBmb3IgTVNBTCwgZGVsZXRlZCBhZnRlciBhbnkgcmVxdWVzdC5cclxuICovXHJcbmV4cG9ydCBlbnVtIFRlbXBvcmFyeUNhY2hlS2V5cyB7XHJcbiAgICBBVVRIT1JJVFkgPSBcImF1dGhvcml0eVwiLFxyXG4gICAgQUNRVUlSRV9UT0tFTl9BQ0NPVU5UID0gXCJhY3F1aXJlVG9rZW4uYWNjb3VudFwiLFxyXG4gICAgU0VTU0lPTl9TVEFURSA9IFwic2Vzc2lvbi5zdGF0ZVwiLFxyXG4gICAgUkVRVUVTVF9TVEFURSA9IFwicmVxdWVzdC5zdGF0ZVwiLFxyXG4gICAgTk9OQ0VfSURUT0tFTiA9IFwibm9uY2UuaWR0b2tlblwiLFxyXG4gICAgT1JJR0lOX1VSSSA9IFwicmVxdWVzdC5vcmlnaW5cIixcclxuICAgIFJFTkVXX1NUQVRVUyA9IFwidG9rZW4ucmVuZXcuc3RhdHVzXCIsXHJcbiAgICBVUkxfSEFTSCA9IFwidXJsSGFzaFwiLFxyXG4gICAgUkVRVUVTVF9QQVJBTVMgPSBcInJlcXVlc3QucGFyYW1zXCIsXHJcbiAgICBSRURJUkVDVF9SRVFVRVNUID0gXCJyZWRpcmVjdC5yZXF1ZXN0XCIsXHJcbiAgICBTQ09QRVMgPSBcInNjb3Blc1wiXHJcbn07XHJcblxyXG4vKipcclxuICogUGVyc2lzdGVudCBjYWNoZSBrZXlzIE1TQUwgd2hpY2ggc3RheSB3aGlsZSB1c2VyIGlzIGxvZ2dlZCBpbi5cclxuICovXHJcbmV4cG9ydCBlbnVtIFBlcnNpc3RlbnRDYWNoZUtleXMge1xyXG4gICAgSURfVE9LRU4gPSBcImlkdG9rZW5cIixcclxuICAgIENMSUVOVF9JTkZPID0gXCJjbGllbnQuaW5mb1wiLFxyXG4gICAgQURBTF9JRF9UT0tFTiA9IFwiYWRhbC5pZHRva2VuXCIsXHJcbiAgICBFUlJPUiA9IFwiZXJyb3JcIixcclxuICAgIEVSUk9SX0RFU0MgPSBcImVycm9yLmRlc2NyaXB0aW9uXCJcclxufTtcclxuXHJcbi8qKlxyXG4gKiBMaXN0IG9mIHByZS1lc3RhYmxpc2hlZCB0cnVzdGVkIGhvc3QgVVJMcy4gXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgQUFEVHJ1c3RlZEhvc3RMaXN0OiBzdHJpbmdbXSA9IFtcclxuICAgIFwibG9naW4ud2luZG93cy5uZXRcIixcclxuICAgIFwibG9naW4uY2hpbmFjbG91ZGFwaS5jblwiLFxyXG4gICAgXCJsb2dpbi5jbG91ZGdvdmFwaS51c1wiLFxyXG4gICAgXCJsb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tXCIsXHJcbiAgICBcImxvZ2luLm1pY3Jvc29mdG9ubGluZS5kZVwiLFxyXG4gICAgXCJsb2dpbi5taWNyb3NvZnRvbmxpbmUudXNcIlxyXG5dO1xyXG5cclxuLyoqXHJcbiAqIFN0cmluZyBjb25zdGFudHMgcmVsYXRlZCB0byBBQUQgQXV0aG9yaXR5XHJcbiAqL1xyXG5leHBvcnQgZW51bSBBQURBdXRob3JpdHlDb25zdGFudHMge1xyXG4gICAgQ09NTU9OID0gXCJjb21tb25cIixcclxuICAgIE9SR0FOSVpBVElPTlMgPSBcIm9yZ2FuaXphdGlvbnNcIixcclxuICAgIENPTlNVTUVSUyA9IFwiY29uc3VtZXJzXCJcclxufTtcclxuXHJcbi8qKlxyXG4gKiBLZXlzIGluIHRoZSBoYXNoUGFyYW1zIHNlbnQgYnkgQUFEIFNlcnZlclxyXG4gKi9cclxuZXhwb3J0IGVudW0gQUFEU2VydmVyUGFyYW1LZXlzIHtcclxuICAgIENMSUVOVF9JRCA9IFwiY2xpZW50X2lkXCIsXHJcbiAgICBSRVNPVVJDRSA9IFwicmVzb3VyY2VcIixcclxuICAgIFJFRElSRUNUX1VSSSA9IFwicmVkaXJlY3RfdXJpXCIsXHJcbiAgICBSRVNQT05TRV9UWVBFID0gXCJyZXNwb25zZV90eXBlXCIsXHJcbiAgICBSRVNQT05TRV9NT0RFID0gXCJyZXNwb25zZV9tb2RlXCIsXHJcbiAgICBHUkFOVF9UWVBFID0gXCJncmFudF90eXBlXCIsXHJcbiAgICBDTEFJTVMgPSBcImNsYWltc1wiLFxyXG4gICAgU0NPUEUgPSBcInNjb3BlXCIsXHJcbiAgICBFUlJPUiA9IFwiZXJyb3JcIixcclxuICAgIEVSUk9SX0RFU0NSSVBUSU9OID0gXCJlcnJvcl9kZXNjcmlwdGlvblwiLFxyXG4gICAgQUNDRVNTX1RPS0VOID0gXCJhY2Nlc3NfdG9rZW5cIixcclxuICAgIElEX1RPS0VOID0gXCJpZF90b2tlblwiLFxyXG4gICAgUkVGUkVTSF9UT0tFTiA9IFwicmVmcmVzaF90b2tlblwiLFxyXG4gICAgRVhQSVJFU19JTiA9IFwiZXhwaXJlc19pblwiLFxyXG4gICAgU1RBVEUgPSBcInN0YXRlXCIsXHJcbiAgICBOT05DRSA9IFwibm9uY2VcIixcclxuICAgIFBST01QVCA9IFwicHJvbXB0XCIsXHJcbiAgICBTRVNTSU9OX1NUQVRFID0gXCJzZXNzaW9uX3N0YXRlXCIsXHJcbiAgICBDTElFTlRfSU5GTyA9IFwiY2xpZW50X2luZm9cIixcclxuICAgIENPREUgPSBcImNvZGVcIixcclxuICAgIENPREVfQ0hBTExFTkdFID0gXCJjb2RlX2NoYWxsZW5nZVwiLFxyXG4gICAgQ09ERV9DSEFMTEVOR0VfTUVUSE9EID0gXCJjb2RlX2NoYWxsZW5nZV9tZXRob2RcIixcclxuICAgIENPREVfVkVSSUZJRVIgPSBcImNvZGVfdmVyaWZpZXJcIixcclxuICAgIENMSUVOVF9SRVFVRVNUX0lEID0gXCJjbGllbnQtcmVxdWVzdC1pZFwiLFxyXG4gICAgWF9DTElFTlRfU0tVID0gXCJ4LWNsaWVudC1TS1VcIixcclxuICAgIFhfQ0xJRU5UX1ZFUiA9IFwieC1jbGllbnQtVmVyXCIsXHJcbiAgICBQT1NUX0xPR09VVF9VUkkgPSBcInBvc3RfbG9nb3V0X3JlZGlyZWN0X3VyaVwiXHJcbn07XHJcblxyXG4vKipcclxuICogSWRUb2tlbiBjbGFpbSBzdHJpbmcgY29uc3RhbnRzXHJcbiAqL1xyXG5leHBvcnQgZW51bSBJZFRva2VuQ2xhaW1OYW1lIHtcclxuICAgIElTU1VFUiA9IFwiaXNzXCIsXHJcbiAgICBPQkpJRCA9IFwib2lkXCIsXHJcbiAgICBTVUJKRUNUID0gXCJzdWJcIixcclxuICAgIFRFTkFOVElEID0gXCJ0aWRcIixcclxuICAgIFZFUlNJT04gPSBcInZlclwiLFxyXG4gICAgUFJFRl9VU0VSTkFNRSA9IFwicHJlZmVycmVkX3VzZXJuYW1lXCIsXHJcbiAgICBOQU1FID0gXCJuYW1lXCIsXHJcbiAgICBOT05DRSA9IFwibm9uY2VcIixcclxuICAgIEVYUElSQVRJT04gPSBcImV4cFwiLFxyXG4gICAgSE9NRV9PQkpJRCA9IFwiaG9tZV9vaWRcIixcclxuICAgIFNFU1NJT05JRCA9IFwic2lkXCIsXHJcbiAgICBDTE9VRF9JTlNUQU5DRV9IT1NUTkFNRSA9IFwiY2xvdWRfaW5zdGFuY2VfaG9zdF9uYW1lXCJcclxufVxyXG5cclxuLyoqXHJcbiAqIHdlIGNvbnNpZGVyZWQgbWFraW5nIHRoaXMgXCJlbnVtXCIgaW4gdGhlIHJlcXVlc3QgaW5zdGVhZCBvZiBzdHJpbmcsIGhvd2V2ZXIgaXQgbG9va3MgbGlrZSB0aGUgYWxsb3dlZCBsaXN0IG9mXHJcbiAqIHByb21wdCB2YWx1ZXMga2VwdCBjaGFuZ2luZyBvdmVyIHBhc3QgY291cGxlIG9mIHllYXJzLiBUaGVyZSBhcmUgc29tZSB1bmRvY3VtZW50ZWQgcHJvbXB0IHZhbHVlcyBmb3Igc29tZVxyXG4gKiBpbnRlcm5hbCBwYXJ0bmVycyB0b28sIGhlbmNlIHRoZSBjaG9pY2Ugb2YgZ2VuZXJpYyBcInN0cmluZ1wiIHR5cGUgaW5zdGVhZCBvZiB0aGUgXCJlbnVtXCJcclxuICovXHJcbmV4cG9ydCBjb25zdCBQcm9tcHRTdGF0ZSA9IHtcclxuICAgIExPR0lOOiBcImxvZ2luXCIsXHJcbiAgICBTRUxFQ1RfQUNDT1VOVDogXCJzZWxlY3RfYWNjb3VudFwiLFxyXG4gICAgQ09OU0VOVDogXCJjb25zZW50XCIsXHJcbiAgICBOT05FOiBcIm5vbmVcIixcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTU08gVHlwZXMgLSBnZW5lcmF0ZWQgdG8gcG9wdWxhdGUgaGludHNcclxuICovXHJcbmV4cG9ydCBlbnVtIFNTT1R5cGVzIHtcclxuICAgIEFDQ09VTlQgPSBcImFjY291bnRcIixcclxuICAgIFNJRCA9IFwic2lkXCIsXHJcbiAgICBMT0dJTl9ISU5UID0gXCJsb2dpbl9oaW50XCIsXHJcbiAgICBJRF9UT0tFTiA9XCJpZF90b2tlblwiLFxyXG4gICAgRE9NQUlOX0hJTlQgPSBcImRvbWFpbl9oaW50XCIsXHJcbiAgICBPUkdBTklaQVRJT05TID0gXCJvcmdhbml6YXRpb25zXCIsXHJcbiAgICBDT05TVU1FUlMgPSBcImNvbnN1bWVyc1wiLFxyXG4gICAgQUNDT1VOVF9JRCA9IFwiYWNjb3VudElkZW50aWZpZXJcIixcclxuICAgIEhPTUVBQ0NPVU5UX0lEID0gXCJob21lQWNjb3VudElkZW50aWZpZXJcIlxyXG59O1xyXG5cclxuLyoqXHJcbiAqIERpc2FsbG93ZWQgZXh0cmEgcXVlcnkgcGFyYW1ldGVycy5cclxuICovXHJcbmV4cG9ydCBjb25zdCBCbGFja2xpc3RlZEVRUGFyYW1zID0gW1xyXG4gICAgU1NPVHlwZXMuU0lELFxyXG4gICAgU1NPVHlwZXMuTE9HSU5fSElOVFxyXG5dO1xyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQWNjZXNzVG9rZW5DYWNoZUl0ZW0gfSBmcm9tIFwiLi9BY2Nlc3NUb2tlbkNhY2hlSXRlbVwiO1xyXG5pbXBvcnQgeyBBY2Nlc3NUb2tlbktleSB9IGZyb20gXCIuL0FjY2Vzc1Rva2VuS2V5XCI7XHJcbmltcG9ydCB7IEFjY2Vzc1Rva2VuVmFsdWUgfSBmcm9tIFwiLi9BY2Nlc3NUb2tlblZhbHVlXCI7XHJcbmltcG9ydCB7IElDYWNoZVN0b3JhZ2UgfSBmcm9tIFwiLi9JQ2FjaGVTdG9yYWdlXCI7XHJcbmltcG9ydCB7IEFjY291bnQgfSBmcm9tIFwiLi4vYXV0aC9BY2NvdW50XCI7XHJcbmltcG9ydCB7IEF1dGhvcml0eSB9IGZyb20gXCIuLi9hdXRoL2F1dGhvcml0eS9BdXRob3JpdHlcIjtcclxuaW1wb3J0IHsgU2VydmVyQ29kZVJlcXVlc3RQYXJhbWV0ZXJzIH0gZnJvbSBcIi4uL3NlcnZlci9TZXJ2ZXJDb2RlUmVxdWVzdFBhcmFtZXRlcnNcIjtcclxuaW1wb3J0IHsgQ2xpZW50QXV0aEVycm9yIH0gZnJvbSBcIi4uL2Vycm9yL0NsaWVudEF1dGhFcnJvclwiO1xyXG5pbXBvcnQgeyBTdHJpbmdVdGlscyB9IGZyb20gXCIuLi91dGlscy9TdHJpbmdVdGlsc1wiO1xyXG5pbXBvcnQgeyBUZW1wb3JhcnlDYWNoZUtleXMsIENvbnN0YW50cyB9IGZyb20gXCIuLi91dGlscy9Db25zdGFudHNcIjtcclxuXHJcbi8qKlxyXG4gKiBUaGUgQ2FjaGVIZWxwZXJzIGNsYXNzIGNvbnRhaW5zIGEgc2V0IG9mIGhlbHBlciBmdW5jdGlvbnMgdXNlZCBieSB0aGUgbW9kdWxlIHRvIG1hbmFnZSBjYWNoZSBpdGVtcy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBDYWNoZUhlbHBlcnMge1xyXG5cclxuICAgIC8vIFN0b3JhZ2UgaW50ZXJmYWNlXHJcbiAgICBwcml2YXRlIGNhY2hlU3RvcmFnZTogSUNhY2hlU3RvcmFnZTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihjYWNoZUltcGw6IElDYWNoZVN0b3JhZ2UpIHtcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZSA9IGNhY2hlSW1wbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBhY3F1aXJlVG9rZW5BY2NvdW50S2V5IHRvIGNhY2hlIGFjY291bnQgb2JqZWN0XHJcbiAgICAgKiBAcGFyYW0gYWNjb3VudElkXHJcbiAgICAgKiBAcGFyYW0gc3RhdGVcclxuICAgICAqL1xyXG4gICAgZ2VuZXJhdGVBY3F1aXJlVG9rZW5BY2NvdW50S2V5KGFjY291bnRJZDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gYCR7VGVtcG9yYXJ5Q2FjaGVLZXlzLkFDUVVJUkVfVE9LRU5fQUNDT1VOVH0ke0NvbnN0YW50cy5SRVNPVVJDRV9ERUxJTX0ke2FjY291bnRJZH1gO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIGF1dGhvcml0eUtleSB0byBjYWNoZSBhdXRob3JpdHlcclxuICAgICAqIEBwYXJhbSBzdGF0ZVxyXG4gICAgICovXHJcbiAgICBnZW5lcmF0ZUF1dGhvcml0eUtleShzdGF0ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gYCR7VGVtcG9yYXJ5Q2FjaGVLZXlzLkFVVEhPUklUWX0ke0NvbnN0YW50cy5SRVNPVVJDRV9ERUxJTX0ke3N0YXRlfWA7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGUgTm9uY2Uga2V5IHRvIGNhY2hlIG5vbmNlXHJcbiAgICAgKiBAcGFyYW0gc3RhdGUgXHJcbiAgICAgKi9cclxuICAgIGdlbmVyYXRlTm9uY2VLZXkoc3RhdGU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGAke1RlbXBvcmFyeUNhY2hlS2V5cy5OT05DRV9JRFRPS0VOfSR7Q29uc3RhbnRzLlJFU09VUkNFX0RFTElNfSR7c3RhdGV9YDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldHMgdGhlIGNhY2hla2V5cyBmb3IgYW5kIHN0b3JlcyB0aGUgYWNjb3VudCBpbmZvcm1hdGlvbiBpbiBjYWNoZVxyXG4gICAgICogQHBhcmFtIGFjY291bnRcclxuICAgICAqIEBwYXJhbSBzdGF0ZVxyXG4gICAgICovXHJcbiAgICBzZXRBY2NvdW50Q2FjaGUoYWNjb3VudDogQWNjb3VudCk6IHZvaWQge1xyXG4gICAgICAgIC8vIENhY2hlIGFjcXVpcmVUb2tlbkFjY291bnRLZXlcclxuICAgICAgICBjb25zdCBhY2NvdW50SWQgPSBhY2NvdW50ICYmIGFjY291bnQuaG9tZUFjY291bnRJZGVudGlmaWVyID8gYWNjb3VudC5ob21lQWNjb3VudElkZW50aWZpZXIgOiBDb25zdGFudHMuTk9fQUNDT1VOVDtcclxuXHJcbiAgICAgICAgY29uc3QgYWNxdWlyZVRva2VuQWNjb3VudEtleSA9IHRoaXMuZ2VuZXJhdGVBY3F1aXJlVG9rZW5BY2NvdW50S2V5KGFjY291bnRJZCk7XHJcbiAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShhY3F1aXJlVG9rZW5BY2NvdW50S2V5LCBKU09OLnN0cmluZ2lmeShhY2NvdW50KSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXRzIHRoZSBjYWNoZUtleSBmb3IgYW5kIHN0b3JlcyB0aGUgYXV0aG9yaXR5IGluZm9ybWF0aW9uIGluIGNhY2hlXHJcbiAgICAgKiBAcGFyYW0gc3RhdGVcclxuICAgICAqIEBwYXJhbSBhdXRob3JpdHlcclxuICAgICAqL1xyXG4gICAgc2V0QXV0aG9yaXR5Q2FjaGUoYXV0aG9yaXR5OiBBdXRob3JpdHksIHN0YXRlOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICAvLyBDYWNoZSBhdXRob3JpdHlLZXlcclxuICAgICAgICBjb25zdCBhdXRob3JpdHlLZXkgPSB0aGlzLmdlbmVyYXRlQXV0aG9yaXR5S2V5KHN0YXRlKTtcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKGF1dGhvcml0eUtleSwgYXV0aG9yaXR5LmNhbm9uaWNhbEF1dGhvcml0eSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIGFjY291bnQsIGF1dGhvcml0eSwgYW5kIHN0YXRlIGluIGNhY2hlXHJcbiAgICAgKiBAcGFyYW0gc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0XHJcbiAgICAgKiBAcGFyYW0gYWNjb3VudFxyXG4gICAgICovXHJcbiAgICB1cGRhdGVDYWNoZUVudHJpZXMoc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0OiBTZXJ2ZXJDb2RlUmVxdWVzdFBhcmFtZXRlcnMsIGFjY291bnQ6IEFjY291bnQpOiB2b2lkIHtcclxuICAgICAgICAvLyBDYWNoZSBhY2NvdW50IGFuZCBzdGF0ZVxyXG4gICAgICAgIGlmIChhY2NvdW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QWNjb3VudENhY2hlKGFjY291bnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2FjaGUgdGhlIHJlcXVlc3Qgc3RhdGVcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5SRVFVRVNUX1NUQVRFLCBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGUpO1xyXG5cclxuICAgICAgICAvLyBDYWNoZSB0aGUgbm9uY2VcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKHRoaXMuZ2VuZXJhdGVOb25jZUtleShzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGUpLCBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Qubm9uY2UpO1xyXG5cclxuICAgICAgICAvLyBDYWNoZSBhdXRob3JpdHlLZXlcclxuICAgICAgICB0aGlzLnNldEF1dGhvcml0eUNhY2hlKHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5hdXRob3JpdHlJbnN0YW5jZSwgc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LnN0YXRlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0IGFsbCB0ZW1wb3JhcnkgY2FjaGUgaXRlbXNcclxuICAgICAqIEBwYXJhbSBzdGF0ZSBcclxuICAgICAqL1xyXG4gICAgcmVzZXRUZW1wQ2FjaGVJdGVtcyhzdGF0ZT86IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIC8vIGNoZWNrIHN0YXRlIGFuZCByZW1vdmUgYXNzb2NpYXRlZCBjYWNoZSBpdGVtc1xyXG4gICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLmdldEtleXMoKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShzdGF0ZSkgJiYga2V5LmluZGV4T2Yoc3RhdGUpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3BsaXRLZXkgPSBrZXkuc3BsaXQoQ29uc3RhbnRzLlJFU09VUkNFX0RFTElNKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGtleVN0YXRlID0gc3BsaXRLZXkubGVuZ3RoID4gMSA/IHNwbGl0S2V5W3NwbGl0S2V5Lmxlbmd0aC0xXTogbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChrZXlTdGF0ZSA9PT0gc3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBkZWxldGUgZ2VuZXJpYyBpbnRlcmFjdGl2ZSByZXF1ZXN0IHBhcmFtZXRlcnNcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5SRVFVRVNUX1NUQVRFKTtcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5PUklHSU5fVVJJKTtcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5SRURJUkVDVF9SRVFVRVNUKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBhbGwgYWNjZXNzIHRva2VucyBpbiB0aGUgY2FjaGVcclxuICAgICAqIEBwYXJhbSBjbGllbnRJZFxyXG4gICAgICogQHBhcmFtIGhvbWVBY2NvdW50SWRlbnRpZmllclxyXG4gICAgICovXHJcbiAgICBnZXRBbGxBY2Nlc3NUb2tlbnMoY2xpZW50SWQ6IHN0cmluZywgYXV0aG9yaXR5OiBzdHJpbmcsIHJlc291cmNlPzogc3RyaW5nLCBob21lQWNjb3VudElkZW50aWZpZXI/OiBzdHJpbmcpOiBBcnJheTxBY2Nlc3NUb2tlbkNhY2hlSXRlbT4ge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSB0aGlzLmNhY2hlU3RvcmFnZS5nZXRLZXlzKCkucmVkdWNlPEFycmF5PEFjY2Vzc1Rva2VuQ2FjaGVJdGVtPj4oKHRva2Vucywga2V5KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleU1hdGNoZXMgPSBrZXkubWF0Y2goY2xpZW50SWQpICYmIGtleS5tYXRjaChhdXRob3JpdHkpICYmIGtleS5tYXRjaChyZXNvdXJjZSkgJiYga2V5Lm1hdGNoKGhvbWVBY2NvdW50SWRlbnRpZmllcik7XHJcbiAgICAgICAgICAgIGlmIChrZXlNYXRjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlQXRLZXkgPSBKU09OLnBhcnNlKGtleSkgYXMgQWNjZXNzVG9rZW5LZXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0FjY2Vzc1Rva2VuQ2FjaGVJdGVtID0gbmV3IEFjY2Vzc1Rva2VuQ2FjaGVJdGVtKHBhcnNlQXRLZXksIEpTT04ucGFyc2UodmFsdWUpIGFzIEFjY2Vzc1Rva2VuVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW5zLmNvbmNhdChbIG5ld0FjY2Vzc1Rva2VuQ2FjaGVJdGVtIF0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUNhY2hlUGFyc2VFcnJvcihrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdG9rZW5zO1xyXG4gICAgICAgIH0sIFtdKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgYWxsIGFjY2VzcyB0b2tlbnMgaW4gdGhlIGNhY2hlXHJcbiAgICAgKiBAcGFyYW0gY2xpZW50SWRcclxuICAgICAqIEBwYXJhbSBob21lQWNjb3VudElkZW50aWZpZXJcclxuICAgICAqL1xyXG4gICAgcmVtb3ZlQWxsQWNjZXNzVG9rZW5zKGNsaWVudElkOiBzdHJpbmcsIGF1dGhvcml0eTogc3RyaW5nLCByZXNvdXJjZT86IHN0cmluZywgaG9tZUFjY291bnRJZGVudGlmaWVyPzogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UuZ2V0S2V5cygpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBrZXlNYXRjaGVzID0ga2V5Lm1hdGNoKGNsaWVudElkKSAmJiBrZXkubWF0Y2goYXV0aG9yaXR5KSAmJiBrZXkubWF0Y2gocmVzb3VyY2UpICYmIGtleS5tYXRjaChob21lQWNjb3VudElkZW50aWZpZXIpO1xyXG4gICAgICAgICAgICBpZiAoa2V5TWF0Y2hlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IENsaWVudEluZm8gfSBmcm9tIFwiLi9DbGllbnRJbmZvXCI7XHJcbmltcG9ydCB7IElkVG9rZW4gfSBmcm9tIFwiLi9JZFRva2VuXCI7XHJcbmltcG9ydCB7IElkVG9rZW5DbGFpbXMgfSBmcm9tIFwiLi9JZFRva2VuQ2xhaW1zXCI7XHJcbmltcG9ydCB7IFN0cmluZ1V0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL1N0cmluZ1V0aWxzXCI7XHJcbmltcG9ydCB7IElDcnlwdG8gfSBmcm9tIFwiLi4vY3J5cHRvL0lDcnlwdG9cIjtcclxuXHJcbi8qKlxyXG4gKiBhY2NvdW50SWRlbnRpZmllciAgICAgICBjb21iaW5hdGlvbiBvZiBpZFRva2VuLnVpZCBhbmQgaWRUb2tlbi51dGlkXHJcbiAqIGhvbWVBY2NvdW50SWRlbnRpZmllciAgIGNvbWJpbmF0aW9uIG9mIGNsaWVudEluZm8udWlkIGFuZCBjbGllbnRJbmZvLnV0aWRcclxuICogdXNlck5hbWUgICAgICAgICAgICAgICAgaWRUb2tlbi5wcmVmZXJyZWRfdXNlcm5hbWVcclxuICogbmFtZSAgICAgICAgICAgICAgICAgICAgaWRUb2tlbi5uYW1lXHJcbiAqIGlkVG9rZW4gICAgICAgICAgICAgICAgIGlkVG9rZW5cclxuICogc2lkICAgICAgICAgICAgICAgICAgICAgaWRUb2tlbi5zaWQgLSBzZXNzaW9uIGlkZW50aWZpZXJcclxuICogZW52aXJvbm1lbnQgICAgICAgICAgICAgaWR0b2tlbi5pc3N1ZXIgKHRoZSBhdXRob3JpdHkgdGhhdCBpc3N1ZXMgdGhlIHRva2VuKVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFjY291bnQge1xyXG5cclxuICAgIGFjY291bnRJZGVudGlmaWVyOiBzdHJpbmc7XHJcbiAgICBob21lQWNjb3VudElkZW50aWZpZXI6IHN0cmluZztcclxuICAgIHVzZXJOYW1lOiBzdHJpbmc7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBpZFRva2VuOiBzdHJpbmc7XHJcbiAgICBpZFRva2VuQ2xhaW1zOiBJZFRva2VuQ2xhaW1zO1xyXG4gICAgc2lkOiBzdHJpbmc7XHJcbiAgICBlbnZpcm9ubWVudDogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBBY2NvdW50IE9iamVjdFxyXG4gICAgICogQHByYXJhbSBhY2NvdW50SWRlbnRpZmllclxyXG4gICAgICogQHBhcmFtIGhvbWVBY2NvdW50SWRlbnRpZmllclxyXG4gICAgICogQHBhcmFtIHVzZXJOYW1lXHJcbiAgICAgKiBAcGFyYW0gbmFtZVxyXG4gICAgICogQHBhcmFtIGlkVG9rZW5cclxuICAgICAqIEBwYXJhbSBzaWRcclxuICAgICAqIEBwYXJhbSBlbnZpcm9ubWVudFxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihhY2NvdW50SWRlbnRpZmllcjogc3RyaW5nLCBob21lQWNjb3VudElkZW50aWZpZXI6IHN0cmluZywgaWRUb2tlbkNsYWltczogSWRUb2tlbkNsYWltcywgcmF3SWRUb2tlbjogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5hY2NvdW50SWRlbnRpZmllciA9IGFjY291bnRJZGVudGlmaWVyO1xyXG4gICAgICAgIHRoaXMuaG9tZUFjY291bnRJZGVudGlmaWVyID0gaG9tZUFjY291bnRJZGVudGlmaWVyO1xyXG4gICAgICAgIHRoaXMudXNlck5hbWUgPSBpZFRva2VuQ2xhaW1zLnByZWZlcnJlZF91c2VybmFtZTtcclxuICAgICAgICB0aGlzLm5hbWUgPSBpZFRva2VuQ2xhaW1zLm5hbWU7XHJcbiAgICAgICAgLy8gd2lsbCBiZSBkZXByZWNhdGVkIHNvb25cclxuICAgICAgICB0aGlzLmlkVG9rZW4gPSByYXdJZFRva2VuO1xyXG4gICAgICAgIHRoaXMuaWRUb2tlbkNsYWltcyA9IGlkVG9rZW5DbGFpbXM7XHJcbiAgICAgICAgdGhpcy5zaWQgPSBpZFRva2VuQ2xhaW1zLnNpZDtcclxuICAgICAgICB0aGlzLmVudmlyb25tZW50ID0gaWRUb2tlbkNsYWltcy5pc3M7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gaWRUb2tlblxyXG4gICAgICogQHBhcmFtIGNsaWVudEluZm9cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZUFjY291bnQoaWRUb2tlbjogSWRUb2tlbiwgY2xpZW50SW5mbzogQ2xpZW50SW5mbywgY3J5cHRvOiBJQ3J5cHRvKTogQWNjb3VudCB7XHJcblxyXG4gICAgICAgIC8vIGNyZWF0ZSBhY2NvdW50SWRlbnRpZmllclxyXG4gICAgICAgIGNvbnN0IGFjY291bnRJZGVudGlmaWVyOiBzdHJpbmcgPSBpZFRva2VuLmNsYWltcy5vaWQgfHwgIGlkVG9rZW4uY2xhaW1zLnN1YjtcclxuXHJcbiAgICAgICAgLy8gY3JlYXRlIGhvbWVBY2NvdW50SWRlbnRpZmllclxyXG4gICAgICAgIGNvbnN0IHVpZDogc3RyaW5nID0gY2xpZW50SW5mbyA/IGNsaWVudEluZm8udWlkIDogXCJcIjtcclxuICAgICAgICBjb25zdCB1dGlkOiBzdHJpbmcgPSBjbGllbnRJbmZvID8gY2xpZW50SW5mby51dGlkIDogXCJcIjtcclxuXHJcbiAgICAgICAgbGV0IGhvbWVBY2NvdW50SWRlbnRpZmllcjogc3RyaW5nO1xyXG4gICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eSh1aWQpICYmICFTdHJpbmdVdGlscy5pc0VtcHR5KHV0aWQpKSB7XHJcbiAgICAgICAgICAgIGhvbWVBY2NvdW50SWRlbnRpZmllciA9IGNyeXB0by5iYXNlNjRFbmNvZGUodWlkKSArIFwiLlwiICsgY3J5cHRvLmJhc2U2NEVuY29kZSh1dGlkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBY2NvdW50KGFjY291bnRJZGVudGlmaWVyLCBob21lQWNjb3VudElkZW50aWZpZXIsIGlkVG9rZW4uY2xhaW1zLCBpZFRva2VuLnJhd0lkVG9rZW4pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXRpbHMgZnVuY3Rpb24gdG8gY29tcGFyZSB0d28gQWNjb3VudCBvYmplY3RzIC0gdXNlZCB0byBjaGVjayBpZiB0aGUgc2FtZSB1c2VyIGFjY291bnQgaXMgbG9nZ2VkIGluXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGExOiBBY2NvdW50IG9iamVjdFxyXG4gICAgICogQHBhcmFtIGEyOiBBY2NvdW50IG9iamVjdFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY29tcGFyZUFjY291bnRzKGExOiBBY2NvdW50LCBhMjogQWNjb3VudCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmICghKGExICYmIGExLmhvbWVBY2NvdW50SWRlbnRpZmllcikgfHwgIShhMiAmJiBhMi5ob21lQWNjb3VudElkZW50aWZpZXIpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGExLmhvbWVBY2NvdW50SWRlbnRpZmllciA9PT0gYTIuaG9tZUFjY291bnRJZGVudGlmaWVyO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5pbXBvcnQgeyBJZFRva2VuQ2xhaW1zIH0gZnJvbSBcIi4vSWRUb2tlbkNsYWltc1wiO1xyXG5pbXBvcnQgeyBEZWNvZGVkSnd0IH0gZnJvbSBcIi4vRGVjb2RlZEp3dFwiO1xyXG5pbXBvcnQgeyBDbGllbnRBdXRoRXJyb3IgfSBmcm9tIFwiLi4vZXJyb3IvQ2xpZW50QXV0aEVycm9yXCI7XHJcbmltcG9ydCB7IFN0cmluZ1V0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL1N0cmluZ1V0aWxzXCI7XHJcbmltcG9ydCB7IElDcnlwdG8gfSBmcm9tIFwiLi4vY3J5cHRvL0lDcnlwdG9cIjtcclxuXHJcbi8qKlxyXG4gKiBJZCBUb2tlbiByZXByZXNlbnRhdGlvbiBjbGFzcy4gUGFyc2VzIGlkIHRva2VuIHN0cmluZyBhbmQgZ2VuZXJhdGVzIGNsYWltcyBvYmplY3QuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgSWRUb2tlbiB7XHJcblxyXG4gICAgLy8gUmF3IElkIFRva2VuIHN0cmluZ1xyXG4gICAgcmF3SWRUb2tlbjogc3RyaW5nO1xyXG4gICAgLy8gQ2xhaW1zIGluc2lkZSBJZCBUb2tlblxyXG4gICAgY2xhaW1zOiBJZFRva2VuQ2xhaW1zO1xyXG4gICAgY29uc3RydWN0b3IocmF3SWRUb2tlbjogc3RyaW5nLCBjcnlwdG86IElDcnlwdG8pIHtcclxuICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShyYXdJZFRva2VuKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlSWRUb2tlbk51bGxPckVtcHR5RXJyb3IocmF3SWRUb2tlbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnJhd0lkVG9rZW4gPSByYXdJZFRva2VuO1xyXG4gICAgICAgIHRoaXMuY2xhaW1zID0gSWRUb2tlbi5leHRyYWN0SWRUb2tlbihyYXdJZFRva2VuLCBjcnlwdG8pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBJZFRva2VuIGJ5IGRlY29kaW5nIHRoZSBSQVdJZFRva2VuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGVuY29kZWRJZFRva2VuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBleHRyYWN0SWRUb2tlbihlbmNvZGVkSWRUb2tlbjogc3RyaW5nLCBjcnlwdG86IElDcnlwdG8pOiBJZFRva2VuQ2xhaW1zIHtcclxuICAgICAgICAvLyBpZCB0b2tlbiB3aWxsIGJlIGRlY29kZWQgdG8gZ2V0IHRoZSB1c2VybmFtZVxyXG4gICAgICAgIGNvbnN0IGRlY29kZWRUb2tlbjogRGVjb2RlZEp3dCA9IFN0cmluZ1V0aWxzLmRlY29kZUp3dChlbmNvZGVkSWRUb2tlbik7XHJcbiAgICAgICAgaWYgKCFkZWNvZGVkVG9rZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJhc2U2NElkVG9rZW4gPSBkZWNvZGVkVG9rZW4uSldTUGF5bG9hZDtcclxuICAgICAgICAgICAgLy8gYmFzZTY0RGVjb2RlKCkgc2hvdWxkIHRocm93IGFuIGVycm9yIGlmIHRoZXJlIGlzIGFuIGlzc3VlXHJcbiAgICAgICAgICAgIGNvbnN0IGJhc2U2NERlY29kZWQgPSBjcnlwdG8uYmFzZTY0RGVjb2RlKGJhc2U2NElkVG9rZW4pO1xyXG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShiYXNlNjREZWNvZGVkKSBhcyBJZFRva2VuQ2xhaW1zO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlSWRUb2tlblBhcnNpbmdFcnJvcihKU09OLnN0cmluZ2lmeShlcnIpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IENsaWVudEF1dGhFcnJvciB9IGZyb20gXCIuLi9lcnJvci9DbGllbnRBdXRoRXJyb3JcIjtcclxuaW1wb3J0IHsgU3RyaW5nVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvU3RyaW5nVXRpbHNcIjtcclxuaW1wb3J0IHsgSUNyeXB0byB9IGZyb20gXCIuLi9jcnlwdG8vSUNyeXB0b1wiO1xyXG5cclxuLyoqXHJcbiAqIENsaWVudCBpbmZvIG9iamVjdCB3aGljaCBjb25zaXN0cyBvZiB0d28gSURzLiBOZWVkIHRvIGFkZCBtb3JlIGluZm8gaGVyZS5cclxuICovXHJcbmV4cG9ydCB0eXBlIENsaWVudEluZm8gPSB7XHJcbiAgICB1aWQ6IHN0cmluZyxcclxuICAgIHV0aWQ6IHN0cmluZ1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEZ1bmN0aW9uIHRvIGJ1aWxkIGEgY2xpZW50IGluZm8gb2JqZWN0XHJcbiAqIEBwYXJhbSByYXdDbGllbnRJbmZvIFxyXG4gKiBAcGFyYW0gY3J5cHRvIFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkQ2xpZW50SW5mbyhyYXdDbGllbnRJbmZvOiBzdHJpbmcsIGNyeXB0bzogSUNyeXB0byk6IENsaWVudEluZm8ge1xyXG4gICAgaWYgKCFyYXdDbGllbnRJbmZvIHx8IFN0cmluZ1V0aWxzLmlzRW1wdHkocmF3Q2xpZW50SW5mbykpIHtcclxuICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlQ2xpZW50SW5mb0VtcHR5RXJyb3IocmF3Q2xpZW50SW5mbyk7XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBkZWNvZGVkQ2xpZW50SW5mbzogc3RyaW5nID0gY3J5cHRvLmJhc2U2NERlY29kZShyYXdDbGllbnRJbmZvKTtcclxuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShkZWNvZGVkQ2xpZW50SW5mbykgYXMgQ2xpZW50SW5mbztcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlQ2xpZW50SW5mb0RlY29kaW5nRXJyb3IoZSk7XHJcbiAgICB9XHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCBwa2cgZnJvbSBcIi4uLy4uL3BhY2thZ2UuanNvblwiO1xyXG5pbXBvcnQgeyBTdHJpbmdVdGlscyB9IGZyb20gXCIuLi91dGlscy9TdHJpbmdVdGlsc1wiO1xyXG5pbXBvcnQgeyBMb2dnZXJPcHRpb25zIH0gZnJvbSBcIi4uL2FwcC9jb25maWcvTW9kdWxlQ29uZmlndXJhdGlvbi5qc1wiO1xyXG5cclxuLyoqXHJcbiAqIE9wdGlvbnMgZm9yIGxvZ2dlciBtZXNzYWdlcy5cclxuICovXHJcbmV4cG9ydCB0eXBlIExvZ2dlck1lc3NhZ2VPcHRpb25zID0ge1xyXG4gICAgbG9nTGV2ZWw6IExvZ0xldmVsLFxyXG4gICAgY29ycmVsYXRpb25JZD86IHN0cmluZyxcclxuICAgIGNvbnRhaW5zUGlpPzogYm9vbGVhblxyXG59O1xyXG5cclxuLyoqXHJcbiAqIExvZyBtZXNzYWdlIGxldmVsLlxyXG4gKi9cclxuZXhwb3J0IGVudW0gTG9nTGV2ZWwge1xyXG4gICAgRXJyb3IsXHJcbiAgICBXYXJuaW5nLFxyXG4gICAgSW5mbyxcclxuICAgIFZlcmJvc2VcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDYWxsYmFjayB0byBzZW5kIHRoZSBtZXNzYWdlcyB0by5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUxvZ2dlckNhbGxiYWNrIHtcclxuICAgIChsZXZlbDogTG9nTGV2ZWwsIG1lc3NhZ2U6IHN0cmluZywgY29udGFpbnNQaWk6IGJvb2xlYW4pOiB2b2lkO1xyXG59XHJcblxyXG4vKipcclxuICogQ2xhc3Mgd2hpY2ggZmFjaWxpdGF0ZXMgbG9nZ2luZyBvZiBtZXNzYWdlcyB0byBhIHNwZWNpZmljIHBsYWNlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIExvZ2dlciB7XHJcblxyXG4gICAgLy8gQ29ycmVsYXRpb24gSUQgZm9yIHJlcXVlc3QsIHVzdWFsbHkgc2V0IGJ5IHVzZXIuXHJcbiAgICBwcml2YXRlIGNvcnJlbGF0aW9uSWQ6IHN0cmluZztcclxuXHJcbiAgICAvLyBDdXJyZW50IGxvZyBsZXZlbCwgZGVmYXVsdHMgdG8gaW5mby5cclxuICAgIHByaXZhdGUgbGV2ZWw6IExvZ0xldmVsID0gTG9nTGV2ZWwuSW5mbztcclxuXHJcbiAgICAvLyBCb29sZWFuIGRlc2NyaWJpbmcgd2hldGhlciBQSUkgbG9nZ2luZyBpcyBhbGxvd2VkLlxyXG4gICAgcHJpdmF0ZSBwaWlMb2dnaW5nRW5hYmxlZDogYm9vbGVhbjtcclxuXHJcbiAgICAvLyBDYWxsYmFjayB0byBzZW5kIG1lc3NhZ2VzIHRvLlxyXG4gICAgcHJpdmF0ZSBsb2NhbENhbGxiYWNrOiBJTG9nZ2VyQ2FsbGJhY2s7XHJcblxyXG4gICAgY29uc3RydWN0b3IobG9nZ2VyT3B0aW9uczogTG9nZ2VyT3B0aW9ucykge1xyXG4gICAgICAgIGlmIChsb2dnZXJPcHRpb25zKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9jYWxDYWxsYmFjayA9IGxvZ2dlck9wdGlvbnMubG9nZ2VyQ2FsbGJhY2s7XHJcbiAgICAgICAgICAgIHRoaXMucGlpTG9nZ2luZ0VuYWJsZWQgPSBsb2dnZXJPcHRpb25zLnBpaUxvZ2dpbmdFbmFibGVkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExvZyBtZXNzYWdlIHdpdGggcmVxdWlyZWQgb3B0aW9ucy5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBsb2dNZXNzYWdlKGxvZ01lc3NhZ2U6IHN0cmluZywgb3B0aW9uczogTG9nZ2VyTWVzc2FnZU9wdGlvbnMpOiB2b2lkIHtcclxuICAgICAgICBpZiAoKG9wdGlvbnMubG9nTGV2ZWwgPiB0aGlzLmxldmVsKSB8fCAoIXRoaXMucGlpTG9nZ2luZ0VuYWJsZWQgJiYgb3B0aW9ucy5jb250YWluc1BpaSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvVVRDU3RyaW5nKCk7XHJcbiAgICAgICAgbGV0IGxvZzogc3RyaW5nO1xyXG4gICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eSh0aGlzLmNvcnJlbGF0aW9uSWQpKSB7XHJcbiAgICAgICAgICAgIGxvZyA9IHRpbWVzdGFtcCArIFwiOlwiICsgdGhpcy5jb3JyZWxhdGlvbklkICsgXCItXCIgKyBwa2cudmVyc2lvbiArIFwiLVwiICsgTG9nTGV2ZWxbb3B0aW9ucy5sb2dMZXZlbF0gKyBcIiBcIiArIGxvZ01lc3NhZ2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBsb2cgPSB0aW1lc3RhbXAgKyBcIjpcIiArIHBrZy52ZXJzaW9uICsgXCItXCIgKyBMb2dMZXZlbFtvcHRpb25zLmxvZ0xldmVsXSArIFwiIFwiICsgbG9nTWVzc2FnZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5leGVjdXRlQ2FsbGJhY2sob3B0aW9ucy5sb2dMZXZlbCwgbG9nLCBvcHRpb25zLmNvbnRhaW5zUGlpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4ZWN1dGUgY2FsbGJhY2sgd2l0aCBtZXNzYWdlLlxyXG4gICAgICovXHJcbiAgICBleGVjdXRlQ2FsbGJhY2sobGV2ZWw6IExvZ0xldmVsLCBtZXNzYWdlOiBzdHJpbmcsIGNvbnRhaW5zUGlpOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMubG9jYWxDYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmxvY2FsQ2FsbGJhY2sobGV2ZWwsIG1lc3NhZ2UsIGNvbnRhaW5zUGlpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBMb2dzIGVycm9yIG1lc3NhZ2VzLlxyXG4gICAgICovXHJcbiAgICBlcnJvcihtZXNzYWdlOiBzdHJpbmcsIGNvcnJlbGF0aW9uSWQ/OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmxvZ01lc3NhZ2UobWVzc2FnZSwge1xyXG4gICAgICAgICAgICBsb2dMZXZlbDogTG9nTGV2ZWwuRXJyb3IsXHJcbiAgICAgICAgICAgIGNvbnRhaW5zUGlpOiBmYWxzZSxcclxuICAgICAgICAgICAgY29ycmVsYXRpb25JZDogY29ycmVsYXRpb25JZCB8fCBcIlwiXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBMb2dzIGVycm9yIG1lc3NhZ2VzIHdpdGggUElJLlxyXG4gICAgICovXHJcbiAgICBlcnJvclBpaShtZXNzYWdlOiBzdHJpbmcsIGNvcnJlbGF0aW9uSWQ/OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmxvZ01lc3NhZ2UobWVzc2FnZSwge1xyXG4gICAgICAgICAgICBsb2dMZXZlbDogTG9nTGV2ZWwuRXJyb3IsXHJcbiAgICAgICAgICAgIGNvbnRhaW5zUGlpOiB0cnVlLFxyXG4gICAgICAgICAgICBjb3JyZWxhdGlvbklkOiBjb3JyZWxhdGlvbklkIHx8IFwiXCJcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExvZ3Mgd2FybmluZyBtZXNzYWdlcy5cclxuICAgICAqL1xyXG4gICAgd2FybmluZyhtZXNzYWdlOiBzdHJpbmcsIGNvcnJlbGF0aW9uSWQ/OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmxvZ01lc3NhZ2UobWVzc2FnZSwge1xyXG4gICAgICAgICAgICBsb2dMZXZlbDogTG9nTGV2ZWwuV2FybmluZyxcclxuICAgICAgICAgICAgY29udGFpbnNQaWk6IGZhbHNlLFxyXG4gICAgICAgICAgICBjb3JyZWxhdGlvbklkOiBjb3JyZWxhdGlvbklkIHx8IFwiXCJcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExvZ3Mgd2FybmluZyBtZXNzYWdlcyB3aXRoIFBJSS5cclxuICAgICAqL1xyXG4gICAgd2FybmluZ1BpaShtZXNzYWdlOiBzdHJpbmcsIGNvcnJlbGF0aW9uSWQ/OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmxvZ01lc3NhZ2UobWVzc2FnZSwge1xyXG4gICAgICAgICAgICBsb2dMZXZlbDogTG9nTGV2ZWwuV2FybmluZyxcclxuICAgICAgICAgICAgY29udGFpbnNQaWk6IHRydWUsXHJcbiAgICAgICAgICAgIGNvcnJlbGF0aW9uSWQ6IGNvcnJlbGF0aW9uSWQgfHwgXCJcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTG9ncyBpbmZvIG1lc3NhZ2VzLlxyXG4gICAgICovXHJcbiAgICBpbmZvKG1lc3NhZ2U6IHN0cmluZywgY29ycmVsYXRpb25JZD86IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMubG9nTWVzc2FnZShtZXNzYWdlLCB7XHJcbiAgICAgICAgICAgIGxvZ0xldmVsOiBMb2dMZXZlbC5JbmZvLFxyXG4gICAgICAgICAgICBjb250YWluc1BpaTogZmFsc2UsXHJcbiAgICAgICAgICAgIGNvcnJlbGF0aW9uSWQ6IGNvcnJlbGF0aW9uSWQgfHwgXCJcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTG9ncyBpbmZvIG1lc3NhZ2VzIHdpdGggUElJLlxyXG4gICAgICovXHJcbiAgICBpbmZvUGlpKG1lc3NhZ2U6IHN0cmluZywgY29ycmVsYXRpb25JZD86IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMubG9nTWVzc2FnZShtZXNzYWdlLCB7XHJcbiAgICAgICAgICAgIGxvZ0xldmVsOiBMb2dMZXZlbC5JbmZvLFxyXG4gICAgICAgICAgICBjb250YWluc1BpaTogdHJ1ZSxcclxuICAgICAgICAgICAgY29ycmVsYXRpb25JZDogY29ycmVsYXRpb25JZCB8fCBcIlwiXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBMb2dzIHZlcmJvc2UgbWVzc2FnZXMuXHJcbiAgICAgKi9cclxuICAgIHZlcmJvc2UobWVzc2FnZTogc3RyaW5nLCBjb3JyZWxhdGlvbklkPzogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5sb2dNZXNzYWdlKG1lc3NhZ2UsIHtcclxuICAgICAgICAgICAgbG9nTGV2ZWw6IExvZ0xldmVsLlZlcmJvc2UsXHJcbiAgICAgICAgICAgIGNvbnRhaW5zUGlpOiBmYWxzZSxcclxuICAgICAgICAgICAgY29ycmVsYXRpb25JZDogY29ycmVsYXRpb25JZCB8fCBcIlwiXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBMb2dzIHZlcmJvc2UgbWVzc2FnZXMgd2l0aCBQSUkuXHJcbiAgICAgKi9cclxuICAgIHZlcmJvc2VQaWkobWVzc2FnZTogc3RyaW5nLCBjb3JyZWxhdGlvbklkPzogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5sb2dNZXNzYWdlKG1lc3NhZ2UsIHtcclxuICAgICAgICAgICAgbG9nTGV2ZWw6IExvZ0xldmVsLlZlcmJvc2UsXHJcbiAgICAgICAgICAgIGNvbnRhaW5zUGlpOiB0cnVlLFxyXG4gICAgICAgICAgICBjb3JyZWxhdGlvbklkOiBjb3JyZWxhdGlvbklkIHx8IFwiXCJcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgd2hldGhlciBQSUkgTG9nZ2luZyBpcyBlbmFibGVkIG9yIG5vdC5cclxuICAgICAqL1xyXG4gICAgaXNQaWlMb2dnaW5nRW5hYmxlZCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5waWlMb2dnaW5nRW5hYmxlZDtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgTW9kdWxlQ29uZmlndXJhdGlvbiwgYnVpbGRNb2R1bGVDb25maWd1cmF0aW9uIH0gZnJvbSBcIi4uL2NvbmZpZy9Nb2R1bGVDb25maWd1cmF0aW9uXCI7XHJcbmltcG9ydCB7IEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVycyB9IGZyb20gXCIuLi8uLi9yZXF1ZXN0L0F1dGhlbnRpY2F0aW9uUGFyYW1ldGVyc1wiO1xyXG5pbXBvcnQgeyBUb2tlblJlbmV3UGFyYW1ldGVycyB9IGZyb20gXCIuLi8uLi9yZXF1ZXN0L1Rva2VuUmVuZXdQYXJhbWV0ZXJzXCI7XHJcbmltcG9ydCB7IENvZGVSZXNwb25zZSB9IGZyb20gXCIuLi8uLi9yZXNwb25zZS9Db2RlUmVzcG9uc2VcIjtcclxuaW1wb3J0IHsgVG9rZW5SZXNwb25zZSB9IGZyb20gXCIuLi8uLi9yZXNwb25zZS9Ub2tlblJlc3BvbnNlXCI7XHJcbmltcG9ydCB7IElDYWNoZVN0b3JhZ2UgfSBmcm9tIFwiLi4vLi4vY2FjaGUvSUNhY2hlU3RvcmFnZVwiO1xyXG5pbXBvcnQgeyBDYWNoZUhlbHBlcnMgfSBmcm9tIFwiLi4vLi4vY2FjaGUvQ2FjaGVIZWxwZXJzXCI7XHJcbmltcG9ydCB7IElOZXR3b3JrTW9kdWxlIH0gZnJvbSBcIi4uLy4uL25ldHdvcmsvSU5ldHdvcmtNb2R1bGVcIjtcclxuaW1wb3J0IHsgSUNyeXB0byB9IGZyb20gXCIuLi8uLi9jcnlwdG8vSUNyeXB0b1wiO1xyXG5pbXBvcnQgeyBBY2NvdW50IH0gZnJvbSBcIi4uLy4uL2F1dGgvQWNjb3VudFwiO1xyXG5pbXBvcnQgeyBBdXRob3JpdHkgfSBmcm9tIFwiLi4vLi4vYXV0aC9hdXRob3JpdHkvQXV0aG9yaXR5XCI7XHJcbmltcG9ydCB7IElkVG9rZW4gfSBmcm9tIFwiLi4vLi4vYXV0aC9JZFRva2VuXCI7XHJcbmltcG9ydCB7IGJ1aWxkQ2xpZW50SW5mbyB9IGZyb20gXCIuLi8uLi9hdXRoL0NsaWVudEluZm9cIjtcclxuaW1wb3J0IHsgU3RyaW5nVXRpbHMgfSBmcm9tIFwiLi4vLi4vdXRpbHMvU3RyaW5nVXRpbHNcIjtcclxuaW1wb3J0IHsgTG9nZ2VyIH0gZnJvbSBcIi4uLy4uL2xvZ2dlci9Mb2dnZXJcIjtcclxuaW1wb3J0IHsgUGVyc2lzdGVudENhY2hlS2V5cyB9IGZyb20gXCIuLi8uLi91dGlscy9Db25zdGFudHNcIjtcclxuXHJcbi8qKlxyXG4gKiBAaGlkZGVuXHJcbiAqIEBpZ25vcmVcclxuICogRGF0YSB0eXBlIHRvIGhvbGQgaW5mb3JtYXRpb24gYWJvdXQgc3RhdGUgcmV0dXJuZWQgZnJvbSB0aGUgc2VydmVyXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBSZXNwb25zZVN0YXRlSW5mbyA9IHtcclxuICAgIHN0YXRlOiBzdHJpbmc7XHJcbiAgICBzdGF0ZU1hdGNoOiBib29sZWFuO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEF1dGhNb2R1bGUgY2xhc3NcclxuICogXHJcbiAqIFBhcmVudCBvYmplY3QgaW5zdGFuY2Ugd2hpY2ggd2lsbCBjb25zdHJ1Y3QgcmVxdWVzdHMgdG8gc2VuZCB0byBhbmQgaGFuZGxlIHJlc3BvbnNlcyBmcm9tIHRoZSBNaWNyb3NvZnQgU1RTIHVzaW5nIHRoZSBhdXRob3JpemF0aW9uIGNvZGUgZmxvdy5cclxuICogXHJcbiAqL1xyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQXV0aE1vZHVsZSB7XHJcblxyXG4gICAgLy8gTG9nZ2VyIG9iamVjdFxyXG4gICAgcHVibGljIGxvZ2dlcjogTG9nZ2VyO1xyXG5cclxuICAgIC8vIEFwcGxpY2F0aW9uIGNvbmZpZ1xyXG4gICAgcHJpdmF0ZSBjb25maWc6IE1vZHVsZUNvbmZpZ3VyYXRpb247XHJcbiAgICBcclxuICAgIC8vIENyeXB0byBJbnRlcmZhY2VcclxuICAgIHByb3RlY3RlZCBjcnlwdG9PYmo6IElDcnlwdG87XHJcblxyXG4gICAgLy8gU3RvcmFnZSBJbnRlcmZhY2VcclxuICAgIHByb3RlY3RlZCBjYWNoZVN0b3JhZ2U6IElDYWNoZVN0b3JhZ2U7XHJcblxyXG4gICAgLy8gTmV0d29yayBJbnRlcmZhY2VcclxuICAgIHByb3RlY3RlZCBuZXR3b3JrQ2xpZW50OiBJTmV0d29ya01vZHVsZTtcclxuXHJcbiAgICAvLyBIZWxwZXIgQVBJIG9iamVjdCBmb3IgcnVubmluZyBjYWNoZSBmdW5jdGlvbnNcclxuICAgIHByb3RlY3RlZCBjYWNoZU1hbmFnZXI6IENhY2hlSGVscGVycztcclxuXHJcbiAgICAvLyBBY2NvdW50IG9iamVjdFxyXG4gICAgcHJvdGVjdGVkIGFjY291bnQ6IEFjY291bnQ7XHJcblxyXG4gICAgLy8gRGVmYXVsdCBhdXRob3JpdHkgb2JqZWN0XHJcbiAgICBwcm90ZWN0ZWQgZGVmYXVsdEF1dGhvcml0eUluc3RhbmNlOiBBdXRob3JpdHk7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29uZmlndXJhdGlvbjogTW9kdWxlQ29uZmlndXJhdGlvbikge1xyXG4gICAgICAgIC8vIFNldCB0aGUgY29uZmlndXJhdGlvblxyXG4gICAgICAgIHRoaXMuY29uZmlnID0gYnVpbGRNb2R1bGVDb25maWd1cmF0aW9uKGNvbmZpZ3VyYXRpb24pO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBsb2dnZXJcclxuICAgICAgICB0aGlzLmxvZ2dlciA9IG5ldyBMb2dnZXIodGhpcy5jb25maWcubG9nZ2VyT3B0aW9ucyk7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgY3J5cHRvXHJcbiAgICAgICAgdGhpcy5jcnlwdG9PYmogPSB0aGlzLmNvbmZpZy5jcnlwdG9JbnRlcmZhY2U7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgc3RvcmFnZSBpbnRlcmZhY2VcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZSA9IHRoaXMuY29uZmlnLnN0b3JhZ2VJbnRlcmZhY2U7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgc3RvcmFnZSBoZWxwZXIgb2JqZWN0XHJcbiAgICAgICAgdGhpcy5jYWNoZU1hbmFnZXIgPSBuZXcgQ2FjaGVIZWxwZXJzKHRoaXMuY2FjaGVTdG9yYWdlKTtcclxuXHJcbiAgICAgICAgLy8gU2V0IHRoZSBuZXR3b3JrIGludGVyZmFjZVxyXG4gICAgICAgIHRoaXMubmV0d29ya0NsaWVudCA9IHRoaXMuY29uZmlnLm5ldHdvcmtJbnRlcmZhY2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gI3JlZ2lvbiBBYnN0cmFjdCBGdW5jdGlvbnNcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSB1cmwgZm9yIGxvZ2dpbmcgaW4gYSB1c2VyLiBUaGlzIHdpbGwgYnkgZGVmYXVsdCBhcHBlbmQgdGhlIGNsaWVudCBpZCB0byB0aGUgbGlzdCBvZiBzY29wZXMsIFxyXG4gICAgICogYWxsb3dpbmcgeW91IHRvIHJldHJpZXZlIGFuIGlkIHRva2VuIGluIHRoZSBzdWJzZXF1ZW50IGNvZGUgZXhjaGFuZ2UuIEFsc28gcGVyZm9ybXMgdmFsaWRhdGlvbiBvZiB0aGUgcmVxdWVzdCBwYXJhbWV0ZXJzLlxyXG4gICAgICogSW5jbHVkaW5nIGFueSBTU08gcGFyYW1ldGVycyAoYWNjb3VudCwgc2lkLCBsb2dpbl9oaW50KSB3aWxsIHNob3J0IGNpcmN1aXQgdGhlIGF1dGhlbnRpY2F0aW9uIGFuZCBhbGxvdyB5b3UgdG8gcmV0cmlldmUgYSBjb2RlIHdpdGhvdXQgaW50ZXJhY3Rpb24uXHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdCBcclxuICAgICAqL1xyXG4gICAgYWJzdHJhY3QgYXN5bmMgY3JlYXRlTG9naW5VcmwocmVxdWVzdDogQXV0aGVudGljYXRpb25QYXJhbWV0ZXJzKTogUHJvbWlzZTxzdHJpbmc+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIHVybCBmb3IgbG9nZ2luZyBpbiBhIHVzZXIuIEFsc28gcGVyZm9ybXMgdmFsaWRhdGlvbiBvZiB0aGUgcmVxdWVzdCBwYXJhbWV0ZXJzLlxyXG4gICAgICogSW5jbHVkaW5nIGFueSBTU08gcGFyYW1ldGVycyAoYWNjb3VudCwgc2lkLCBsb2dpbl9oaW50KSB3aWxsIHNob3J0IGNpcmN1aXQgdGhlIGF1dGhlbnRpY2F0aW9uIGFuZCBhbGxvdyB5b3UgdG8gcmV0cmlldmUgYSBjb2RlIHdpdGhvdXQgaW50ZXJhY3Rpb24uXHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdCBcclxuICAgICAqL1xyXG4gICAgYWJzdHJhY3QgYXN5bmMgY3JlYXRlQWNxdWlyZVRva2VuVXJsKHJlcXVlc3Q6IEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVycyk6IFByb21pc2U8c3RyaW5nPjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEhhbmRsZXMgdGhlIGhhc2ggZnJhZ21lbnQgcmVzcG9uc2UgZnJvbSBwdWJsaWMgY2xpZW50IGNvZGUgcmVxdWVzdC4gUmV0dXJucyBhIGNvZGUgcmVzcG9uc2UgdXNlZCBieVxyXG4gICAgICogdGhlIGNsaWVudCB0byBleGNoYW5nZSBmb3IgYSB0b2tlbiBpbiBhY3F1aXJlVG9rZW4uXHJcbiAgICAgKiBAcGFyYW0gaGFzaEZyYWdtZW50IFxyXG4gICAgICovXHJcbiAgICBhYnN0cmFjdCBoYW5kbGVGcmFnbWVudFJlc3BvbnNlKGhhc2hGcmFnbWVudDogc3RyaW5nKTogQ29kZVJlc3BvbnNlO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2l2ZW4gYW4gYXV0aG9yaXphdGlvbiBjb2RlLCBpdCB3aWxsIHBlcmZvcm0gYSB0b2tlbiBleGNoYW5nZSB1c2luZyBjYWNoZWQgdmFsdWVzIGZyb20gYSBwcmV2aW91cyBjYWxsIHRvXHJcbiAgICAgKiBjcmVhdGVMb2dpblVybCgpIG9yIGNyZWF0ZUFjcXVpcmVUb2tlblVybCgpLiBZb3UgbXVzdCBjYWxsIHRoaXMgQUZURVIgdXNpbmcgb25lIG9mIHRob3NlIEFQSXMgZmlyc3QuIFlvdSBzaG91bGRcclxuICAgICAqIGFsc28gdXNlIHRoZSBoYW5kbGVGcmFnbWVudFJlc3BvbnNlKCkgQVBJIHRvIHBhc3MgdGhlIGNvZGVSZXNwb25zZSB0byB0aGlzIGZ1bmN0aW9uIGFmdGVyd2FyZHMuXHJcbiAgICAgKiBAcGFyYW0gY29kZVJlc3BvbnNlIFxyXG4gICAgICovXHJcbiAgICBhYnN0cmFjdCBhc3luYyBhY3F1aXJlVG9rZW4oY29kZVJlc3BvbnNlOiBDb2RlUmVzcG9uc2UpOiBQcm9taXNlPFRva2VuUmVzcG9uc2U+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0cmlldmVzIGEgdG9rZW4gZnJvbSBjYWNoZSBpZiBpdCBpcyBzdGlsbCB2YWxpZCwgb3IgdXNlcyB0aGUgY2FjaGVkIHJlZnJlc2ggdG9rZW4gdG8gcmVuZXdcclxuICAgICAqIHRoZSBnaXZlbiB0b2tlbiBhbmQgcmV0dXJucyB0aGUgcmVuZXdlZCB0b2tlbi4gV2lsbCB0aHJvdyBhbiBlcnJvciBpZiBsb2dpbiBpcyBub3QgY29tcGxldGVkICh1bmxlc3NcclxuICAgICAqIGlkIHRva2VucyBhcmUgbm90IGJlaW5nIHJlbmV3ZWQpLlxyXG4gICAgICogQHBhcmFtIHJlcXVlc3QgXHJcbiAgICAgKi9cclxuICAgIGFic3RyYWN0IGFzeW5jIHJlbmV3VG9rZW4ocmVxdWVzdDogVG9rZW5SZW5ld1BhcmFtZXRlcnMpOiBQcm9taXNlPFRva2VuUmVzcG9uc2U+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXNlIHRvIGxvZyBvdXQgdGhlIGN1cnJlbnQgdXNlciwgYW5kIHJlZGlyZWN0IHRoZSB1c2VyIHRvIHRoZSBwb3N0TG9nb3V0UmVkaXJlY3RVcmkuXHJcbiAgICAgKiBEZWZhdWx0IGJlaGF2aW91ciBpcyB0byByZWRpcmVjdCB0aGUgdXNlciB0byBgd2luZG93LmxvY2F0aW9uLmhyZWZgLlxyXG4gICAgICogQHBhcmFtIGF1dGhvcml0eVVyaSBcclxuICAgICAqL1xyXG4gICAgYWJzdHJhY3QgYXN5bmMgbG9nb3V0KGF1dGhvcml0eVVyaT86IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPjtcclxuXHJcbiAgICAvLyAjZW5kcmVnaW9uXHJcbiAgICBcclxuICAgIC8vICNyZWdpb24gR2V0dGVycyBhbmQgU2V0dGVyc1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgc2lnbmVkIGluIGFjY291bnRcclxuICAgICAqICh0aGUgYWNjb3VudCBvYmplY3QgaXMgY3JlYXRlZCBhdCB0aGUgdGltZSBvZiBzdWNjZXNzZnVsIGxvZ2luKVxyXG4gICAgICogb3IgbnVsbCB3aGVuIG5vIHN0YXRlIGlzIGZvdW5kXHJcbiAgICAgKiBAcmV0dXJucyB7QGxpbmsgQWNjb3VudH0gLSB0aGUgYWNjb3VudCBvYmplY3Qgc3RvcmVkIGluIE1TQUxcclxuICAgICAqL1xyXG4gICAgZ2V0QWNjb3VudCgpOiBBY2NvdW50IHtcclxuICAgICAgICBpZiAodGhpcy5hY2NvdW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFjY291bnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBHZXQgaWQgdG9rZW4gYW5kIGNsaWVudCBpbmZvIGZyb20gY2FjaGVcclxuICAgICAgICBjb25zdCByYXdJZFRva2VuID0gdGhpcy5jYWNoZVN0b3JhZ2UuZ2V0SXRlbShQZXJzaXN0ZW50Q2FjaGVLZXlzLklEX1RPS0VOKTtcclxuICAgICAgICBjb25zdCByYXdDbGllbnRJbmZvID0gdGhpcy5jYWNoZVN0b3JhZ2UuZ2V0SXRlbShQZXJzaXN0ZW50Q2FjaGVLZXlzLkNMSUVOVF9JTkZPKTtcclxuXHJcbiAgICAgICAgaWYoIVN0cmluZ1V0aWxzLmlzRW1wdHkocmF3SWRUb2tlbikgJiYgIVN0cmluZ1V0aWxzLmlzRW1wdHkocmF3Q2xpZW50SW5mbykpIHtcclxuICAgICAgICAgICAgY29uc3QgaWRUb2tlbiA9IG5ldyBJZFRva2VuKHJhd0lkVG9rZW4sIHRoaXMuY3J5cHRvT2JqKTtcclxuICAgICAgICAgICAgY29uc3QgY2xpZW50SW5mbyA9IGJ1aWxkQ2xpZW50SW5mbyhyYXdDbGllbnRJbmZvLCB0aGlzLmNyeXB0b09iaik7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFjY291bnQgPSBBY2NvdW50LmNyZWF0ZUFjY291bnQoaWRUb2tlbiwgY2xpZW50SW5mbywgdGhpcy5jcnlwdG9PYmopO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gaWYgbG9naW4gaXMgbm90IHlldCBkb25lLCByZXR1cm4gbnVsbFxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8vICNlbmRyZWdpb25cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgTW9kdWxlQ29uZmlndXJhdGlvbiwgYnVpbGRNb2R1bGVDb25maWd1cmF0aW9uIH0gZnJvbSBcIi4vTW9kdWxlQ29uZmlndXJhdGlvblwiO1xyXG5cclxuLyoqXHJcbiAqIEB0eXBlIEF1dGhPcHRpb25zOiBVc2UgdGhpcyB0byBjb25maWd1cmUgdGhlIGF1dGggb3B0aW9ucyBpbiB0aGUgQ29uZmlndXJhdGlvbiBvYmplY3RcclxuICpcclxuICogIC0gY2xpZW50SWQgICAgICAgICAgICAgICAgICAgIC0gQ2xpZW50IElEIG9mIHlvdXIgYXBwIHJlZ2lzdGVyZWQgd2l0aCBvdXIgQXBwbGljYXRpb24gcmVnaXN0cmF0aW9uIHBvcnRhbCA6IGh0dHBzOi8vcG9ydGFsLmF6dXJlLmNvbS8jYmxhZGUvTWljcm9zb2Z0X0FBRF9JQU0vQWN0aXZlRGlyZWN0b3J5TWVudUJsYWRlL1JlZ2lzdGVyZWRBcHBzUHJldmlldyBpbiBNaWNyb3NvZnQgSWRlbnRpdHkgUGxhdGZvcm1cclxuICogIC0gYXV0aG9yaXR5ICAgICAgICAgICAgICAgICAgIC0gWW91IGNhbiBjb25maWd1cmUgYSBzcGVjaWZpYyBhdXRob3JpdHksIGRlZmF1bHRzIHRvIFwiIFwiIG9yIFwiaHR0cHM6Ly9sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tL2NvbW1vblwiXHJcbiAqICAtIHZhbGlkYXRlQXV0aG9yaXR5ICAgICAgICAgICAtIFVzZWQgdG8gdHVybiBhdXRob3JpdHkgdmFsaWRhdGlvbiBvbi9vZmYuIFdoZW4gc2V0IHRvIHRydWUgKGRlZmF1bHQpLCBNU0FMIHdpbGwgY29tcGFyZSB0aGUgYXBwbGljYXRpb24ncyBhdXRob3JpdHkgYWdhaW5zdCB3ZWxsLWtub3duIFVSTHMgdGVtcGxhdGVzIHJlcHJlc2VudGluZyB3ZWxsLWZvcm1lZCBhdXRob3JpdGllcy4gSXQgaXMgdXNlZnVsIHdoZW4gdGhlIGF1dGhvcml0eSBpcyBvYnRhaW5lZCBhdCBydW4gdGltZSB0byBwcmV2ZW50IE1TQUwgZnJvbSBkaXNwbGF5aW5nIGF1dGhlbnRpY2F0aW9uIHByb21wdHMgZnJvbSBtYWxpY2lvdXMgcGFnZXMuXHJcbiAqICAtIHJlZGlyZWN0VXJpICAgICAgICAgICAgICAgICAtIFRoZSByZWRpcmVjdCBVUkkgb2YgdGhlIGFwcGxpY2F0aW9uLCB0aGlzIHNob3VsZCBiZSBzYW1lIGFzIHRoZSB2YWx1ZSBpbiB0aGUgYXBwbGljYXRpb24gcmVnaXN0cmF0aW9uIHBvcnRhbC5EZWZhdWx0cyB0byBgd2luZG93LmxvY2F0aW9uLmhyZWZgLlxyXG4gKiAgLSBwb3N0TG9nb3V0UmVkaXJlY3RVcmkgICAgICAgLSBVc2VkIHRvIHJlZGlyZWN0IHRoZSB1c2VyIHRvIHRoaXMgbG9jYXRpb24gYWZ0ZXIgbG9nb3V0LiBEZWZhdWx0cyB0byBgd2luZG93LmxvY2F0aW9uLmhyZWZgLlxyXG4gKi9cclxuZXhwb3J0IHR5cGUgQXV0aE9wdGlvbnMgPSB7XHJcbiAgICBjbGllbnRJZDogc3RyaW5nO1xyXG4gICAgLy8gVGVtcG9yYXJ5IHVudGlsIHNlcnZlciBhbGxvd3MgQ09SUyBmb3IgcHVibGljIGNsaWVudHNcclxuICAgIHRtcF9jbGllbnRTZWNyZXQ6IHN0cmluZztcclxuICAgIGF1dGhvcml0eT86IHN0cmluZztcclxuICAgIHZhbGlkYXRlQXV0aG9yaXR5PzogYm9vbGVhbjtcclxuICAgIHJlZGlyZWN0VXJpPzogc3RyaW5nIHwgKCgpID0+IHN0cmluZyk7XHJcbiAgICBwb3N0TG9nb3V0UmVkaXJlY3RVcmk/OiBzdHJpbmcgfCAoKCkgPT4gc3RyaW5nKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBVc2UgdGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IHRvIGNvbmZpZ3VyZSBNU0FMIGFuZCBpbml0aWFsaXplIHRoZSBBdXRob3JpemF0aW9uQ29kZU1vZHVsZS5cclxuICpcclxuICogVGhpcyBvYmplY3QgYWxsb3dzIHlvdSB0byBjb25maWd1cmUgaW1wb3J0YW50IGVsZW1lbnRzIG9mIE1TQUwgZnVuY3Rpb25hbGl0eTpcclxuICogLSBhdXRoOiB0aGlzIGlzIHdoZXJlIHlvdSBjb25maWd1cmUgYXV0aCBlbGVtZW50cyBsaWtlIGNsaWVudElELCBhdXRob3JpdHkgdXNlZCBmb3IgYXV0aGVudGljYXRpbmcgYWdhaW5zdCB0aGUgTWljcm9zb2Z0IElkZW50aXR5IFBsYXRmb3JtXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBQdWJsaWNDbGllbnRTUEFDb25maWd1cmF0aW9uID0gTW9kdWxlQ29uZmlndXJhdGlvbiAmIHtcclxuICAgIGF1dGg6IEF1dGhPcHRpb25zXHJcbn07XHJcblxyXG5jb25zdCBERUZBVUxUX0FVVEhfT1BUSU9OUzogQXV0aE9wdGlvbnMgPSB7XHJcbiAgICBjbGllbnRJZDogXCJcIixcclxuICAgIC8vIFRlbXBvcmFyeSB1bnRpbCBzZXJ2ZXIgYWxsb3dzIENPUlMgZm9yIHB1YmxpYyBjbGllbnRzXHJcbiAgICB0bXBfY2xpZW50U2VjcmV0OiBcIlwiLFxyXG4gICAgYXV0aG9yaXR5OiBudWxsLFxyXG4gICAgdmFsaWRhdGVBdXRob3JpdHk6IHRydWUsXHJcbiAgICByZWRpcmVjdFVyaTogXCJcIixcclxuICAgIHBvc3RMb2dvdXRSZWRpcmVjdFVyaTogXCJcIlxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEZ1bmN0aW9uIHRoYXQgc2V0cyB0aGUgZGVmYXVsdCBvcHRpb25zIHdoZW4gbm90IGV4cGxpY2l0bHkgY29uZmlndXJlZCBmcm9tIGFwcCBkZXZlbG9wZXJcclxuICpcclxuICogQHBhcmFtIFRBdXRoT3B0aW9uc1xyXG4gKiBAcGFyYW0gVFN0b3JhZ2VPcHRpb25zXHJcbiAqIEBwYXJhbSBUU3lzdGVtT3B0aW9uc1xyXG4gKiBAcGFyYW0gVEZyYW1ld29ya09wdGlvbnNcclxuICpcclxuICogQHJldHVybnMgVENvbmZpZ3VyYXRpb24gb2JqZWN0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRQdWJsaWNDbGllbnRTUEFDb25maWd1cmF0aW9uKHsgYXV0aCwgbG9nZ2VyT3B0aW9ucywgc3RvcmFnZUludGVyZmFjZSwgbmV0d29ya0ludGVyZmFjZSwgY3J5cHRvSW50ZXJmYWNlIH06IFB1YmxpY0NsaWVudFNQQUNvbmZpZ3VyYXRpb24pOiBQdWJsaWNDbGllbnRTUEFDb25maWd1cmF0aW9uIHtcclxuICAgIGNvbnN0IGJhc2VDb25maWcgPSBidWlsZE1vZHVsZUNvbmZpZ3VyYXRpb24oe2xvZ2dlck9wdGlvbnMsIHN0b3JhZ2VJbnRlcmZhY2UsIG5ldHdvcmtJbnRlcmZhY2UsIGNyeXB0b0ludGVyZmFjZX0pO1xyXG4gICAgY29uc3Qgb3ZlcmxheWVkQ29uZmlnOiBQdWJsaWNDbGllbnRTUEFDb25maWd1cmF0aW9uID0ge1xyXG4gICAgICAgIGF1dGg6IHsgLi4uREVGQVVMVF9BVVRIX09QVElPTlMsIC4uLmF1dGggfSxcclxuICAgICAgICAuLi5iYXNlQ29uZmlnXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIG92ZXJsYXllZENvbmZpZztcclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHBrZyBmcm9tIFwiLi4vLi4vcGFja2FnZS5qc29uXCI7XHJcbmltcG9ydCB7IFNjb3BlU2V0IH0gZnJvbSBcIi4uL2F1dGgvU2NvcGVTZXRcIjtcclxuaW1wb3J0IHsgSUNyeXB0byB9IGZyb20gXCIuLi9jcnlwdG8vSUNyeXB0b1wiO1xyXG5pbXBvcnQgeyBDb25zdGFudHMgfSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzXCI7XHJcblxyXG4vKipcclxuICogQmFzZSBhYnN0cmFjdCBjbGFzcyBmb3Igc2VydmVyIHJlcXVlc3QgcGFyYW1zIGNsYXNzIHdoaWNoIHZhbGlkYXRlcyByZXF1ZXN0IHBhcmFtZXRlcnMsIGNoZWNrcyBmb3IgU1NPLCBhbmQgcmV0dXJucyBVUkwgb3IgcmVxdWVzdCBib2R5IGNvbnRlbnQuXHJcbiAqL1xyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMge1xyXG4gICAgLy8gQ3J5cHRvIGZ1bmN0aW9uc1xyXG4gICAgcHJvdGVjdGVkIGNyeXB0b09iajogSUNyeXB0bztcclxuXHJcbiAgICAvLyBQYXJhbXNcclxuICAgIGNsaWVudElkOiBzdHJpbmc7XHJcbiAgICBzY29wZXM6IFNjb3BlU2V0O1xyXG4gICAgcmVkaXJlY3RVcmk6IHN0cmluZztcclxuXHJcbiAgICAvLyBWYWxpZGl0eSBjaGVja3NcclxuICAgIHN0YXRlOiBzdHJpbmc7XHJcblxyXG4gICAgLy8gVGVsZW1ldHJ5IEluZm9cclxuICAgIHhDbGllbnRWZXI6IHN0cmluZztcclxuICAgIHhDbGllbnRTa3U6IHN0cmluZztcclxuICAgIGNvcnJlbGF0aW9uSWQ6IHN0cmluZztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihjbGllbnRJZDogc3RyaW5nLCByZWRpcmVjdFVyaTogc3RyaW5nLCBjcnlwdG9JbXBsOiBJQ3J5cHRvKSB7XHJcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xyXG4gICAgICAgIHRoaXMuY3J5cHRvT2JqID0gY3J5cHRvSW1wbDtcclxuICAgICAgICB0aGlzLnJlZGlyZWN0VXJpID0gcmVkaXJlY3RVcmk7XHJcblxyXG4gICAgICAgIC8vIFRlbGVtZXRyeSBJbmZvXHJcbiAgICAgICAgdGhpcy54Q2xpZW50U2t1ID0gQ29uc3RhbnRzLkxJQlJBUllfTkFNRTtcclxuICAgICAgICB0aGlzLnhDbGllbnRWZXIgPSBwa2cudmVyc2lvbjtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQ2xpZW50QXV0aEVycm9yIH0gZnJvbSBcIi4vQ2xpZW50QXV0aEVycm9yXCI7XHJcblxyXG4vKipcclxuICogQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZSBjbGFzcyBjb250YWluaW5nIHN0cmluZyBjb25zdGFudHMgdXNlZCBieSBlcnJvciBjb2RlcyBhbmQgbWVzc2FnZXMuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZSA9IHtcclxuICAgIHJlZGlyZWN0VXJpTm90U2V0OiB7XHJcbiAgICAgICAgY29kZTogXCJyZWRpcmVjdF91cmlfZW1wdHlcIixcclxuICAgICAgICBkZXNjOiBcIkEgcmVkaXJlY3QgVVJJIGlzIHJlcXVpcmVkIGZvciBhbGwgY2FsbHMsIGFuZCBub25lIGhhcyBiZWVuIHNldC5cIlxyXG4gICAgfSxcclxuICAgIHBvc3RMb2dvdXRVcmlOb3RTZXQ6IHtcclxuICAgICAgICBjb2RlOiBcInBvc3RfbG9nb3V0X3VyaV9lbXB0eVwiLFxyXG4gICAgICAgIGRlc2M6IFwiQSBwb3N0IGxvZ291dCByZWRpcmVjdCBoYXMgbm90IGJlZW4gc2V0LlwiXHJcbiAgICB9LFxyXG4gICAgY2xhaW1zUmVxdWVzdFBhcnNpbmdFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiY2xhaW1zX3JlcXVlc3RfcGFyc2luZ19lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwiQ291bGQgbm90IHBhcnNlIHRoZSBnaXZlbiBjbGFpbXMgcmVxdWVzdCBvYmplY3QuXCJcclxuICAgIH0sXHJcbiAgICBhdXRob3JpdHlVcmlJbnNlY3VyZToge1xyXG4gICAgICAgIGNvZGU6IFwiYXV0aG9yaXR5X3VyaV9pbnNlY3VyZVwiLFxyXG4gICAgICAgIGRlc2M6IFwiQXV0aG9yaXR5IFVSSXMgbXVzdCB1c2UgaHR0cHMuICBQbGVhc2Ugc2VlIGhlcmUgZm9yIHZhbGlkIGF1dGhvcml0eSBjb25maWd1cmF0aW9uIG9wdGlvbnM6IGh0dHBzOi8vZG9jcy5taWNyb3NvZnQuY29tL2VuLXVzL2F6dXJlL2FjdGl2ZS1kaXJlY3RvcnkvZGV2ZWxvcC9tc2FsLWpzLWluaXRpYWxpemluZy1jbGllbnQtYXBwbGljYXRpb25zI2NvbmZpZ3VyYXRpb24tb3B0aW9uc1wiXHJcbiAgICB9LFxyXG4gICAgdXJsUGFyc2VFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwidXJsX3BhcnNlX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJVUkwgY291bGQgbm90IGJlIHBhcnNlZCBpbnRvIGFwcHJvcHJpYXRlIHNlZ21lbnRzLlwiXHJcbiAgICB9LFxyXG4gICAgdXJsRW1wdHlFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiZW1wdHlfdXJsX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJVUkwgd2FzIGVtcHR5IG9yIG51bGwuXCJcclxuICAgIH0sXHJcbiAgICBzY29wZXNSZXF1aXJlZEVycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJzY29wZXNfcmVxdWlyZWRcIixcclxuICAgICAgICBkZXNjOiBcIlNjb3BlcyBhcmUgcmVxdWlyZWQgdG8gb2J0YWluIGFuIGFjY2VzcyB0b2tlbi5cIlxyXG4gICAgfSxcclxuICAgIGVtcHR5U2NvcGVzRXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcImVtcHR5X2lucHV0X3Njb3Blc19lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwiU2NvcGVzIGNhbm5vdCBiZSBwYXNzZWQgYXMgZW1wdHkgYXJyYXkuXCJcclxuICAgIH0sXHJcbiAgICBub25BcnJheVNjb3Blc0Vycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJub25hcnJheV9pbnB1dF9zY29wZXNfZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIlNjb3BlcyBjYW5ub3QgYmUgcGFzc2VkIGFzIG5vbi1hcnJheS5cIlxyXG4gICAgfSxcclxuICAgIGNsaWVudElkU2luZ2xlU2NvcGVFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiY2xpZW50aWRfaW5wdXRfc2NvcGVzX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJDbGllbnQgSUQgY2FuIG9ubHkgYmUgcHJvdmlkZWQgYXMgYSBzaW5nbGUgc2NvcGUuXCJcclxuICAgIH0sXHJcbiAgICBpbnZhbGlkUHJvbXB0OiB7XHJcbiAgICAgICAgY29kZTogXCJpbnZhbGlkX3Byb21wdF92YWx1ZVwiLFxyXG4gICAgICAgIGRlc2M6IFwiU3VwcG9ydGVkIHByb21wdCB2YWx1ZXMgYXJlICdsb2dpbicsICdzZWxlY3RfYWNjb3VudCcsICdjb25zZW50JyBhbmQgJ25vbmUnLiAgUGxlYXNlIHNlZSBoZXJlIGZvciB2YWxpZCBjb25maWd1cmF0aW9uIG9wdGlvbnM6IGh0dHBzOi8vZG9jcy5taWNyb3NvZnQuY29tL2VuLXVzL2F6dXJlL2FjdGl2ZS1kaXJlY3RvcnkvZGV2ZWxvcC9tc2FsLWpzLWluaXRpYWxpemluZy1jbGllbnQtYXBwbGljYXRpb25zI2NvbmZpZ3VyYXRpb24tb3B0aW9uc1wiLFxyXG4gICAgfSxcclxuICAgIHRva2VuUmVxdWVzdEVtcHR5RXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcInRva2VuX3JlcXVlc3RfZW1wdHlcIixcclxuICAgICAgICBkZXNjOiBcIlRva2VuIHJlcXVlc3Qgd2FzIGVtcHR5IGFuZCBub3QgZm91bmQgaW4gY2FjaGUuXCJcclxuICAgIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBFcnJvciB0aHJvd24gd2hlbiB0aGVyZSBpcyBhbiBlcnJvciBpbiBjb25maWd1cmF0aW9uIG9mIHRoZSBNU0FMLmpzIGxpYnJhcnkuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIGV4dGVuZHMgQ2xpZW50QXV0aEVycm9yIHtcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IoZXJyb3JDb2RlOiBzdHJpbmcsIGVycm9yTWVzc2FnZT86IHN0cmluZykge1xyXG4gICAgICAgIHN1cGVyKGVycm9yQ29kZSwgZXJyb3JNZXNzYWdlKTtcclxuICAgICAgICB0aGlzLm5hbWUgPSBcIkNsaWVudENvbmZpZ3VyYXRpb25FcnJvclwiO1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IucHJvdG90eXBlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gZXJyb3IgdGhyb3duIHdoZW4gdGhlIHJlZGlyZWN0IHVyaSBpcyBlbXB0eSAobm90IHNldCBieSBjYWxsZXIpXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVSZWRpcmVjdFVyaUVtcHR5RXJyb3IoKTogQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLnJlZGlyZWN0VXJpTm90U2V0LmNvZGUsXHJcbiAgICAgICAgICAgIENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UucmVkaXJlY3RVcmlOb3RTZXQuZGVzYyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIGVycm9yIHRocm93biB3aGVuIHRoZSBwb3N0LWxvZ291dCByZWRpcmVjdCB1cmkgaXMgZW1wdHkgKG5vdCBzZXQgYnkgY2FsbGVyKVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlUG9zdExvZ291dFJlZGlyZWN0VXJpRW1wdHlFcnJvcigpOiBDbGllbnRDb25maWd1cmF0aW9uRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yKENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UucG9zdExvZ291dFVyaU5vdFNldC5jb2RlLFxyXG4gICAgICAgICAgICBDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLnBvc3RMb2dvdXRVcmlOb3RTZXQuZGVzYyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIGVycm9yIHRocm93biB3aGVuIHRoZSBjbGFpbXMgcmVxdWVzdCBjb3VsZCBub3QgYmUgc3VjY2Vzc2Z1bGx5IHBhcnNlZFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlQ2xhaW1zUmVxdWVzdFBhcnNpbmdFcnJvcihjbGFpbXNSZXF1ZXN0UGFyc2VFcnJvcjogc3RyaW5nKTogQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmNsYWltc1JlcXVlc3RQYXJzaW5nRXJyb3IuY29kZSxcclxuICAgICAgICAgICAgYCR7Q2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5jbGFpbXNSZXF1ZXN0UGFyc2luZ0Vycm9yLmRlc2N9IEdpdmVuIHZhbHVlOiAke2NsYWltc1JlcXVlc3RQYXJzZUVycm9yfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBlcnJvciB0aHJvd24gaWYgYXV0aG9yaXR5IHVyaSBpcyBnaXZlbiBhbiBpbnNlY3VyZSBwcm90b2NvbC5cclxuICAgICAqIEBwYXJhbSB1cmxTdHJpbmcgXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVJbnNlY3VyZUF1dGhvcml0eVVyaUVycm9yKHVybFN0cmluZzogc3RyaW5nKTogQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmF1dGhvcml0eVVyaUluc2VjdXJlLmNvZGUsXHJcbiAgICAgICAgICAgIGAke0NsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuYXV0aG9yaXR5VXJpSW5zZWN1cmUuZGVzY30gR2l2ZW4gVVJJOiAke3VybFN0cmluZ31gKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gZXJyb3IgdGhyb3duIGlmIFVSTCBzdHJpbmcgZG9lcyBub3QgcGFyc2UgaW50byBzZXBhcmF0ZSBzZWdtZW50cy5cclxuICAgICAqIEBwYXJhbSB1cmxTdHJpbmcgXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVVcmxQYXJzZUVycm9yKHVybFBhcnNlRXJyb3I6IHN0cmluZyk6IENsaWVudENvbmZpZ3VyYXRpb25FcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IoQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS51cmxQYXJzZUVycm9yLmNvZGUsXHJcbiAgICAgICAgICAgIGAke0NsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UudXJsUGFyc2VFcnJvci5kZXNjfSBHaXZlbiBFcnJvcjogJHt1cmxQYXJzZUVycm9yfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBlcnJvciB0aHJvd24gaWYgVVJMIHN0cmluZyBpcyBlbXB0eSBvciBudWxsLlxyXG4gICAgICogQHBhcmFtIHVybFN0cmluZyBcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZVVybEVtcHR5RXJyb3IoKTogQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLnVybEVtcHR5RXJyb3IuY29kZSwgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS51cmxFbXB0eUVycm9yLmRlc2MpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXJyb3IgdGhyb3duIHdoZW4gaW5wdXQgc2NvcGVzIGFyZSByZXF1aXJlZC5cclxuICAgICAqIEBwYXJhbSBpbnB1dFNjb3BlcyBcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZVNjb3Blc1JlcXVpcmVkRXJyb3IoaW5wdXRTY29wZXM6IEFycmF5PHN0cmluZz4pOiBDbGllbnRDb25maWd1cmF0aW9uRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yKENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2Uuc2NvcGVzUmVxdWlyZWRFcnJvci5jb2RlLFxyXG4gICAgICAgICAgICBgJHtDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLnNjb3Blc1JlcXVpcmVkRXJyb3IuZGVzY30gR2l2ZW4gU2NvcGVzOiAke2lucHV0U2NvcGVzfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXJyb3IgdGhyb3duIHdoZW4gc2NvcGVzIGFyZSBub3QgYW4gYXJyYXlcclxuICAgICAqIEBwYXJhbSBpbnB1dFNjb3BlcyBcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWF0ZVNjb3Blc05vbkFycmF5RXJyb3IoaW5wdXRTY29wZXM6IEFycmF5PHN0cmluZz4pOiBDbGllbnRDb25maWd1cmF0aW9uRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yKENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2Uubm9uQXJyYXlTY29wZXNFcnJvci5jb2RlLFxyXG4gICAgICAgICAgICBgJHtDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLm5vbkFycmF5U2NvcGVzRXJyb3IuZGVzY30gR2l2ZW4gU2NvcGVzOiAke2lucHV0U2NvcGVzLnRvU3RyaW5nKCl9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFcnJvciB0aHJvd24gd2hlbiBzY29wZXMgYXJlIGVtcHR5LlxyXG4gICAgICogQHBhcmFtIHNjb3Blc1ZhbHVlIFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlRW1wdHlTY29wZXNBcnJheUVycm9yKGlucHV0U2NvcGVzOiBBcnJheTxzdHJpbmc+KTogQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmVtcHR5U2NvcGVzRXJyb3IuY29kZSxcclxuICAgICAgICAgICAgYCR7Q2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5lbXB0eVNjb3Blc0Vycm9yLmRlc2N9IEdpdmVuIFNjb3BlczogJHtpbnB1dFNjb3Blcy50b1N0cmluZygpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXJyb3IgdGhyb3duIHdoZW4gY2xpZW50IGlkIHNjb3BlIGlzIG5vdCBwcm92aWRlZCBhcyBzaW5nbGUgc2NvcGUuXHJcbiAgICAgKiBAcGFyYW0gaW5wdXRTY29wZXMgXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVDbGllbnRJZFNpbmdsZVNjb3BlRXJyb3IoaW5wdXRTY29wZXM6IEFycmF5PHN0cmluZz4pOiBDbGllbnRDb25maWd1cmF0aW9uRXJyb3Ige1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yKENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuY2xpZW50SWRTaW5nbGVTY29wZUVycm9yLmNvZGUsXHJcbiAgICAgICAgICAgIGAke0NsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuY2xpZW50SWRTaW5nbGVTY29wZUVycm9yLmRlc2N9IEdpdmVuIFNjb3BlczogJHtpbnB1dFNjb3Blcy50b1N0cmluZygpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXJyb3IgdGhyb3duIHdoZW4gcHJvbXB0IGlzIG5vdCBhbiBhbGxvd2VkIHR5cGUuXHJcbiAgICAgKiBAcGFyYW0gcHJvbXB0VmFsdWUgXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVJbnZhbGlkUHJvbXB0RXJyb3IocHJvbXB0VmFsdWU6IHN0cmluZyk6IENsaWVudENvbmZpZ3VyYXRpb25FcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IoQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5pbnZhbGlkUHJvbXB0LmNvZGUsXHJcbiAgICAgICAgICAgIGAke0NsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuaW52YWxpZFByb21wdC5kZXNjfSBHaXZlbiB2YWx1ZTogJHtwcm9tcHRWYWx1ZX1gKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRocm93cyBlcnJvciB3aGVuIHRva2VuIHJlcXVlc3QgaXMgZW1wdHkgYW5kIG5vdGhpbmcgY2FjaGVkIGluIHN0b3JhZ2UuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGVFbXB0eVRva2VuUmVxdWVzdEVycm9yKCk6IENsaWVudENvbmZpZ3VyYXRpb25FcnJvciB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IoQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS50b2tlblJlcXVlc3RFbXB0eUVycm9yLmNvZGUsIENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UudG9rZW5SZXF1ZXN0RW1wdHlFcnJvci5kZXNjKTtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIH0gZnJvbSBcIi4uL2Vycm9yL0NsaWVudENvbmZpZ3VyYXRpb25FcnJvclwiO1xyXG5pbXBvcnQgeyBTdHJpbmdVdGlscyB9IGZyb20gXCIuLi91dGlscy9TdHJpbmdVdGlsc1wiO1xyXG5pbXBvcnQgeyBDb25zdGFudHMgfSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzXCI7XHJcblxyXG4vKipcclxuICogVGhlIFNjb3BlU2V0IGNsYXNzIGNyZWF0ZXMgYSBzZXQgb2Ygc2NvcGVzLiBTY29wZXMgYXJlIGNhc2UtaW5zZW5zaXRpdmUsIHVuaXF1ZSB2YWx1ZXMsIHNvIHRoZSBTZXQgb2JqZWN0IGluIEpTIG1ha2VzXHJcbiAqIHRoZSBtb3N0IHNlbnNlIHRvIGltcGxlbWVudCBmb3IgdGhpcyBjbGFzcy4gQWxsIHNjb3BlcyBhcmUgdHJpbW1lZCBhbmQgY29udmVydGVkIHRvIGxvd2VyIGNhc2Ugc3RyaW5ncyB0byBlbnN1cmUgdW5pcXVlbmVzcyBvZiBzdHJpbmdzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFNjb3BlU2V0IHtcclxuICAgIC8vIENsaWVudCBJRCBvZiBhcHBsaWNhdGlvblxyXG4gICAgcHJpdmF0ZSBjbGllbnRJZDogc3RyaW5nO1xyXG4gICAgLy8gU2NvcGVzIGFzIGEgU2V0IG9mIHN0cmluZ3NcclxuICAgIHByaXZhdGUgc2NvcGVzOiBTZXQ8c3RyaW5nPjtcclxuICAgIC8vIE9yaWdpbmFsIHNjb3BlcyBwYXNzZWQgdG8gY29uc3RydWN0b3IuIFVzdWFsbHkgdXNlZCBmb3IgY2FjaGluZyBvciB0ZWxlbWV0cnkuXHJcbiAgICBwcml2YXRlIG9yaWdpbmFsU2NvcGVzOiBTZXQ8c3RyaW5nPjtcclxuICAgIC8vIEJvb2xlYW4gZGVub3Rpbmcgd2hldGhlciBzY29wZXMgYXJlIHJlcXVpcmVkLiBVc3VhbGx5IHVzZWQgZm9yIHZhbGlkYXRpb24uXHJcbiAgICBwcml2YXRlIHNjb3Blc1JlcXVpcmVkOiBib29sZWFuO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGlucHV0U2NvcGVzOiBBcnJheTxzdHJpbmc+LCBhcHBDbGllbnRJZDogc3RyaW5nLCBzY29wZXNSZXF1aXJlZDogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBhcHBDbGllbnRJZDtcclxuICAgICAgICB0aGlzLnNjb3Blc1JlcXVpcmVkID0gc2NvcGVzUmVxdWlyZWQ7XHJcbiAgICAgICAgLy8gVmFsaWRhdGUgYW5kIGZpbHRlciBzY29wZXMgKHZhbGlkYXRlIGZ1bmN0aW9uIHRocm93cyBpZiB2YWxpZGF0aW9uIGZhaWxzKVxyXG4gICAgICAgIHRoaXMudmFsaWRhdGVJbnB1dFNjb3BlcyhpbnB1dFNjb3Blcyk7XHJcbiAgICAgICAgY29uc3Qgc2NvcGVBcnIgPSBpbnB1dFNjb3BlcyA/IFN0cmluZ1V0aWxzLnRyaW1BbmRDb252ZXJ0QXJyYXlFbnRyaWVzVG9Mb3dlckNhc2UoWy4uLmlucHV0U2NvcGVzXSkgOiBbXTtcclxuICAgICAgICB0aGlzLnNjb3BlcyA9IG5ldyBTZXQ8c3RyaW5nPihzY29wZUFycik7XHJcbiAgICAgICAgdGhpcy5vcmlnaW5hbFNjb3BlcyA9IG5ldyBTZXQ8c3RyaW5nPih0aGlzLnNjb3Blcyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNjb3Blc1JlcXVpcmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kU2NvcGUodGhpcy5jbGllbnRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVwbGFjZURlZmF1bHRTY29wZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEZhY3RvcnkgbWV0aG9kIHRvIGNyZWF0ZSBTY29wZVNldCBmcm9tIHN0cmluZ1xyXG4gICAgICogQHBhcmFtIGlucHV0U2NvcGVTdHJpbmcgXHJcbiAgICAgKiBAcGFyYW0gYXBwQ2xpZW50SWQgXHJcbiAgICAgKiBAcGFyYW0gc2NvcGVzUmVxdWlyZWQgXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBmcm9tU3RyaW5nKGlucHV0U2NvcGVTdHJpbmc6IHN0cmluZywgYXBwQ2xpZW50SWQ6IHN0cmluZywgc2NvcGVzUmVxdWlyZWQ6IGJvb2xlYW4pOiBTY29wZVNldCB7XHJcbiAgICAgICAgY29uc3QgaW5wdXRTY29wZXM6IEFycmF5PHN0cmluZz4gPSBpbnB1dFNjb3BlU3RyaW5nLnNwbGl0KFwiIFwiKTtcclxuICAgICAgICByZXR1cm4gbmV3IFNjb3BlU2V0KGlucHV0U2NvcGVzLCBhcHBDbGllbnRJZCwgc2NvcGVzUmVxdWlyZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVwbGFjZSBjbGllbnQgaWQgd2l0aCB0aGUgZGVmYXVsdCBzY29wZXMgdXNlZCBmb3IgdG9rZW4gYWNxdWlzaXRpb24uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVwbGFjZURlZmF1bHRTY29wZXMoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2NvcGVzLmhhcyh0aGlzLmNsaWVudElkKSkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZVNjb3BlKHRoaXMuY2xpZW50SWQpO1xyXG4gICAgICAgICAgICB0aGlzLmFwcGVuZFNjb3BlKENvbnN0YW50cy5PUEVOSURfU0NPUEUpO1xyXG4gICAgICAgICAgICB0aGlzLmFwcGVuZFNjb3BlKENvbnN0YW50cy5QUk9GSUxFX1NDT1BFKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hcHBlbmRTY29wZShDb25zdGFudHMuT0ZGTElORV9BQ0NFU1NfU0NPUEUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byB2YWxpZGF0ZSB0aGUgc2NvcGVzIGlucHV0IHBhcmFtZXRlciByZXF1ZXN0ZWQgIGJ5IHRoZSBkZXZlbG9wZXIuXHJcbiAgICAgKiBAcGFyYW0ge0FycmF5PHN0cmluZz59IGlucHV0U2NvcGVzIC0gRGV2ZWxvcGVyIHJlcXVlc3RlZCBwZXJtaXNzaW9ucy4gTm90IGFsbCBzY29wZXMgYXJlIGd1YXJhbnRlZWQgdG8gYmUgaW5jbHVkZWQgaW4gdGhlIGFjY2VzcyB0b2tlbiByZXR1cm5lZC5cclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2NvcGVzUmVxdWlyZWQgLSBCb29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0aGUgc2NvcGVzIGFycmF5IGlzIHJlcXVpcmVkIG9yIG5vdFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHZhbGlkYXRlSW5wdXRTY29wZXMoaW5wdXRTY29wZXM6IEFycmF5PHN0cmluZz4pOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5zY29wZXNSZXF1aXJlZCkge1xyXG4gICAgICAgICAgICAvLyBTY29wZXMgYXJlIHJlcXVpcmVkIGJ1dCBub3QgZ2l2ZW5cclxuICAgICAgICAgICAgaWYgKCFpbnB1dFNjb3Blcykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZVNjb3Blc1JlcXVpcmVkRXJyb3IoaW5wdXRTY29wZXMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBDaGVjayB0aGF0IHNjb3BlcyBpcyBub3QgYW4gZW1wdHkgYXJyYXlcclxuICAgICAgICAgICAgaWYgKGlucHV0U2NvcGVzLmxlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVFbXB0eVNjb3Blc0FycmF5RXJyb3IoaW5wdXRTY29wZXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayB0aGF0IHNjb3BlcyBpcyBhbiBhcnJheSBvYmplY3RcclxuICAgICAgICBpZiAoaW5wdXRTY29wZXMgJiYgIUFycmF5LmlzQXJyYXkoaW5wdXRTY29wZXMpKSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVTY29wZXNOb25BcnJheUVycm9yKGlucHV0U2NvcGVzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBhIGdpdmVuIHNjb3BlIGlzIHByZXNlbnQgaW4gdGhpcyBzZXQgb2Ygc2NvcGVzLlxyXG4gICAgICogQHBhcmFtIHNjb3BlIFxyXG4gICAgICovXHJcbiAgICBjb250YWluc1Njb3BlKHNjb3BlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zY29wZXMuaGFzKHNjb3BlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGEgc2V0IG9mIHNjb3BlcyBpcyBwcmVzZW50IGluIHRoaXMgc2V0IG9mIHNjb3Blcy5cclxuICAgICAqIEBwYXJhbSBzY29wZVNldCBcclxuICAgICAqL1xyXG4gICAgY29udGFpbnNTY29wZVNldChzY29wZVNldDogU2NvcGVTZXQpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zY29wZXMuc2l6ZSA+PSBzY29wZVNldC5zY29wZXMuc2l6ZSAmJiBzY29wZVNldC5hc0FycmF5KCkuZXZlcnkoc2NvcGUgPT4gdGhpcy5jb250YWluc1Njb3BlKHNjb3BlKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBlbmRzIHNpbmdsZSBzY29wZSBpZiBwYXNzZWRcclxuICAgICAqIEBwYXJhbSBuZXdTY29wZSBcclxuICAgICAqL1xyXG4gICAgYXBwZW5kU2NvcGUobmV3U2NvcGU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc2NvcGVzLmFkZChuZXdTY29wZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBlbmRzIG11bHRpcGxlIHNjb3BlcyBpZiBwYXNzZWRcclxuICAgICAqIEBwYXJhbSBuZXdTY29wZXMgXHJcbiAgICAgKi9cclxuICAgIGFwcGVuZFNjb3BlcyhuZXdTY29wZXM6IEFycmF5PHN0cmluZz4pOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBuZXdTY29wZVNldCA9IG5ldyBTY29wZVNldChuZXdTY29wZXMsIHRoaXMuY2xpZW50SWQsIGZhbHNlKTtcclxuICAgICAgICB0aGlzLnNjb3BlcyA9IHRoaXMudW5pb25TY29wZVNldHMobmV3U2NvcGVTZXQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyBlbGVtZW50IGZyb20gc2V0IG9mIHNjb3Blcy5cclxuICAgICAqIEBwYXJhbSBzY29wZSBcclxuICAgICAqL1xyXG4gICAgcmVtb3ZlU2NvcGUoc2NvcGU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc2NvcGVzLmRlbGV0ZShzY29wZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQ29tYmluZXMgYW4gYXJyYXkgb2Ygc2NvcGVzIHdpdGggdGhlIGN1cnJlbnQgc2V0IG9mIHNjb3Blcy5cclxuICAgICAqIEBwYXJhbSBvdGhlclNjb3BlcyBcclxuICAgICAqL1xyXG4gICAgdW5pb25TY29wZVNldHMob3RoZXJTY29wZXM6IFNjb3BlU2V0KTogU2V0PHN0cmluZz4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgU2V0PHN0cmluZz4oWy4uLm90aGVyU2NvcGVzLmFzQXJyYXkoKSwgLi4uQXJyYXkuZnJvbSh0aGlzLnNjb3BlcyldKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIHNjb3BlcyBpbnRlcnNlY3QgYmV0d2VlbiB0aGlzIHNldCBhbmQgYW5vdGhlci5cclxuICAgICAqIEBwYXJhbSBvdGhlclNjb3BlcyBcclxuICAgICAqL1xyXG4gICAgaW50ZXJzZWN0aW5nU2NvcGVTZXRzKG90aGVyU2NvcGVzOiBTY29wZVNldCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnVuaW9uU2NvcGVTZXRzKG90aGVyU2NvcGVzKS5zaXplIDwgKHRoaXMuc2NvcGVzLnNpemUgKyBvdGhlclNjb3Blcy5nZXRTY29wZUNvdW50KCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBzaXplIG9mIHNldCBvZiBzY29wZXMuXHJcbiAgICAgKi9cclxuICAgIGdldFNjb3BlQ291bnQoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zY29wZXMuc2l6ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgc2V0IG9mIG9yaWdpbmFsIHNjb3BlcyBvbmx5IGNvbnRhaW5lZCBjbGllbnQtaWRcclxuICAgICAqL1xyXG4gICAgaXNMb2dpblNjb3BlU2V0KCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IGhhc0xvZ2luU2NvcGVzID0gKFxyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsU2NvcGVzLmhhcyh0aGlzLmNsaWVudElkKSB8fFxyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsU2NvcGVzLmhhcyhDb25zdGFudHMuT1BFTklEX1NDT1BFKSB8fFxyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsU2NvcGVzLmhhcyhDb25zdGFudHMuUFJPRklMRV9TQ09QRSlcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm9yaWdpbmFsU2NvcGVzICYmIGhhc0xvZ2luU2NvcGVzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgc2NvcGVzIGFzIGFuIGFycmF5IG9mIHN0cmluZyB2YWx1ZXNcclxuICAgICAqL1xyXG4gICAgYXNBcnJheSgpOiBBcnJheTxzdHJpbmc+IHtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnNjb3Blcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBvcmlnaW5hbCBzY29wZXMgYXMgYW4gYXJyYXkgKG5vIGV4dHJhIHNjb3BlcyB0byBjb25zZW50KVxyXG4gICAgICovXHJcbiAgICBnZXRPcmlnaW5hbFNjb3Blc0FzQXJyYXkoKTogQXJyYXk8c3RyaW5nPiB7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5vcmlnaW5hbFNjb3Blcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcmludHMgc2NvcGVzIGludG8gYSBzcGFjZS1kZWxpbWl0ZWQgc3RyaW5nXHJcbiAgICAgKi9cclxuICAgIHByaW50U2NvcGVzKCk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2NvcGVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNjb3BlQXJyID0gdGhpcy5hc0FycmF5KCk7XHJcbiAgICAgICAgICAgIHJldHVybiBzY29wZUFyci5qb2luKFwiIFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICB9XHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IENsaWVudFJlcXVlc3RQYXJhbWV0ZXJzIH0gZnJvbSBcIi4vQ2xpZW50UmVxdWVzdFBhcmFtZXRlcnNcIjtcclxuaW1wb3J0IHsgQWNjb3VudCB9IGZyb20gXCIuLi9hdXRoL0FjY291bnRcIjtcclxuaW1wb3J0IHsgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIH0gZnJvbSBcIi4uL2Vycm9yL0NsaWVudENvbmZpZ3VyYXRpb25FcnJvclwiO1xyXG5cclxuLyoqXHJcbiAqIEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVycyBwYXNzZWQgYnkgdXNlciB0byByZXRyaWV2ZSBhIHRva2VuIGZyb20gdGhlIHNlcnZlci5cclxuICogLSBzY29wZXM6IHJlcXVlc3RlZCB0b2tlbiBzY29wZXNcclxuICogLSByZXNvdXJjZTogcmVxdWVzdGVkIHJlc291cmNlIHVyaVxyXG4gKiAtIGV4dHJhU2NvcGVzVG9Db25zZW50OiBhZGRpdGlvbmFsIHNjb3BlcyB0byBjb25zZW50IFxyXG4gKiAtIHByb21wdDogdGhlIHZhbHVlIG9mIHRoZSBPQXV0aCBwcm9tcHQgcGFyYW1ldGVyXHJcbiAqIC0gZXh0cmFRdWVyeVBhcmFtZXRlcnM6IHN0cmluZyB0byBzdHJpbmcgbWFwIG9mIGN1c3RvbSBxdWVyeSBwYXJhbWV0ZXJzXHJcbiAqIC0gY2xhaW1zUmVxdWVzdDogc3RyaW5naWZpZWQgY2xhaW1zIG9iamVjdCB0byByZXF1ZXN0IGFkZGl0aW9uYWwgY2xhaW1zIGluIGEgdG9rZW5cclxuICogLSBhdXRob3JpdHk6IGF1dGhvcml0eSB0byByZXF1ZXN0IHRva2VucyBmcm9tXHJcbiAqIC0gdXNlclJlcXVlc3RTdGF0ZTogc3RhdGUgcGFyYW1ldGVyIHRvIGVuc3VyZSByZXF1ZXN0L3Jlc3BvbnNlIGludGVncml0eVxyXG4gKiAtIGNvcnJlbGF0aW9uSWQ6IGN1c3RvbSBjb3JyZWxhdGlvbklkIGdpdmVuIGJ5IHVzZXJcclxuICogLSBhY2NvdW50OiBBY2NvdW50IG9iamVjdCB0byBwZXJmb3JtIFNTT1xyXG4gKiAtIHNpZDogc2Vzc2lvbiBpZCBmb3IgU1NPXHJcbiAqIC0gbG9naW5IaW50OiBsb2dpbiBoaW50IGZvciBTU09cclxuICovXHJcbmV4cG9ydCB0eXBlIEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVycyA9IENsaWVudFJlcXVlc3RQYXJhbWV0ZXJzICYge1xyXG4gICAgZXh0cmFTY29wZXNUb0NvbnNlbnQ/OiBBcnJheTxzdHJpbmc+O1xyXG4gICAgcHJvbXB0Pzogc3RyaW5nO1xyXG4gICAgY2xhaW1zUmVxdWVzdD86IHN0cmluZztcclxuICAgIHVzZXJSZXF1ZXN0U3RhdGU/OiBzdHJpbmc7XHJcbiAgICBhY2NvdW50PzogQWNjb3VudDtcclxuICAgIHNpZD86IHN0cmluZztcclxuICAgIGxvZ2luSGludD86IHN0cmluZztcclxufTtcclxuXHJcbi8qKlxyXG4gKiBGdW5jdGlvbiB3aGljaCB2YWxpZGF0ZXMgY2xhaW1zIHJlcXVlc3QgcGFzc2VkIGluIGJ5IHRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gcmVxdWVzdCBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUNsYWltc1JlcXVlc3QocmVxdWVzdDogQXV0aGVudGljYXRpb25QYXJhbWV0ZXJzKTogdm9pZCB7XHJcbiAgICBpZiAoIXJlcXVlc3QuY2xhaW1zUmVxdWVzdCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRyeSB7XHJcbiAgICAgICAgSlNPTi5wYXJzZShyZXF1ZXN0LmNsYWltc1JlcXVlc3QpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVDbGFpbXNSZXF1ZXN0UGFyc2luZ0Vycm9yKGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRPRE86IE1vcmUgdmFsaWRhdGlvbiB3aWxsIGJlIGFkZGVkIHdoZW4gdGhlIHNlcnZlciB0ZWFtIHRlbGxzIHVzIGhvdyB0aGV5IGhhdmUgYWN0dWFsbHkgaW1wbGVtZW50ZWQgY2xhaW1zXHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IFN0cmluZ1V0aWxzIH0gZnJvbSBcIi4vU3RyaW5nVXRpbHNcIjtcclxuaW1wb3J0IHsgQ29uc3RhbnRzIH0gZnJvbSBcIi4vQ29uc3RhbnRzXCI7XHJcblxyXG4vKipcclxuICogQ2xhc3Mgd2hpY2ggcHJvdmlkZXMgaGVscGVycyBmb3IgT0F1dGggMi4wIHByb3RvY29sIHNwZWNpZmljIHZhbHVlc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFByb3RvY29sVXRpbHMge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQXBwZW5kcyB1c2VyIHN0YXRlIHdpdGggcmFuZG9tIGd1aWQsIG9yIHJldHVybnMgcmFuZG9tIGd1aWQuXHJcbiAgICAgKiBAcGFyYW0gdXNlclN0YXRlIFxyXG4gICAgICogQHBhcmFtIHJhbmRvbUd1aWQgXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBzZXRSZXF1ZXN0U3RhdGUodXNlclN0YXRlOiBzdHJpbmcsIHJhbmRvbUd1aWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJTdGF0ZSAmJiAhU3RyaW5nVXRpbHMuaXNFbXB0eSh1c2VyU3RhdGUpID8gYCR7cmFuZG9tR3VpZH0ke0NvbnN0YW50cy5SRVNPVVJDRV9ERUxJTX0ke3VzZXJTdGF0ZX1gIDogcmFuZG9tR3VpZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBFeHRyYWN0cyB1c2VyIHN0YXRlIHZhbHVlIGZyb20gdGhlIHN0YXRlIHNlbnQgd2l0aCB0aGUgYXV0aGVudGljYXRpb24gcmVxdWVzdC5cclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHNjb3BlLlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgZ2V0VXNlclJlcXVlc3RTdGF0ZShzZXJ2ZXJSZXNwb25zZVN0YXRlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIGlmIChzZXJ2ZXJSZXNwb25zZVN0YXRlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNwbGl0SW5kZXggPSBzZXJ2ZXJSZXNwb25zZVN0YXRlLmluZGV4T2YoQ29uc3RhbnRzLlJFU09VUkNFX0RFTElNKTtcclxuICAgICAgICAgICAgaWYgKHNwbGl0SW5kZXggPiAtMSAmJiBzcGxpdEluZGV4ICsgMSA8IHNlcnZlclJlc3BvbnNlU3RhdGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VydmVyUmVzcG9uc2VTdGF0ZS5zdWJzdHJpbmcoc3BsaXRJbmRleCArIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5pbXBvcnQgeyBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycyB9IGZyb20gXCIuL1NlcnZlclJlcXVlc3RQYXJhbWV0ZXJzXCI7XHJcbmltcG9ydCB7IEF1dGhvcml0eSB9IGZyb20gXCIuLi9hdXRoL2F1dGhvcml0eS9BdXRob3JpdHlcIjtcclxuaW1wb3J0IHsgQWNjb3VudCB9IGZyb20gXCIuLi9hdXRoL0FjY291bnRcIjtcclxuaW1wb3J0IHsgSUNyeXB0bywgUGtjZUNvZGVzIH0gZnJvbSBcIi4uL2NyeXB0by9JQ3J5cHRvXCI7XHJcbmltcG9ydCB7IFNjb3BlU2V0IH0gZnJvbSBcIi4uL2F1dGgvU2NvcGVTZXRcIjtcclxuaW1wb3J0IHsgSWRUb2tlbiB9IGZyb20gXCIuLi9hdXRoL0lkVG9rZW5cIjtcclxuaW1wb3J0IHsgQXV0aGVudGljYXRpb25QYXJhbWV0ZXJzLCB2YWxpZGF0ZUNsYWltc1JlcXVlc3QgfSBmcm9tIFwiLi4vcmVxdWVzdC9BdXRoZW50aWNhdGlvblBhcmFtZXRlcnNcIjtcclxuaW1wb3J0IHsgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIH0gZnJvbSBcIi4uL2Vycm9yL0NsaWVudENvbmZpZ3VyYXRpb25FcnJvclwiO1xyXG5pbXBvcnQgeyBTdHJpbmdVdGlscyB9IGZyb20gXCIuLi91dGlscy9TdHJpbmdVdGlsc1wiO1xyXG5pbXBvcnQgeyBQcm90b2NvbFV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL1Byb3RvY29sVXRpbHNcIjtcclxuaW1wb3J0IHsgQ29uc3RhbnRzLCBCbGFja2xpc3RlZEVRUGFyYW1zLCBTU09UeXBlcywgUHJvbXB0U3RhdGUsIEFBRFNlcnZlclBhcmFtS2V5cyB9IGZyb20gXCIuLi91dGlscy9Db25zdGFudHNcIjtcclxuaW1wb3J0IHsgU3RyaW5nRGljdCB9IGZyb20gXCIuLi91dGlscy9Nc2FsVHlwZXNcIjtcclxuXHJcbi8qKlxyXG4gKiBUaGlzIGNsYXNzIGV4dGVuZHMgdGhlIFNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzIGNsYXNzLiBUaGlzIGNsYXNzIHZhbGlkYXRlcyBVUkwgcmVxdWVzdCBwYXJhbWV0ZXJzLCBjaGVja3MgZm9yIFNTTyBhbmQgZ2VuZXJhdGVzIHJlcXVpcmVkIFVSTC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBTZXJ2ZXJDb2RlUmVxdWVzdFBhcmFtZXRlcnMgZXh0ZW5kcyBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycyB7XHJcblxyXG4gICAgLy8gUGFyYW1zXHJcbiAgICBhdXRob3JpdHlJbnN0YW5jZTogQXV0aG9yaXR5O1xyXG4gICAgcmVzcG9uc2VUeXBlOiBzdHJpbmc7XHJcbiAgICB1c2VyUmVxdWVzdDogQXV0aGVudGljYXRpb25QYXJhbWV0ZXJzO1xyXG4gICAgcXVlcnlQYXJhbWV0ZXJzOiBzdHJpbmc7XHJcbiAgICBleHRyYVF1ZXJ5UGFyYW1ldGVyczogc3RyaW5nO1xyXG5cclxuICAgIC8vIEdlbmVyYXRlZCBQYXJhbXNcclxuICAgIGdlbmVyYXRlZFBrY2U6IFBrY2VDb2RlcztcclxuICAgIFxyXG4gICAgLy8gVmFsaWRpdHkgY2hlY2tzXHJcbiAgICBub25jZTogc3RyaW5nO1xyXG5cclxuICAgIC8vIEFjY291bnRcclxuICAgIGFjY291bnQ6IEFjY291bnQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXV0aG9yaXR5OiBBdXRob3JpdHksIGNsaWVudElkOiBzdHJpbmcsIHVzZXJSZXF1ZXN0OiBBdXRoZW50aWNhdGlvblBhcmFtZXRlcnMsIGNhY2hlZEFjY291bnQ6IEFjY291bnQsIHJlZGlyZWN0VXJpOiBzdHJpbmcsIGNyeXB0b0ltcGw6IElDcnlwdG8sIGlzTG9naW5DYWxsOiBib29sZWFuKSB7XHJcbiAgICAgICAgc3VwZXIoY2xpZW50SWQsIHJlZGlyZWN0VXJpLCBjcnlwdG9JbXBsKTtcclxuICAgICAgICB0aGlzLmF1dGhvcml0eUluc3RhbmNlID0gYXV0aG9yaXR5O1xyXG4gICAgICAgIHRoaXMudXNlclJlcXVlc3QgPSB1c2VyUmVxdWVzdDtcclxuICAgICAgICB0aGlzLnJlc3BvbnNlVHlwZSA9IENvbnN0YW50cy5DT0RFX1JFU1BPTlNFX1RZUEU7XHJcbiAgICAgICAgdGhpcy5hY2NvdW50ID0gKHVzZXJSZXF1ZXN0ICYmIHVzZXJSZXF1ZXN0LmFjY291bnQpIHx8IGNhY2hlZEFjY291bnQ7XHJcblxyXG4gICAgICAgIC8vIFNldCBzY29wZXMsIGFwcGVuZCBleHRyYSBzY29wZXMgaWYgdGhlcmUgaXMgYSBsb2dpbiBjYWxsLlxyXG4gICAgICAgIHRoaXMuc2NvcGVzID0gbmV3IFNjb3BlU2V0KHRoaXMudXNlclJlcXVlc3QgJiYgdGhpcy51c2VyUmVxdWVzdC5zY29wZXMsIHRoaXMuY2xpZW50SWQsICFpc0xvZ2luQ2FsbCk7XHJcbiAgICAgICAgaWYgKGlzTG9naW5DYWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kRXh0cmFTY29wZXMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNldCByYW5kb20gdmFyc1xyXG4gICAgICAgIGNvbnN0IHJhbmRvbUd1aWQgPSB0aGlzLmNyeXB0b09iai5jcmVhdGVOZXdHdWlkKCk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IFByb3RvY29sVXRpbHMuc2V0UmVxdWVzdFN0YXRlKHRoaXMudXNlclJlcXVlc3QgJiYgdGhpcy51c2VyUmVxdWVzdC51c2VyUmVxdWVzdFN0YXRlLCByYW5kb21HdWlkKTtcclxuICAgICAgICB0aGlzLm5vbmNlID0gdGhpcy5jcnlwdG9PYmouY3JlYXRlTmV3R3VpZCgpO1xyXG4gICAgICAgIHRoaXMuY29ycmVsYXRpb25JZCA9IHRoaXMudXNlclJlcXVlc3QuY29ycmVsYXRpb25JZCB8fCB0aGlzLmNyeXB0b09iai5jcmVhdGVOZXdHdWlkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBlbmRzIGV4dHJhU2NvcGVzVG9Db25zZW50IGlmIHBhc3NlZFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFwcGVuZEV4dHJhU2NvcGVzKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLnVzZXJSZXF1ZXN0ICYmIHRoaXMuc2NvcGVzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnVzZXJSZXF1ZXN0LmV4dHJhU2NvcGVzVG9Db25zZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjb3Blcy5hcHBlbmRTY29wZXModGhpcy51c2VyUmVxdWVzdC5leHRyYVNjb3Blc1RvQ29uc2VudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayB0byBzZWUgaWYgdGhlcmUgYXJlIFNTTyBwYXJhbXMgc2V0IGluIHRoZSBSZXF1ZXN0XHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFxyXG4gICAgICovXHJcbiAgICBoYXNTU09QYXJhbSgpOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBpc1NTT1JlcXVlc3QgPSB0aGlzLnVzZXJSZXF1ZXN0ICYmICh0aGlzLmFjY291bnQgfHwgdGhpcy51c2VyUmVxdWVzdC5zaWQgfHwgdGhpcy51c2VyUmVxdWVzdC5sb2dpbkhpbnQpO1xyXG4gICAgICAgIHJldHVybiAhIXRoaXMuYWNjb3VudCB8fCAhIWlzU1NPUmVxdWVzdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFV0aWxpdHkgdG8gcG9wdWxhdGUgUXVlcnlQYXJhbWV0ZXJzIGFuZCBFeHRyYVF1ZXJ5UGFyYW1ldGVycyB0byBTZXJ2ZXJSZXF1ZXN0UGFyYW1lcmVyc1xyXG4gICAgICogQHBhcmFtIGFkYWxJZFRva2VuT2JqZWN0IFxyXG4gICAgICovXHJcbiAgICBwb3B1bGF0ZVF1ZXJ5UGFyYW1zKGFkYWxJZFRva2VuT2JqZWN0PzogSWRUb2tlbik6IHZvaWQge1xyXG4gICAgICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IFN0cmluZ0RpY3QgPSB7fTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudXNlclJlcXVlc3QpIHtcclxuICAgICAgICAgICAgLy8gYWRkIHRoZSBwcm9tcHQgcGFyYW1ldGVyIHRvIHNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzIGlmIHBhc3NlZFxyXG4gICAgICAgICAgICBpZiAodGhpcy51c2VyUmVxdWVzdC5wcm9tcHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVQcm9tcHRQYXJhbWV0ZXIodGhpcy51c2VyUmVxdWVzdC5wcm9tcHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgY2xhaW1zIGNoYWxsZW5nZSB0byBzZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycyBpZiBwYXNzZWRcclxuICAgICAgICAgICAgaWYgKHRoaXMudXNlclJlcXVlc3QuY2xhaW1zUmVxdWVzdCkge1xyXG4gICAgICAgICAgICAgICAgdmFsaWRhdGVDbGFpbXNSZXF1ZXN0KHRoaXMudXNlclJlcXVlc3QpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBpZiB0aGUgZGV2ZWxvcGVyIHByb3ZpZGVzIG9uZSBvZiB0aGVzZSwgZ2l2ZSBwcmVmZXJlbmNlIHRvIGRldmVsb3BlciBjaG9pY2VcclxuICAgICAgICAgICAgaWYgKHRoaXMuaGFzU1NPUGFyYW0oKSkge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzID0gdGhpcy5jb25zdHJ1Y3RVbmlmaWVkQ2FjaGVRdWVyeVBhcmFtZXRlcihudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQURBTCB0b2tlbiBTU09cclxuICAgICAgICBpZiAoYWRhbElkVG9rZW5PYmplY3QpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzID0gdGhpcy5jb25zdHJ1Y3RVbmlmaWVkQ2FjaGVRdWVyeVBhcmFtZXRlcihhZGFsSWRUb2tlbk9iamVjdCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIGFkZHMgc2lkL2xvZ2luX2hpbnQgaWYgbm90IHBvcHVsYXRlZDsgcG9wdWxhdGVzIGRvbWFpbl9oaW50XHJcbiAgICAgICAgICogdGhpcy5sb2dnZXIudmVyYm9zZShcIkNhbGxpbmcgYWRkSGludCBwYXJhbWV0ZXJzXCIpO1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHF1ZXJ5UGFyYW1ldGVycyA9IHRoaXMuYWRkSGludFBhcmFtZXRlcnMocXVlcnlQYXJhbWV0ZXJzKTtcclxuXHJcbiAgICAgICAgLy8gc2FuaXR5IGNoZWNrIGZvciBkZXZlbG9wZXIgcGFzc2VkIGV4dHJhUXVlcnlQYXJhbWV0ZXJzXHJcbiAgICAgICAgbGV0IGVRUGFyYW1zOiBTdHJpbmdEaWN0O1xyXG4gICAgICAgIGlmICh0aGlzLnVzZXJSZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgIGVRUGFyYW1zID0gdGhpcy5zYW5pdGl6ZUVRUGFyYW1zKHRoaXMudXNlclJlcXVlc3QpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUG9wdWxhdGUgdGhlIGV4dHJhUXVlcnlQYXJhbWV0ZXJzIHRvIGJlIHNlbnQgdG8gdGhlIHNlcnZlclxyXG4gICAgICAgIHRoaXMucXVlcnlQYXJhbWV0ZXJzID0gdGhpcy5nZW5lcmF0ZVF1ZXJ5UGFyYW1ldGVyc1N0cmluZyhxdWVyeVBhcmFtZXRlcnMpO1xyXG4gICAgICAgIHRoaXMuZXh0cmFRdWVyeVBhcmFtZXRlcnMgPSB0aGlzLmdlbmVyYXRlUXVlcnlQYXJhbWV0ZXJzU3RyaW5nKGVRUGFyYW1zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBuYXZpZ2F0aW9uIHVybC5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgY3JlYXRlTmF2aWdhdGVVcmwoKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICBjb25zdCBzdHIgPSBhd2FpdCB0aGlzLmNyZWF0ZVBhcmFtU3RyaW5nKCk7XHJcbiAgICAgICAgbGV0IGF1dGhFbmRwb2ludDogc3RyaW5nID0gdGhpcy5hdXRob3JpdHlJbnN0YW5jZS5hdXRob3JpemF0aW9uRW5kcG9pbnQ7XHJcbiAgICAgICAgLy8gaWYgdGhlIGVuZHBvaW50IGFscmVhZHkgaGFzIHF1ZXJ5cGFyYW1zLCBsZXRzIGFkZCB0byBpdCwgb3RoZXJ3aXNlIGFkZCB0aGUgZmlyc3Qgb25lXHJcbiAgICAgICAgaWYgKGF1dGhFbmRwb2ludC5pbmRleE9mKFwiP1wiKSA8IDApIHtcclxuICAgICAgICAgICAgYXV0aEVuZHBvaW50ICs9IFwiP1wiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGF1dGhFbmRwb2ludCArPSBcIiZcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHJlcXVlc3RVcmw6IHN0cmluZyA9IGAke2F1dGhFbmRwb2ludH0ke3N0ci5qb2luKFwiJlwiKX1gO1xyXG4gICAgICAgIHJldHVybiByZXF1ZXN0VXJsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIGEgcXVlcnkgcGFyYW1ldGVyIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIGFzeW5jIGNyZWF0ZVBhcmFtU3RyaW5nKCk6IFByb21pc2U8QXJyYXk8c3RyaW5nPj4ge1xyXG4gICAgICAgIGNvbnN0IHN0cjogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG4gICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5SRVNQT05TRV9UWVBFfT0ke3RoaXMucmVzcG9uc2VUeXBlfWApO1xyXG4gICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5TQ09QRX09JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy5zY29wZXMucHJpbnRTY29wZXMoKSl9YCk7XHJcbiAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLkNMSUVOVF9JRH09JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy5jbGllbnRJZCl9YCk7XHJcbiAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLlJFRElSRUNUX1VSSX09JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy5yZWRpcmVjdFVyaSl9YCk7XHJcblxyXG4gICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5TVEFURX09JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy5zdGF0ZSl9YCk7XHJcbiAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLk5PTkNFfT0ke2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLm5vbmNlKX1gKTtcclxuXHJcbiAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLkNMSUVOVF9JTkZPfT0xYCk7XHJcbiAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLlhfQ0xJRU5UX1NLVX09JHt0aGlzLnhDbGllbnRTa3V9YCk7XHJcbiAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLlhfQ0xJRU5UX1ZFUn09JHt0aGlzLnhDbGllbnRWZXJ9YCk7XHJcblxyXG4gICAgICAgIC8vIEFkZCBjb2RlcyBoZXJlLiBNYXkgd2FudCB0byBhZGQgb3B0aW9uYWwgc3RlcCB0byBhbGxvdyBmb3Igbm9uLVBLQ0UgYXV0aCBjb2RlIGZsb3dzXHJcbiAgICAgICAgdGhpcy5nZW5lcmF0ZWRQa2NlID0gYXdhaXQgdGhpcy5jcnlwdG9PYmouZ2VuZXJhdGVQa2NlQ29kZXMoKTtcclxuICAgICAgICBzdHIucHVzaChgJHtBQURTZXJ2ZXJQYXJhbUtleXMuQ09ERV9DSEFMTEVOR0V9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuZ2VuZXJhdGVkUGtjZS5jaGFsbGVuZ2UpfWApO1xyXG4gICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5DT0RFX0NIQUxMRU5HRV9NRVRIT0R9PSR7Q29uc3RhbnRzLlMyNTZfQ09ERV9DSEFMTEVOR0VfTUVUSE9EfWApO1xyXG5cclxuICAgICAgICAvLyBBcHBlbmQgcmVzb3VyY2VcclxuICAgICAgICBpZiAodGhpcy51c2VyUmVxdWVzdCAmJiB0aGlzLnVzZXJSZXF1ZXN0LnJlc291cmNlKSB7XHJcbiAgICAgICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5SRVNPVVJDRX09JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy51c2VyUmVxdWVzdC5yZXNvdXJjZSl9YCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBcHBlbmQgcHJvbXB0XHJcbiAgICAgICAgaWYgKHRoaXMudXNlclJlcXVlc3QgJiYgdGhpcy51c2VyUmVxdWVzdC5wcm9tcHQpIHtcclxuICAgICAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLlBST01QVH09JHsoZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMudXNlclJlcXVlc3QucHJvbXB0KSl9YCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBcHBlbmQgY2xhaW1zIHJlcXVlc3RcclxuICAgICAgICBpZiAodGhpcy51c2VyUmVxdWVzdCAmJiB0aGlzLnVzZXJSZXF1ZXN0LmNsYWltc1JlcXVlc3QpIHtcclxuICAgICAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLkNMQUlNU309JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy51c2VyUmVxdWVzdC5jbGFpbXNSZXF1ZXN0KX1gKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEFwcGVuZCBxdWVyeSBwYXJhbXNcclxuICAgICAgICBpZiAodGhpcy5xdWVyeVBhcmFtZXRlcnMpIHtcclxuICAgICAgICAgICAgc3RyLnB1c2godGhpcy5xdWVyeVBhcmFtZXRlcnMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQXBwZW5kIGV4dHJhIHF1ZXJ5IHBhcmFtc1xyXG4gICAgICAgIGlmICh0aGlzLmV4dHJhUXVlcnlQYXJhbWV0ZXJzKSB7XHJcbiAgICAgICAgICAgIHN0ci5wdXNoKHRoaXMuZXh0cmFRdWVyeVBhcmFtZXRlcnMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLkNMSUVOVF9SRVFVRVNUX0lEfT0ke2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLmNvcnJlbGF0aW9uSWQpfWApO1xyXG4gICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5SRVNQT05TRV9NT0RFfT0ke0NvbnN0YW50cy5GUkFHTUVOVF9SRVNQT05TRV9NT0RFfWApO1xyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVdGlsaXR5IHRvIHRlc3QgaWYgdmFsaWQgcHJvbXB0IHZhbHVlIGlzIHBhc3NlZCBpbiB0aGUgcmVxdWVzdFxyXG4gICAgICogQHBhcmFtIHJlcXVlc3RcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZVByb21wdFBhcmFtZXRlcihwcm9tcHQ6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIGlmIChbUHJvbXB0U3RhdGUuTE9HSU4sIFByb21wdFN0YXRlLlNFTEVDVF9BQ0NPVU5ULCBQcm9tcHRTdGF0ZS5DT05TRU5ULCBQcm9tcHRTdGF0ZS5OT05FXS5pbmRleE9mKHByb21wdCkgPCAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVJbnZhbGlkUHJvbXB0RXJyb3IocHJvbXB0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RzIGV4dHJhUXVlcnlQYXJhbWV0ZXJzIHRvIGJlIHNlbnQgdG8gdGhlIHNlcnZlciBmb3IgdGhlIEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVycyBzZXQgYnkgdGhlIGRldmVsb3BlclxyXG4gICAgICogaW4gYW55IGxvZ2luKCkgb3IgYWNxdWlyZVRva2VuKCkgY2FsbHNcclxuICAgICAqIEBwYXJhbSBpZFRva2VuT2JqZWN0XHJcbiAgICAgKiBAcGFyYW0gZXh0cmFRdWVyeVBhcmFtZXRlcnNcclxuICAgICAqIEBwYXJhbSBzaWRcclxuICAgICAqIEBwYXJhbSBsb2dpbkhpbnRcclxuICAgICAqL1xyXG4gICAgLy8gVE9ETzogY2hlY2sgaG93IHRoaXMgYmVoYXZlcyB3aGVuIGRvbWFpbl9oaW50IG9ubHkgaXMgc2VudCBpbiBleHRyYXBhcmFtZXRlcnMgYW5kIGlkVG9rZW4gaGFzIG5vIHVwbi5cclxuICAgIHByaXZhdGUgY29uc3RydWN0VW5pZmllZENhY2hlUXVlcnlQYXJhbWV0ZXIoaWRUb2tlbk9iamVjdDogSWRUb2tlbik6IFN0cmluZ0RpY3Qge1xyXG5cclxuICAgICAgICAvLyBwcmVmZXJlbmNlIG9yZGVyOiBhY2NvdW50ID4gc2lkID4gbG9naW5faGludFxyXG4gICAgICAgIGxldCBzc29UeXBlO1xyXG4gICAgICAgIGxldCBzc29EYXRhO1xyXG4gICAgICAgIGxldCBzZXJ2ZXJSZXFQYXJhbTogU3RyaW5nRGljdCA9IHt9O1xyXG4gICAgICAgIC8vIGlmIGFjY291bnQgaW5mbyBpcyBwYXNzZWQsIGFjY291bnQuc2lkID4gYWNjb3VudC5sb2dpbl9oaW50XHJcbiAgICAgICAgaWYgKHRoaXMudXNlclJlcXVlc3QpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWNjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWNjb3VudDogQWNjb3VudCA9IHRoaXMuYWNjb3VudDtcclxuICAgICAgICAgICAgICAgIGlmIChhY2NvdW50LnNpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNzb1R5cGUgPSBTU09UeXBlcy5TSUQ7XHJcbiAgICAgICAgICAgICAgICAgICAgc3NvRGF0YSA9IGFjY291bnQuc2lkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYWNjb3VudC51c2VyTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNzb1R5cGUgPSBTU09UeXBlcy5MT0dJTl9ISU5UO1xyXG4gICAgICAgICAgICAgICAgICAgIHNzb0RhdGEgPSBhY2NvdW50LnVzZXJOYW1lO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHNpZCBmcm9tIHJlcXVlc3RcclxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy51c2VyUmVxdWVzdC5zaWQpIHtcclxuICAgICAgICAgICAgICAgIHNzb1R5cGUgPSBTU09UeXBlcy5TSUQ7XHJcbiAgICAgICAgICAgICAgICBzc29EYXRhID0gdGhpcy51c2VyUmVxdWVzdC5zaWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gbG9naW5IaW50IGZyb20gcmVxdWVzdFxyXG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnVzZXJSZXF1ZXN0LmxvZ2luSGludCkge1xyXG4gICAgICAgICAgICAgICAgc3NvVHlwZSA9IFNTT1R5cGVzLkxPR0lOX0hJTlQ7XHJcbiAgICAgICAgICAgICAgICBzc29EYXRhID0gdGhpcy51c2VyUmVxdWVzdC5sb2dpbkhpbnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gYWRhbElkVG9rZW4gcmV0cmlldmVkIGZyb20gY2FjaGVcclxuICAgICAgICBlbHNlIGlmIChpZFRva2VuT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGlmIChpZFRva2VuT2JqZWN0LmNsYWltcyAmJiBpZFRva2VuT2JqZWN0LmNsYWltcy5wcmVmZXJyZWRfdXNlcm5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHNzb1R5cGUgPSBTU09UeXBlcy5JRF9UT0tFTjtcclxuICAgICAgICAgICAgICAgIHNzb0RhdGEgPSBpZFRva2VuT2JqZWN0LmNsYWltcy5wcmVmZXJyZWRfdXNlcm5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzc29UeXBlID0gU1NPVHlwZXMuT1JHQU5JWkFUSU9OUztcclxuICAgICAgICAgICAgICAgIHNzb0RhdGEgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZXJ2ZXJSZXFQYXJhbSA9IHRoaXMuYWRkU1NPUGFyYW1ldGVyKHNzb1R5cGUsIHNzb0RhdGEpO1xyXG5cclxuICAgICAgICAvLyBhZGQgdGhlIEhvbWVBY2NvdW50SWRlbnRpZmllciBpbmZvLyBkb21haW5faGludFxyXG4gICAgICAgIGlmICh0aGlzLmFjY291bnQgJiYgdGhpcy5hY2NvdW50LmhvbWVBY2NvdW50SWRlbnRpZmllcikge1xyXG4gICAgICAgICAgICBzZXJ2ZXJSZXFQYXJhbSA9IHRoaXMuYWRkU1NPUGFyYW1ldGVyKFNTT1R5cGVzLkhPTUVBQ0NPVU5UX0lELCB0aGlzLmFjY291bnQuaG9tZUFjY291bnRJZGVudGlmaWVyLCBzZXJ2ZXJSZXFQYXJhbSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gc2VydmVyUmVxUGFyYW07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGxvZ2luX2hpbnQgdG8gYXV0aG9yaXphdGlvbiBVUkwgd2hpY2ggaXMgdXNlZCB0byBwcmUtZmlsbCB0aGUgdXNlcm5hbWUgZmllbGQgb2Ygc2lnbiBpbiBwYWdlIGZvciB0aGUgdXNlciBpZiBrbm93biBhaGVhZCBvZiB0aW1lXHJcbiAgICAgKiBkb21haW5faGludCBjYW4gYmUgb25lIG9mIHVzZXJzL29yZ2FuaXphdGlvbnMgd2hpY2ggd2hlbiBhZGRlZCBza2lwcyB0aGUgZW1haWwgYmFzZWQgZGlzY292ZXJ5IHByb2Nlc3Mgb2YgdGhlIHVzZXJcclxuICAgICAqIGRvbWFpbl9yZXEgdXRpZCByZWNlaXZlZCBhcyBwYXJ0IG9mIHRoZSBjbGllbnRJbmZvXHJcbiAgICAgKiBsb2dpbl9yZXEgdWlkIHJlY2VpdmVkIGFzIHBhcnQgb2YgY2xpZW50SW5mb1xyXG4gICAgICogQWxzbyBkb2VzIGEgc2FuaXR5IGNoZWNrIGZvciBleHRyYVF1ZXJ5UGFyYW1ldGVycyBwYXNzZWQgYnkgdGhlIHVzZXIgdG8gZW5zdXJlIG5vIHJlcGVhdCBxdWVyeVBhcmFtZXRlcnNcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0BsaW5rIEFjY291bnR9IGFjY291bnQgLSBBY2NvdW50IGZvciB3aGljaCB0aGUgdG9rZW4gaXMgcmVxdWVzdGVkXHJcbiAgICAgKiBAcGFyYW0gcXVlcnlwYXJhbXNcclxuICAgICAqIEBwYXJhbSB7QGxpbmsgU2VydmVyUmVxdWVzdFBhcmFtZXRlcnN9XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYWRkSGludFBhcmFtZXRlcnMocVBhcmFtczogU3RyaW5nRGljdCk6IFN0cmluZ0RpY3Qge1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICogVGhpcyBpcyBhIGZpbmFsIGNoZWNrIGZvciBhbGwgcXVlcnlQYXJhbXMgYWRkZWQgc28gZmFyOyBwcmVmZXJlbmNlIG9yZGVyOiBzaWQgPiBsb2dpbl9oaW50XHJcbiAgICAgICAgICogc2lkIGNhbm5vdCBiZSBwYXNzZWQgYWxvbmcgd2l0aCBsb2dpbl9oaW50IG9yIGRvbWFpbl9oaW50LCBoZW5jZSB3ZSBjaGVjayBib3RoIGFyZSBub3QgcG9wdWxhdGVkIHlldCBpbiBxdWVyeVBhcmFtZXRlcnNcclxuICAgICAgICAgKi9cclxuICAgICAgICBpZiAodGhpcy5hY2NvdW50ICYmICFxUGFyYW1zW1NTT1R5cGVzLlNJRF0pIHtcclxuICAgICAgICAgICAgLy8gc2lkIC0gcG9wdWxhdGUgb25seSBpZiBsb2dpbl9oaW50IGlzIG5vdCBhbHJlYWR5IHBvcHVsYXRlZCBhbmQgdGhlIGFjY291bnQgaGFzIHNpZFxyXG4gICAgICAgICAgICBjb25zdCBwb3B1bGF0ZVNJRCA9ICFxUGFyYW1zW1NTT1R5cGVzLkxPR0lOX0hJTlRdICYmIHRoaXMuYWNjb3VudC5zaWQgJiYgdGhpcy51c2VyUmVxdWVzdC5wcm9tcHQgPT09IFByb21wdFN0YXRlLk5PTkU7XHJcbiAgICAgICAgICAgIGlmIChwb3B1bGF0ZVNJRCkge1xyXG4gICAgICAgICAgICAgICAgcVBhcmFtcyA9IHRoaXMuYWRkU1NPUGFyYW1ldGVyKFNTT1R5cGVzLlNJRCwgdGhpcy5hY2NvdW50LnNpZCwgcVBhcmFtcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gbG9naW5faGludCAtIGFjY291bnQudXNlck5hbWVcclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwb3B1bGF0ZUxvZ2luSGludCA9ICFxUGFyYW1zW1NTT1R5cGVzLkxPR0lOX0hJTlRdICYmIHRoaXMuYWNjb3VudC51c2VyTmFtZSAmJiAhU3RyaW5nVXRpbHMuaXNFbXB0eSh0aGlzLmFjY291bnQudXNlck5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBvcHVsYXRlTG9naW5IaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcVBhcmFtcyA9IHRoaXMuYWRkU1NPUGFyYW1ldGVyKFNTT1R5cGVzLkxPR0lOX0hJTlQsIHRoaXMuYWNjb3VudC51c2VyTmFtZSwgcVBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBxUGFyYW1zO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkIFNJRCB0byBleHRyYVF1ZXJ5UGFyYW1ldGVyc1xyXG4gICAgICogQHBhcmFtIHNpZFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFkZFNTT1BhcmFtZXRlcihzc29UeXBlOiBzdHJpbmcsIHNzb0RhdGE6IHN0cmluZywgc3NvUGFyYW0/OiBTdHJpbmdEaWN0KTogU3RyaW5nRGljdCB7XHJcbiAgICAgICAgaWYgKCFzc29QYXJhbSkge1xyXG4gICAgICAgICAgICBzc29QYXJhbSA9IHt9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFzc29EYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzc29QYXJhbTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHN3aXRjaCAoc3NvVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIFNTT1R5cGVzLlNJRDoge1xyXG4gICAgICAgICAgICAgICAgc3NvUGFyYW1bU1NPVHlwZXMuU0lEXSA9IHNzb0RhdGE7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIFNTT1R5cGVzLklEX1RPS0VOOiB7XHJcbiAgICAgICAgICAgICAgICBzc29QYXJhbVtTU09UeXBlcy5MT0dJTl9ISU5UXSA9IHNzb0RhdGE7XHJcbiAgICAgICAgICAgICAgICBzc29QYXJhbVtTU09UeXBlcy5ET01BSU5fSElOVF0gPSBTU09UeXBlcy5PUkdBTklaQVRJT05TO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBTU09UeXBlcy5MT0dJTl9ISU5UOiB7XHJcbiAgICAgICAgICAgICAgICBzc29QYXJhbVtTU09UeXBlcy5MT0dJTl9ISU5UXSA9IHNzb0RhdGE7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIFNTT1R5cGVzLk9SR0FOSVpBVElPTlM6IHtcclxuICAgICAgICAgICAgICAgIHNzb1BhcmFtW1NTT1R5cGVzLkRPTUFJTl9ISU5UXSA9IFNTT1R5cGVzLk9SR0FOSVpBVElPTlM7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIFNTT1R5cGVzLkNPTlNVTUVSUzoge1xyXG4gICAgICAgICAgICAgICAgc3NvUGFyYW1bU1NPVHlwZXMuRE9NQUlOX0hJTlRdID0gU1NPVHlwZXMuQ09OU1VNRVJTO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBTU09UeXBlcy5IT01FQUNDT1VOVF9JRDoge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaG9tZUFjY291bnRJZCA9IHNzb0RhdGEuc3BsaXQoXCIuXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdXRpZCA9IHRoaXMuY3J5cHRvT2JqLmJhc2U2NERlY29kZShob21lQWNjb3VudElkWzFdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodXRpZCA9PT0gQ29uc3RhbnRzLkNPTlNVTUVSX1VUSUQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzc29QYXJhbVtTU09UeXBlcy5ET01BSU5fSElOVF0gPSBTU09UeXBlcy5DT05TVU1FUlM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzc29QYXJhbVtTU09UeXBlcy5ET01BSU5fSElOVF0gPSBTU09UeXBlcy5PUkdBTklaQVRJT05TO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzc29QYXJhbTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgdW5uZWNlc3Nhcnkgb3IgZHVwbGljYXRlIHF1ZXJ5IHBhcmFtZXRlcnMgZnJvbSBleHRyYVF1ZXJ5UGFyYW1ldGVyc1xyXG4gICAgICogQHBhcmFtIHJlcXVlc3RcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzYW5pdGl6ZUVRUGFyYW1zKHJlcXVlc3Q6IEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVycykgOiBTdHJpbmdEaWN0IHtcclxuICAgICAgICBjb25zdCBlUVBhcmFtcyA6IFN0cmluZ0RpY3QgPSByZXF1ZXN0LmV4dHJhUXVlcnlQYXJhbWV0ZXJzO1xyXG4gICAgICAgIGlmICghZVFQYXJhbXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXF1ZXN0LmNsYWltc1JlcXVlc3QpIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5sb2dnZXIud2FybmluZyhcIlJlbW92ZWQgZHVwbGljYXRlIGNsYWltcyBmcm9tIGV4dHJhUXVlcnlQYXJhbWV0ZXJzLiBQbGVhc2UgdXNlIGVpdGhlciB0aGUgY2xhaW1zUmVxdWVzdCBmaWVsZCBPUiBwYXNzIGFzIGV4dHJhUXVlcnlQYXJhbWV0ZXIgLSBub3QgYm90aC5cIik7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBlUVBhcmFtc1tDb25zdGFudHMuQ0xBSU1TXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgQmxhY2tsaXN0ZWRFUVBhcmFtcy5mb3JFYWNoKHBhcmFtID0+IHtcclxuICAgICAgICAgICAgaWYgKGVRUGFyYW1zW3BhcmFtXSkge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5sb2dnZXIud2FybmluZyhcIlJlbW92ZWQgZHVwbGljYXRlIFwiICsgcGFyYW0gKyBcIiBmcm9tIGV4dHJhUXVlcnlQYXJhbWV0ZXJzLiBQbGVhc2UgdXNlIHRoZSBcIiArIHBhcmFtICsgXCIgZmllbGQgaW4gcmVxdWVzdCBvYmplY3QuXCIpO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIGVRUGFyYW1zW3BhcmFtXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBlUVBhcmFtcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFV0aWxpdHkgdG8gZ2VuZXJhdGUgYSBRdWVyeVBhcmFtZXRlclN0cmluZyBmcm9tIGEgS2V5LVZhbHVlIG1hcHBpbmcgb2YgZXh0cmFRdWVyeVBhcmFtZXRlcnMgcGFzc2VkXHJcbiAgICAgKiBAcGFyYW0gZXh0cmFRdWVyeVBhcmFtZXRlcnNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZVF1ZXJ5UGFyYW1ldGVyc1N0cmluZyhxdWVyeVBhcmFtZXRlcnM6IFN0cmluZ0RpY3QpOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCBwYXJhbXNTdHJpbmc6IHN0cmluZyA9IG51bGw7XHJcblxyXG4gICAgICAgIGlmIChxdWVyeVBhcmFtZXRlcnMpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMocXVlcnlQYXJhbWV0ZXJzKS5mb3JFYWNoKChrZXk6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtc1N0cmluZyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zU3RyaW5nID0gYCR7a2V5fT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeVBhcmFtZXRlcnNba2V5XSl9YDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtc1N0cmluZyArPSBgJiR7a2V5fT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeVBhcmFtZXRlcnNba2V5XSl9YDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcGFyYW1zU3RyaW5nO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5pbXBvcnQgeyBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycyB9IGZyb20gXCIuL1NlcnZlclJlcXVlc3RQYXJhbWV0ZXJzXCI7XHJcbmltcG9ydCB7IFNjb3BlU2V0IH0gZnJvbSBcIi4uL2F1dGgvU2NvcGVTZXRcIjtcclxuaW1wb3J0IHsgVG9rZW5FeGNoYW5nZVBhcmFtZXRlcnMgfSBmcm9tIFwiLi4vcmVxdWVzdC9Ub2tlbkV4Y2hhbmdlUGFyYW1ldGVyc1wiO1xyXG5pbXBvcnQgeyBDb2RlUmVzcG9uc2UgfSBmcm9tIFwiLi4vcmVzcG9uc2UvQ29kZVJlc3BvbnNlXCI7XHJcbmltcG9ydCB7IENsaWVudEF1dGhFcnJvciB9IGZyb20gXCIuLi9lcnJvci9DbGllbnRBdXRoRXJyb3JcIjtcclxuaW1wb3J0IHsgSUNyeXB0byB9IGZyb20gXCIuLi9jcnlwdG8vSUNyeXB0b1wiO1xyXG5pbXBvcnQgeyBTdHJpbmdVdGlscyB9IGZyb20gXCIuLi91dGlscy9TdHJpbmdVdGlsc1wiO1xyXG5pbXBvcnQgeyBDb25zdGFudHMsIEhFQURFUl9OQU1FUywgQUFEU2VydmVyUGFyYW1LZXlzIH0gZnJvbSBcIi4uL3V0aWxzL0NvbnN0YW50c1wiO1xyXG5cclxuLyoqXHJcbiAqIFRoaXMgY2xhc3MgZXh0ZW5kcyB0aGUgU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMgY2xhc3MuIFRoaXMgY2xhc3MgdmFsaWRhdGVzIHRva2VuIHJlcXVlc3QgcGFyYW1ldGVycyBhbmQgZ2VuZXJhdGVzIGEgZm9ybSBib2R5IGFuZCBoZWFkZXJzIHJlcXVpcmVkIGZvciB0aGUgcmVxdWVzdC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBTZXJ2ZXJUb2tlblJlcXVlc3RQYXJhbWV0ZXJzIGV4dGVuZHMgU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMge1xyXG5cclxuICAgIC8vIFBhcmFtc1xyXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmc7XHJcbiAgICB0b2tlblJlcXVlc3Q6IFRva2VuRXhjaGFuZ2VQYXJhbWV0ZXJzO1xyXG4gICAgY29kZVJlc3BvbnNlOiBDb2RlUmVzcG9uc2U7XHJcbiAgICByZWZyZXNoVG9rZW46IHN0cmluZztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihjbGllbnRJZDogc3RyaW5nLCBjbGllbnRTZWNyZXQ6IHN0cmluZywgdG9rZW5SZXF1ZXN0OiBUb2tlbkV4Y2hhbmdlUGFyYW1ldGVycywgY29kZVJlc3BvbnNlOiBDb2RlUmVzcG9uc2UsIHJlZGlyZWN0VXJpOiBzdHJpbmcsIGNyeXB0b0ltcGw6IElDcnlwdG8sIHJlZnJlc2hUb2tlbj86IHN0cmluZykge1xyXG4gICAgICAgIHN1cGVyKGNsaWVudElkLCByZWRpcmVjdFVyaSwgY3J5cHRvSW1wbCk7XHJcbiAgICAgICAgdGhpcy5jbGllbnRTZWNyZXQgPSBjbGllbnRTZWNyZXQ7XHJcbiAgICAgICAgdGhpcy50b2tlblJlcXVlc3QgPSB0b2tlblJlcXVlc3Q7XHJcbiAgICAgICAgdGhpcy5jb2RlUmVzcG9uc2UgPSBjb2RlUmVzcG9uc2U7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoVG9rZW4gPSByZWZyZXNoVG9rZW47XHJcblxyXG4gICAgICAgIC8vIFNldCBzY29wZXMsIGFsd2F5cyByZXF1aXJlZCBmb3IgdG9rZW4gcmVxdWVzdC9leGNoYW5nZVxyXG4gICAgICAgIHRoaXMuc2NvcGVzID0gbmV3IFNjb3BlU2V0KHRoaXMudG9rZW5SZXF1ZXN0ICYmIHRoaXMudG9rZW5SZXF1ZXN0LnNjb3BlcywgdGhpcy5jbGllbnRJZCwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIC8vIFNldCBjb3JyZWxhdGlvbiBpZFxyXG4gICAgICAgIHRoaXMuY29ycmVsYXRpb25JZCA9IHRoaXMudG9rZW5SZXF1ZXN0LmNvcnJlbGF0aW9uSWQgfHwgdGhpcy5jcnlwdG9PYmouY3JlYXRlTmV3R3VpZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBoZWFkZXJzIHJlcXVpcmVkIGZvciB0b2tlbiByZXF1ZXN0LlxyXG4gICAgICovXHJcbiAgICBjcmVhdGVSZXF1ZXN0SGVhZGVycygpOiBNYXA8c3RyaW5nLCBzdHJpbmc+IHtcclxuICAgICAgICBjb25zdCBoZWFkZXJzID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcclxuICAgICAgICBoZWFkZXJzLnNldChIRUFERVJfTkFNRVMuQ09OVEVOVF9UWVBFLCBDb25zdGFudHMuVVJMX0ZPUk1fQ09OVEVOVF9UWVBFKTtcclxuICAgICAgICByZXR1cm4gaGVhZGVycztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgc3RyaW5nIG9mIHBhcmFtZXRlcnMgdG8gc2VuZCB0byBzZXJ2ZXIgaW4gcmVxdWVzdCBib2R5LlxyXG4gICAgICovXHJcbiAgICBjcmVhdGVSZXF1ZXN0Qm9keSgpOiBzdHJpbmcge1xyXG4gICAgICAgIGNvbnN0IHBhcmFtU3RyaW5nID0gdGhpcy5jcmVhdGVQYXJhbVN0cmluZygpO1xyXG4gICAgICAgIHJldHVybiBwYXJhbVN0cmluZy5qb2luKFwiJlwiKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciBjcmVhdGVzIGFuIGFycmF5IG9mIGtleSB2YWx1ZSBzdHJpbmcgcGFpcnMuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY3JlYXRlUGFyYW1TdHJpbmcoKTogQXJyYXk8c3RyaW5nPiB7XHJcbiAgICAgICAgY29uc3Qgc3RyOiBBcnJheTxzdHJpbmc+ID0gW107XHJcblxyXG4gICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5DTElFTlRfSUR9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuY2xpZW50SWQpfWApO1xyXG4gICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5TQ09QRX09JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy5zY29wZXMucHJpbnRTY29wZXMoKSl9YCk7XHJcbiAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLlJFRElSRUNUX1VSSX09JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy5yZWRpcmVjdFVyaSl9YCk7XHJcbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBjb2RlIHJlc3BvbnNlIG9yIHJlZnJlc2ggdG9rZW4sIHB1c2ggcmVsZXZhbnQgdmFyaWFibGVzLiBUaHJvdyBlcnJvciBvdGhlcndpc2UuXHJcbiAgICAgICAgaWYgKHRoaXMuY29kZVJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5DT0RFfT0ke2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLmNvZGVSZXNwb25zZS5jb2RlKX1gKTtcclxuICAgICAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLkNPREVfVkVSSUZJRVJ9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMudG9rZW5SZXF1ZXN0LmNvZGVWZXJpZmllcil9YCk7XHJcbiAgICAgICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5HUkFOVF9UWVBFfT0ke0NvbnN0YW50cy5DT0RFX0dSQU5UX1RZUEV9YCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eSh0aGlzLnJlZnJlc2hUb2tlbikpIHtcclxuICAgICAgICAgICAgc3RyLnB1c2goYCR7QUFEU2VydmVyUGFyYW1LZXlzLlJFRlJFU0hfVE9LRU59PSR7dGhpcy5yZWZyZXNoVG9rZW59YCk7XHJcbiAgICAgICAgICAgIHN0ci5wdXNoKGAke0FBRFNlcnZlclBhcmFtS2V5cy5HUkFOVF9UWVBFfT0ke0NvbnN0YW50cy5SVF9HUkFOVF9UWVBFfWApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudEF1dGhFcnJvci5jcmVhdGVUb2tlblJlcXVlc3RDYW5ub3RCZU1hZGVFcnJvcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVGVtcG9yYXJ5IHVudGlsIHNlcnZlciBhbGxvd3MgQ09SUyByZXF1ZXN0cyBmcm9tIGJyb3dzZXIgd2l0aG91dCBjbGllbnQgc2VjcmV0XHJcbiAgICAgICAgc3RyLnB1c2goYGNsaWVudF9zZWNyZXQ9JHt0aGlzLmNsaWVudFNlY3JldH1gKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBVdGlsaXR5IGNsYXNzIHdoaWNoIGV4cG9zZXMgZnVuY3Rpb25zIGZvciBtYW5hZ2luZyBkYXRlIGFuZCB0aW1lIG9wZXJhdGlvbnMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVGltZVV0aWxzIHtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aW1lIGluIHNlY29uZHMgZm9yIGV4cGlyYXRpb24gYmFzZWQgb24gc3RyaW5nIHZhbHVlIHBhc3NlZCBpbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXhwaXJlc0luXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBwYXJzZUV4cGlyZXNJblNlY29uZHMoZXhwaXJlc0luOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgICAgIC8vIGlmIEFBRCBkaWQgbm90IHNlbmQgXCJleHBpcmVzX2luXCIgcHJvcGVydHksIHVzZSBkZWZhdWx0IGV4cGlyYXRpb24gb2YgMzU5OSBzZWNvbmRzLCBmb3Igc29tZSByZWFzb24gQUFEIHNlbmRzIDM1OTkgYXMgXCJleHBpcmVzX2luXCIgdmFsdWUgaW5zdGVhZCBvZiAzNjAwXHJcbiAgICAgICAgcmV0dXJuIGV4cGlyZXNJbiB8fCAzNTk5O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogcmV0dXJuIHRoZSBjdXJyZW50IHRpbWUgaW4gVW5peCB0aW1lIChzZWNvbmRzKS5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIG5vd1NlY29uZHMoKTogbnVtYmVyIHtcclxuICAgICAgICAvLyBEYXRlLmdldFRpbWUoKSByZXR1cm5zIGluIG1pbGxpc2Vjb25kcy5cclxuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDAuMCk7XHJcbiAgICB9XHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IFNlcnZlckF1dGhvcml6YXRpb25Db2RlUmVzcG9uc2UgfSBmcm9tIFwiLi4vc2VydmVyL1NlcnZlckF1dGhvcml6YXRpb25Db2RlUmVzcG9uc2VcIjtcclxuaW1wb3J0IHsgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIH0gZnJvbSBcIi4uL2Vycm9yL0NsaWVudENvbmZpZ3VyYXRpb25FcnJvclwiO1xyXG5pbXBvcnQgeyBDbGllbnRBdXRoRXJyb3IgfSBmcm9tIFwiLi4vZXJyb3IvQ2xpZW50QXV0aEVycm9yXCI7XHJcbmltcG9ydCB7IFN0cmluZ1V0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL1N0cmluZ1V0aWxzXCI7XHJcbmltcG9ydCB7IElVcmkgfSBmcm9tIFwiLi9JVXJpXCI7XHJcbmltcG9ydCB7IEFBREF1dGhvcml0eUNvbnN0YW50cyB9IGZyb20gXCIuLi91dGlscy9Db25zdGFudHNcIjtcclxuXHJcbi8qKlxyXG4gKiBVcmwgb2JqZWN0IGNsYXNzIHdoaWNoIGNhbiBwZXJmb3JtIHZhcmlvdXMgdHJhbnNmb3JtYXRpb25zIG9uIHVybCBzdHJpbmdzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFVybFN0cmluZyB7XHJcblxyXG4gICAgLy8gaW50ZXJuYWwgdXJsIHN0cmluZyBmaWVsZFxyXG4gICAgcHJpdmF0ZSBfdXJsU3RyaW5nOiBzdHJpbmc7XHJcbiAgICBwdWJsaWMgZ2V0IHVybFN0cmluZygpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl91cmxTdHJpbmc7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKHVybDogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5fdXJsU3RyaW5nID0gdXJsO1xyXG4gICAgICAgIGlmKHRoaXMuX3VybFN0cmluZyAmJiBTdHJpbmdVdGlscy5pc0VtcHR5KHRoaXMuZ2V0SGFzaCgpKSkge1xyXG4gICAgICAgICAgICB0aGlzLl91cmxTdHJpbmcgPSB0aGlzLmNhbm9uaWNhbGl6ZVVyaSh1cmwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEVuc3VyZSB1cmxzIGFyZSBsb3dlciBjYXNlIGFuZCBlbmQgd2l0aCBhIC8gY2hhcmFjdGVyLlxyXG4gICAgICogQHBhcmFtIHVybCBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjYW5vbmljYWxpemVVcmkodXJsOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIGlmICh1cmwpIHtcclxuICAgICAgICAgICAgdXJsID0gdXJsLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodXJsICYmICF1cmwuZW5kc1dpdGgoXCIvXCIpKSB7XHJcbiAgICAgICAgICAgIHVybCArPSBcIi9cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaHJvd3MgaWYgdXJsU3RyaW5nIHBhc3NlZCBpcyBub3QgYSB2YWxpZCBhdXRob3JpdHkgVVJJIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgdmFsaWRhdGVBc1VyaSgpOiB2b2lkIHtcclxuICAgICAgICAvLyBBdHRlbXB0cyB0byBwYXJzZSB1cmwgZm9yIHVyaSBjb21wb25lbnRzXHJcbiAgICAgICAgbGV0IGNvbXBvbmVudHM7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29tcG9uZW50cyA9IHRoaXMuZ2V0VXJsQ29tcG9uZW50cygpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZVVybFBhcnNlRXJyb3IoZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBUaHJvdyBlcnJvciBpZiB1cmkgaXMgaW5zZWN1cmUuXHJcbiAgICAgICAgaWYoIWNvbXBvbmVudHMuUHJvdG9jb2wgfHwgY29tcG9uZW50cy5Qcm90b2NvbC50b0xvd2VyQ2FzZSgpICE9PSBcImh0dHBzOlwiKSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVJbnNlY3VyZUF1dGhvcml0eVVyaUVycm9yKHRoaXMudXJsU3RyaW5nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRocm93IGVycm9yIGlmIHBhdGggc2VnbWVudHMgYXJlIG5vdCBwYXJzZWFibGUuXHJcbiAgICAgICAgaWYgKCFjb21wb25lbnRzLlBhdGhTZWdtZW50cyB8fCBjb21wb25lbnRzLlBhdGhTZWdtZW50cy5sZW5ndGggPCAxKSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVVcmxQYXJzZUVycm9yKGBHaXZlbiB1cmwgc3RyaW5nOiAke3RoaXMudXJsU3RyaW5nfWApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEZ1bmN0aW9uIHRvIHJlbW92ZSBxdWVyeSBzdHJpbmcgcGFyYW1zIGZyb20gdXJsLiBSZXR1cm5zIHRoZSBuZXcgdXJsLlxyXG4gICAgICogQHBhcmFtIHVybFxyXG4gICAgICogQHBhcmFtIG5hbWVcclxuICAgICAqL1xyXG4gICAgdXJsUmVtb3ZlUXVlcnlTdHJpbmdQYXJhbWV0ZXIobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eSh0aGlzLnVybFN0cmluZykpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZVVybEVtcHR5RXJyb3IoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCByZWdleCA9IG5ldyBSZWdFeHAoXCIoXFxcXCZcIiArIG5hbWUgKyBcIj0pW15cXCZdK1wiKTtcclxuICAgICAgICB0aGlzLl91cmxTdHJpbmcgPSB0aGlzLnVybFN0cmluZy5yZXBsYWNlKHJlZ2V4LCBcIlwiKTtcclxuICAgICAgICAvLyBuYW1lPXZhbHVlJlxyXG4gICAgICAgIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIihcIiArIG5hbWUgKyBcIj0pW15cXCZdKyZcIik7XHJcbiAgICAgICAgdGhpcy5fdXJsU3RyaW5nID0gdGhpcy51cmxTdHJpbmcucmVwbGFjZShyZWdleCwgXCJcIik7XHJcbiAgICAgICAgLy8gbmFtZT12YWx1ZVxyXG4gICAgICAgIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIihcIiArIG5hbWUgKyBcIj0pW15cXCZdK1wiKTtcclxuICAgICAgICB0aGlzLl91cmxTdHJpbmcgPSB0aGlzLnVybFN0cmluZy5yZXBsYWNlKHJlZ2V4LCBcIlwiKTtcclxuICAgICAgICByZXR1cm4gdGhpcy51cmxTdHJpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHaXZlbiBhIHVybCBsaWtlIGh0dHBzOi8vYTpiL2NvbW1vbi9kP2U9ZiNnLCBhbmQgYSB0ZW5hbnRJZCwgcmV0dXJucyBodHRwczovL2E6Yi90ZW5hbnRJZC9kXHJcbiAgICAgKiBAcGFyYW0gaHJlZiBUaGUgdXJsXHJcbiAgICAgKiBAcGFyYW0gdGVuYW50SWQgVGhlIHRlbmFudCBpZCB0byByZXBsYWNlXHJcbiAgICAgKi9cclxuICAgIHJlcGxhY2VUZW5hbnRQYXRoKHRlbmFudElkOiBzdHJpbmcpOiBVcmxTdHJpbmcge1xyXG4gICAgICAgIGNvbnN0IHVybE9iamVjdCA9IHRoaXMuZ2V0VXJsQ29tcG9uZW50cygpO1xyXG4gICAgICAgIGNvbnN0IHBhdGhBcnJheSA9IHVybE9iamVjdC5QYXRoU2VnbWVudHM7XHJcbiAgICAgICAgaWYgKHRlbmFudElkICYmIChwYXRoQXJyYXkubGVuZ3RoICE9PSAwICYmIChwYXRoQXJyYXlbMF0gPT09IEFBREF1dGhvcml0eUNvbnN0YW50cy5DT01NT04gfHwgcGF0aEFycmF5WzBdID09PSBBQURBdXRob3JpdHlDb25zdGFudHMuT1JHQU5JWkFUSU9OUykpKSB7XHJcbiAgICAgICAgICAgIHBhdGhBcnJheVswXSA9IHRlbmFudElkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gVXJsU3RyaW5nLmNvbnN0cnVjdEF1dGhvcml0eVVyaUZyb21PYmplY3QodXJsT2JqZWN0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGFuY2hvciBwYXJ0KCMpIG9mIHRoZSBVUkxcclxuICAgICAqL1xyXG4gICAgZ2V0SGFzaCgpOiBzdHJpbmcge1xyXG4gICAgICAgIGNvbnN0IGhhc2hJbmRleDEgPSB0aGlzLnVybFN0cmluZy5pbmRleE9mKFwiI1wiKTtcclxuICAgICAgICBjb25zdCBoYXNoSW5kZXgyID0gdGhpcy51cmxTdHJpbmcuaW5kZXhPZihcIiMvXCIpO1xyXG4gICAgICAgIGlmIChoYXNoSW5kZXgyID4gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXJsU3RyaW5nLnN1YnN0cmluZyhoYXNoSW5kZXgyICsgMik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChoYXNoSW5kZXgxID4gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXJsU3RyaW5nLnN1YnN0cmluZyhoYXNoSW5kZXgxICsgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBkZXNlcmlhbGl6ZWQgcG9ydGlvbiBvZiBVUkwgaGFzaFxyXG4gICAgICovXHJcbiAgICBnZXREZXNlcmlhbGl6ZWRIYXNoPFQ+KCk6IFQge1xyXG4gICAgICAgIGNvbnN0IGhhc2ggPSB0aGlzLmdldEhhc2goKTtcclxuICAgICAgICBjb25zdCBkZXNlcmlhbGl6ZWRIYXNoOiBUID0gU3RyaW5nVXRpbHMucXVlcnlTdHJpbmdUb09iamVjdDxUPihoYXNoKTtcclxuICAgICAgICBpZiAoIWRlc2VyaWFsaXplZEhhc2gpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUhhc2hOb3REZXNlcmlhbGl6ZWRFcnJvcihKU09OLnN0cmluZ2lmeShkZXNlcmlhbGl6ZWRIYXNoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkZXNlcmlhbGl6ZWRIYXNoO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIG91dCB0aGUgY29tcG9uZW50cyBmcm9tIGEgdXJsIHN0cmluZy5cclxuICAgICAqIEByZXR1cm5zIEFuIG9iamVjdCB3aXRoIHRoZSB2YXJpb3VzIGNvbXBvbmVudHMuIFBsZWFzZSBjYWNoZSB0aGlzIHZhbHVlIGluc3RlZCBvZiBjYWxsaW5nIHRoaXMgbXVsdGlwbGUgdGltZXMgb24gdGhlIHNhbWUgdXJsLlxyXG4gICAgICovXHJcbiAgICBnZXRVcmxDb21wb25lbnRzKCk6IElVcmkge1xyXG4gICAgICAgIC8vIFRocm93cyBlcnJvciBpZiB1cmwgaXMgZW1wdHlcclxuICAgICAgICBpZiAoIXRoaXMudXJsU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVVcmxFbXB0eUVycm9yKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9jdXJ0aXN6LzExMTM5YjJjZmNhZWY0YTI2MWUwXHJcbiAgICAgICAgY29uc3QgcmVnRXggPSBSZWdFeHAoXCJeKChbXjovPyNdKyk6KT8oLy8oW14vPyNdKikpPyhbXj8jXSopKFxcXFw/KFteI10qKSk/KCMoLiopKT9cIik7XHJcblxyXG4gICAgICAgIC8vIElmIHVybCBzdHJpbmcgZG9lcyBub3QgbWF0Y2ggcmVnRXgsIHdlIHRocm93IGFuIGVycm9yXHJcbiAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLnVybFN0cmluZy5tYXRjaChyZWdFeCk7XHJcbiAgICAgICAgaWYgKCFtYXRjaCkge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlVXJsUGFyc2VFcnJvcihgR2l2ZW4gdXJsIHN0cmluZzogJHt0aGlzLnVybFN0cmluZ31gKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFVybCBjb21wb25lbnQgb2JqZWN0XHJcbiAgICAgICAgY29uc3QgdXJsQ29tcG9uZW50cyA9IHtcclxuICAgICAgICAgICAgUHJvdG9jb2w6IG1hdGNoWzFdLFxyXG4gICAgICAgICAgICBIb3N0TmFtZUFuZFBvcnQ6IG1hdGNoWzRdLFxyXG4gICAgICAgICAgICBBYnNvbHV0ZVBhdGg6IG1hdGNoWzVdXHJcbiAgICAgICAgfSBhcyBJVXJpO1xyXG5cclxuICAgICAgICBsZXQgcGF0aFNlZ21lbnRzID0gdXJsQ29tcG9uZW50cy5BYnNvbHV0ZVBhdGguc3BsaXQoXCIvXCIpO1xyXG4gICAgICAgIHBhdGhTZWdtZW50cyA9IHBhdGhTZWdtZW50cy5maWx0ZXIoKHZhbCkgPT4gdmFsICYmIHZhbC5sZW5ndGggPiAwKTsgLy8gcmVtb3ZlIGVtcHR5IGVsZW1lbnRzXHJcbiAgICAgICAgdXJsQ29tcG9uZW50cy5QYXRoU2VnbWVudHMgPSBwYXRoU2VnbWVudHM7XHJcbiAgICAgICAgcmV0dXJuIHVybENvbXBvbmVudHM7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGNvbnN0cnVjdEF1dGhvcml0eVVyaUZyb21PYmplY3QodXJsT2JqZWN0OiBJVXJpKTogVXJsU3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gbmV3IFVybFN0cmluZyh1cmxPYmplY3QuUHJvdG9jb2wgKyBcIi8vXCIgKyB1cmxPYmplY3QuSG9zdE5hbWVBbmRQb3J0ICsgXCIvXCIgKyB1cmxPYmplY3QuUGF0aFNlZ21lbnRzLmpvaW4oXCIvXCIpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIHRoZSBoYXNoIG9mIHRoZSBVUkwgc3RyaW5nIGNvbnRhaW5zIGtub3duIHByb3BlcnRpZXNcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGhhc2hDb250YWluc0tub3duUHJvcGVydGllcyh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHVybCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB1cmxTdHJpbmcgPSBuZXcgVXJsU3RyaW5nKHVybCk7XHJcbiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHVybFN0cmluZy5nZXREZXNlcmlhbGl6ZWRIYXNoPFNlcnZlckF1dGhvcml6YXRpb25Db2RlUmVzcG9uc2U+KCk7XHJcbiAgICAgICAgcmV0dXJuICEhKFxyXG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmVycm9yX2Rlc2NyaXB0aW9uIHx8XHJcbiAgICAgICAgICAgIHBhcmFtZXRlcnMuZXJyb3IgfHxcclxuICAgICAgICAgICAgcGFyYW1ldGVycy5zdGF0ZVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IElDcnlwdG8gfSBmcm9tIFwiLi4vY3J5cHRvL0lDcnlwdG9cIjtcclxuaW1wb3J0IHsgU3RyaW5nVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvU3RyaW5nVXRpbHNcIjtcclxuaW1wb3J0IHsgVXJsU3RyaW5nIH0gZnJvbSBcIi4uL3VybC9VcmxTdHJpbmdcIjtcclxuXHJcbi8qKlxyXG4gKiBLZXkgdG8gY2FjaGUgYWNjZXNzIHRva2VucywgaWQgdG9rZW5zLCBhbmQgcmVmcmVzaCB0b2tlbnMuIEhlbHBzIG1hbmFnZSB0b2tlbiByZW5ld2FsLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFjY2Vzc1Rva2VuS2V5IHtcclxuXHJcbiAgICBhdXRob3JpdHk6IHN0cmluZztcclxuICAgIGNsaWVudElkOiBzdHJpbmc7XHJcbiAgICBzY29wZXM6IHN0cmluZztcclxuICAgIHJlc291cmNlOiBzdHJpbmc7XHJcbiAgICBob21lQWNjb3VudElkZW50aWZpZXI6IHN0cmluZztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhdXRob3JpdHk6IHN0cmluZywgY2xpZW50SWQ6IHN0cmluZywgc2NvcGVzOiBzdHJpbmcsIHJlc291cmNlOiBzdHJpbmcsIHVpZDogc3RyaW5nLCB1dGlkOiBzdHJpbmcsIGNyeXB0b09iajogSUNyeXB0bykge1xyXG4gICAgICAgIGNvbnN0IGF1dGhvcml0eVVyaSA9IG5ldyBVcmxTdHJpbmcoYXV0aG9yaXR5KTtcclxuICAgICAgICB0aGlzLmF1dGhvcml0eSA9IGF1dGhvcml0eVVyaS51cmxTdHJpbmc7XHJcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xyXG4gICAgICAgIHRoaXMuc2NvcGVzID0gc2NvcGVzO1xyXG4gICAgICAgIHRoaXMucmVzb3VyY2UgPSByZXNvdXJjZTtcclxuICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkodWlkKSAmJiAhU3RyaW5nVXRpbHMuaXNFbXB0eSh1dGlkKSkge1xyXG4gICAgICAgICAgICB0aGlzLmhvbWVBY2NvdW50SWRlbnRpZmllciA9IGAke2NyeXB0b09iai5iYXNlNjRFbmNvZGUodWlkKX0uJHtjcnlwdG9PYmouYmFzZTY0RW5jb2RlKHV0aWQpfWA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIFZhbHVlIG9mIGFjY2VzcyB0b2tlbiBjYWNoZSBpdGVtIHdoaWNoIGlzIHN0b3JlZCBpbiBjYWNoZS4gSGVscHMgbWFuYWdlIHRva2VuIHJlbmV3YWwuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQWNjZXNzVG9rZW5WYWx1ZSB7XHJcblxyXG4gICAgdG9rZW5UeXBlOiBzdHJpbmc7XHJcbiAgICBhY2Nlc3NUb2tlbjogc3RyaW5nO1xyXG4gICAgaWRUb2tlbjogc3RyaW5nO1xyXG4gICAgcmVmcmVzaFRva2VuOiBzdHJpbmc7XHJcbiAgICBleHBpcmVzT25TZWM6IHN0cmluZztcclxuICAgIGV4dEV4cGlyZXNPblNlYzogc3RyaW5nO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHRva2VuVHlwZTogc3RyaW5nLCBhY2Nlc3NUb2tlbjogc3RyaW5nLCBpZFRva2VuOiBzdHJpbmcsIHJlZnJlc2hUb2tlbjogc3RyaW5nLCBleHBpcmVzT246IHN0cmluZywgZXh0RXhwaXJlc09uOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLnRva2VuVHlwZSA9IHRva2VuVHlwZTtcclxuICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XHJcbiAgICAgICAgdGhpcy5pZFRva2VuID0gaWRUb2tlbjtcclxuICAgICAgICB0aGlzLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcclxuICAgICAgICB0aGlzLmV4cGlyZXNPblNlYyA9IGV4cGlyZXNPbjtcclxuICAgICAgICB0aGlzLmV4dEV4cGlyZXNPblNlYyA9IGV4dEV4cGlyZXNPbjtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQXV0aEVycm9yIH0gZnJvbSBcIi4vQXV0aEVycm9yXCI7XHJcblxyXG4vKipcclxuICogRXJyb3IgdGhyb3duIHdoZW4gdGhlcmUgaXMgYW4gZXJyb3Igd2l0aCB0aGUgc2VydmVyIGNvZGUsIGZvciBleGFtcGxlLCB1bmF2YWlsYWJpbGl0eS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBTZXJ2ZXJFcnJvciBleHRlbmRzIEF1dGhFcnJvciB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoZXJyb3JDb2RlOiBzdHJpbmcsIGVycm9yTWVzc2FnZT86IHN0cmluZykge1xyXG4gICAgICAgIHN1cGVyKGVycm9yQ29kZSwgZXJyb3JNZXNzYWdlKTtcclxuICAgICAgICB0aGlzLm5hbWUgPSBcIlNlcnZlckVycm9yXCI7XHJcblxyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBTZXJ2ZXJFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5pbXBvcnQgeyBidWlsZENsaWVudEluZm8gfSBmcm9tIFwiLi4vYXV0aC9DbGllbnRJbmZvXCI7XHJcbmltcG9ydCB7IENsaWVudEF1dGhFcnJvciB9IGZyb20gXCIuLi9lcnJvci9DbGllbnRBdXRoRXJyb3JcIjtcclxuaW1wb3J0IHsgU2VydmVyRXJyb3IgfSBmcm9tIFwiLi4vZXJyb3IvU2VydmVyRXJyb3JcIjtcclxuaW1wb3J0IHsgSUNyeXB0byB9IGZyb20gXCIuLi9jcnlwdG8vSUNyeXB0b1wiO1xyXG5cclxuLyoqXHJcbiAqIERlc2VyaWFsaXplZCByZXNwb25zZSBvYmplY3QgZnJvbSBzZXJ2ZXIgYXV0aG9yaXphdGlvbiBjb2RlIHJlcXVlc3QuXHJcbiAqIC0gY29kZTogYXV0aG9yaXphdGlvbiBjb2RlIGZyb20gc2VydmVyXHJcbiAqIC0gY2xpZW50X2luZm86IGNsaWVudCBpbmZvIG9iamVjdFxyXG4gKiAtIHN0YXRlOiBPQXV0aDIgcmVxdWVzdCBzdGF0ZVxyXG4gKiAtIGVycm9yOiBlcnJvciBzZW50IGJhY2sgaW4gaGFzaFxyXG4gKiAtIGVycm9yOiBkZXNjcmlwdGlvblxyXG4gKi9cclxuZXhwb3J0IHR5cGUgU2VydmVyQXV0aG9yaXphdGlvbkNvZGVSZXNwb25zZSA9IHtcclxuICAgIGNvZGU/OiBzdHJpbmc7XHJcbiAgICBjbGllbnRfaW5mbz86IHN0cmluZztcclxuICAgIHN0YXRlPzogc3RyaW5nO1xyXG4gICAgZXJyb3I/OiBzdHJpbmcsXHJcbiAgICBlcnJvcl9kZXNjcmlwdGlvbj86IHN0cmluZztcclxufTtcclxuXHJcbi8qKlxyXG4gKiBGdW5jdGlvbiB3aGljaCB2YWxpZGF0ZXMgc2VydmVyIGF1dGhvcml6YXRpb24gY29kZSByZXNwb25zZS5cclxuICogQHBhcmFtIHNlcnZlclJlc3BvbnNlSGFzaCBcclxuICogQHBhcmFtIGNhY2hlZFN0YXRlIFxyXG4gKiBAcGFyYW0gY3J5cHRvT2JqIFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlU2VydmVyQXV0aG9yaXphdGlvbkNvZGVSZXNwb25zZShzZXJ2ZXJSZXNwb25zZUhhc2g6IFNlcnZlckF1dGhvcml6YXRpb25Db2RlUmVzcG9uc2UsIGNhY2hlZFN0YXRlOiBzdHJpbmcsIGNyeXB0b09iajogSUNyeXB0byk6IHZvaWQge1xyXG4gICAgaWYgKHNlcnZlclJlc3BvbnNlSGFzaC5zdGF0ZSAhPT0gY2FjaGVkU3RhdGUpIHtcclxuICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlU3RhdGVNaXNtYXRjaEVycm9yKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIGVycm9yXHJcbiAgICBpZiAoc2VydmVyUmVzcG9uc2VIYXNoLmVycm9yIHx8IHNlcnZlclJlc3BvbnNlSGFzaC5lcnJvcl9kZXNjcmlwdGlvbikge1xyXG4gICAgICAgIHRocm93IG5ldyBTZXJ2ZXJFcnJvcihzZXJ2ZXJSZXNwb25zZUhhc2guZXJyb3IsIHNlcnZlclJlc3BvbnNlSGFzaC5lcnJvcl9kZXNjcmlwdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNlcnZlclJlc3BvbnNlSGFzaC5jbGllbnRfaW5mbykge1xyXG4gICAgICAgIGJ1aWxkQ2xpZW50SW5mbyhzZXJ2ZXJSZXNwb25zZUhhc2guY2xpZW50X2luZm8sIGNyeXB0b09iaik7XHJcbiAgICB9XHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IElkVG9rZW4gfSBmcm9tIFwiLi4vYXV0aC9JZFRva2VuXCI7XHJcbmltcG9ydCB7IENhY2hlSGVscGVycyB9IGZyb20gXCIuLi9jYWNoZS9DYWNoZUhlbHBlcnNcIjtcclxuaW1wb3J0IHsgU2VydmVyQXV0aG9yaXphdGlvblRva2VuUmVzcG9uc2UgfSBmcm9tIFwiLi4vc2VydmVyL1NlcnZlckF1dGhvcml6YXRpb25Ub2tlblJlc3BvbnNlXCI7XHJcbmltcG9ydCB7IFNjb3BlU2V0IH0gZnJvbSBcIi4uL2F1dGgvU2NvcGVTZXRcIjtcclxuaW1wb3J0IHsgYnVpbGRDbGllbnRJbmZvLCBDbGllbnRJbmZvIH0gZnJvbSBcIi4uL2F1dGgvQ2xpZW50SW5mb1wiO1xyXG5pbXBvcnQgeyBBY2NvdW50IH0gZnJvbSBcIi4uL2F1dGgvQWNjb3VudFwiO1xyXG5pbXBvcnQgeyBQcm90b2NvbFV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL1Byb3RvY29sVXRpbHNcIjtcclxuaW1wb3J0IHsgSUNyeXB0byB9IGZyb20gXCIuLi9jcnlwdG8vSUNyeXB0b1wiO1xyXG5pbXBvcnQgeyBJQ2FjaGVTdG9yYWdlIH0gZnJvbSBcIi4uL2NhY2hlL0lDYWNoZVN0b3JhZ2VcIjtcclxuaW1wb3J0IHsgVG9rZW5SZXNwb25zZSB9IGZyb20gXCIuL1Rva2VuUmVzcG9uc2VcIjtcclxuaW1wb3J0IHsgUGVyc2lzdGVudENhY2hlS2V5cywgVGVtcG9yYXJ5Q2FjaGVLZXlzIH0gZnJvbSBcIi4uL3V0aWxzL0NvbnN0YW50c1wiO1xyXG5pbXBvcnQgeyBDbGllbnRBdXRoRXJyb3IgfSBmcm9tIFwiLi4vZXJyb3IvQ2xpZW50QXV0aEVycm9yXCI7XHJcbmltcG9ydCB7IFRpbWVVdGlscyB9IGZyb20gXCIuLi91dGlscy9UaW1lVXRpbHNcIjtcclxuaW1wb3J0IHsgQWNjZXNzVG9rZW5LZXkgfSBmcm9tIFwiLi4vY2FjaGUvQWNjZXNzVG9rZW5LZXlcIjtcclxuaW1wb3J0IHsgQWNjZXNzVG9rZW5WYWx1ZSB9IGZyb20gXCIuLi9jYWNoZS9BY2Nlc3NUb2tlblZhbHVlXCI7XHJcbmltcG9ydCB7IFN0cmluZ1V0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL1N0cmluZ1V0aWxzXCI7XHJcbmltcG9ydCB7IFNlcnZlckF1dGhvcml6YXRpb25Db2RlUmVzcG9uc2UsIHZhbGlkYXRlU2VydmVyQXV0aG9yaXphdGlvbkNvZGVSZXNwb25zZSB9IGZyb20gXCIuLi9zZXJ2ZXIvU2VydmVyQXV0aG9yaXphdGlvbkNvZGVSZXNwb25zZVwiO1xyXG5pbXBvcnQgeyBDb2RlUmVzcG9uc2UgfSBmcm9tIFwiLi9Db2RlUmVzcG9uc2VcIjtcclxuaW1wb3J0IHsgTG9nZ2VyIH0gZnJvbSBcIi4uL2xvZ2dlci9Mb2dnZXJcIjtcclxuXHJcbi8qKlxyXG4gKiBDbGFzcyB0aGF0IGhhbmRsZXMgcmVzcG9uc2UgcGFyc2luZy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSZXNwb25zZUhhbmRsZXIge1xyXG4gICAgcHJpdmF0ZSBjbGllbnRJZDogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSBjYWNoZVN0b3JhZ2U6IElDYWNoZVN0b3JhZ2U7XHJcbiAgICBwcml2YXRlIGNhY2hlTWFuYWdlcjogQ2FjaGVIZWxwZXJzO1xyXG4gICAgcHJpdmF0ZSBjcnlwdG9PYmo6IElDcnlwdG87XHJcbiAgICBwcml2YXRlIGxvZ2dlcjogTG9nZ2VyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNsaWVudElkOiBzdHJpbmcsIGNhY2hlU3RvcmFnZTogSUNhY2hlU3RvcmFnZSwgY2FjaGVNYW5hZ2VyOiBDYWNoZUhlbHBlcnMsIGNyeXB0b09iajogSUNyeXB0bywgbG9nZ2VyOiBMb2dnZXIpIHtcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UgPSBjYWNoZVN0b3JhZ2U7XHJcbiAgICAgICAgdGhpcy5jYWNoZU1hbmFnZXIgPSBjYWNoZU1hbmFnZXI7XHJcbiAgICAgICAgdGhpcy5jcnlwdG9PYmogPSBjcnlwdG9PYmo7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIgPSBsb2dnZXI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgbmV3IHJlc3BvbnNlIHdpdGggdGhlIGRhdGEgZnJvbSBvcmlnaW5hbCByZXNwb25zZSBmaWxsZWQgd2l0aCB0aGUgcmVsZXZhbnQgSWRUb2tlbiBkYXRhLlxyXG4gICAgICogLSByYXcgaWQgdG9rZW5cclxuICAgICAqIC0gaWQgdG9rZW4gY2xhaW1zXHJcbiAgICAgKiAtIHVuaXF1ZSBpZCAob2lkIG9yIHN1YiBjbGFpbSBvZiB0b2tlbilcclxuICAgICAqIC0gdGVuYW50IGlkICh0aWQgY2xhaW0gb2YgdG9rZW4pXHJcbiAgICAgKiBAcGFyYW0gb3JpZ2luYWxSZXNwb25zZSBcclxuICAgICAqIEBwYXJhbSBpZFRva2VuT2JqIFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgc2V0UmVzcG9uc2VJZFRva2VuKG9yaWdpbmFsUmVzcG9uc2U6IFRva2VuUmVzcG9uc2UsIGlkVG9rZW5PYmo6IElkVG9rZW4pIDogVG9rZW5SZXNwb25zZSB7XHJcbiAgICAgICAgaWYgKCFvcmlnaW5hbFJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIWlkVG9rZW5PYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsUmVzcG9uc2U7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgY29uc3QgZXhwaXJlc1NlY29uZHMgPSBOdW1iZXIoaWRUb2tlbk9iai5jbGFpbXMuZXhwKTtcclxuICAgICAgICBpZiAoZXhwaXJlc1NlY29uZHMgJiYgIW9yaWdpbmFsUmVzcG9uc2UuZXhwaXJlc09uKSB7XHJcbiAgICAgICAgICAgIG9yaWdpbmFsUmVzcG9uc2UuZXhwaXJlc09uID0gbmV3IERhdGUoZXhwaXJlc1NlY29uZHMgKiAxMDAwKTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAuLi5vcmlnaW5hbFJlc3BvbnNlLFxyXG4gICAgICAgICAgICBpZFRva2VuOiBpZFRva2VuT2JqLnJhd0lkVG9rZW4sXHJcbiAgICAgICAgICAgIGlkVG9rZW5DbGFpbXM6IGlkVG9rZW5PYmouY2xhaW1zLFxyXG4gICAgICAgICAgICB1bmlxdWVJZDogaWRUb2tlbk9iai5jbGFpbXMub2lkIHx8IGlkVG9rZW5PYmouY2xhaW1zLnN1YixcclxuICAgICAgICAgICAgdGVuYW50SWQ6IGlkVG9rZW5PYmouY2xhaW1zLnRpZCxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVmFsaWRhdGVzIGFuZCBoYW5kbGVzIGEgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyLCBhbmQgcmV0dXJucyBhIGNvbnN0cnVjdGVkIG9iamVjdCB3aXRoIHRoZSBhdXRob3JpemF0aW9uIGNvZGUgYW5kIHN0YXRlLlxyXG4gICAgICogQHBhcmFtIHNlcnZlclBhcmFtcyBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGhhbmRsZVNlcnZlckNvZGVSZXNwb25zZShzZXJ2ZXJQYXJhbXM6IFNlcnZlckF1dGhvcml6YXRpb25Db2RlUmVzcG9uc2UpOiBDb2RlUmVzcG9uc2Uge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGhhc2ggZnJhZ21lbnQgcmVzcG9uc2UgcGFyYW1ldGVyc1xyXG4gICAgICAgICAgICB2YWxpZGF0ZVNlcnZlckF1dGhvcml6YXRpb25Db2RlUmVzcG9uc2Uoc2VydmVyUGFyYW1zLCB0aGlzLmNhY2hlU3RvcmFnZS5nZXRJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5SRVFVRVNUX1NUQVRFKSwgdGhpcy5jcnlwdG9PYmopO1xyXG5cclxuICAgICAgICAgICAgLy8gQ2FjaGUgY2xpZW50IGluZm9cclxuICAgICAgICAgICAgaWYgKHNlcnZlclBhcmFtcy5jbGllbnRfaW5mbykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShQZXJzaXN0ZW50Q2FjaGVLZXlzLkNMSUVOVF9JTkZPLCBzZXJ2ZXJQYXJhbXMuY2xpZW50X2luZm8pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgcmVzcG9uc2Ugb2JqZWN0XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlOiBDb2RlUmVzcG9uc2UgPSB7XHJcbiAgICAgICAgICAgICAgICBjb2RlOiBzZXJ2ZXJQYXJhbXMuY29kZSxcclxuICAgICAgICAgICAgICAgIHVzZXJSZXF1ZXN0U3RhdGU6IHNlcnZlclBhcmFtcy5zdGF0ZVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhY2hlTWFuYWdlci5yZXNldFRlbXBDYWNoZUl0ZW1zKHNlcnZlclBhcmFtcyAmJiBzZXJ2ZXJQYXJhbXMuc3RhdGUpO1xyXG4gICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciBmdW5jdGlvbiB3aGljaCBzYXZlcyBvciB1cGRhdGVzIHRoZSB0b2tlbiBpbiB0aGUgY2FjaGUgYW5kIGNvbnN0cnVjdHMgdGhlIGZpbmFsIHRva2VuIHJlc3BvbnNlIHRvIHNlbmQgYmFjayB0byB0aGUgdXNlci5cclxuICAgICAqIEBwYXJhbSBvcmlnaW5hbFRva2VuUmVzcG9uc2UgXHJcbiAgICAgKiBAcGFyYW0gYXV0aG9yaXR5IFxyXG4gICAgICogQHBhcmFtIHJlc291cmNlIFxyXG4gICAgICogQHBhcmFtIHNlcnZlclRva2VuUmVzcG9uc2UgXHJcbiAgICAgKiBAcGFyYW0gY2xpZW50SW5mbyBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzYXZlVG9rZW4ob3JpZ2luYWxUb2tlblJlc3BvbnNlOiBUb2tlblJlc3BvbnNlLCBhdXRob3JpdHk6IHN0cmluZywgcmVzb3VyY2U6IHN0cmluZywgc2VydmVyVG9rZW5SZXNwb25zZTogU2VydmVyQXV0aG9yaXphdGlvblRva2VuUmVzcG9uc2UsIGNsaWVudEluZm86IENsaWVudEluZm8pOiBUb2tlblJlc3BvbnNlIHtcclxuICAgICAgICAvLyBTZXQgY29uc2VudGVkIHNjb3BlcyBpbiByZXNwb25zZVxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlU2NvcGVzID0gU2NvcGVTZXQuZnJvbVN0cmluZyhzZXJ2ZXJUb2tlblJlc3BvbnNlLnNjb3BlLCB0aGlzLmNsaWVudElkLCB0cnVlKTtcclxuICAgICAgICBjb25zdCByZXNwb25zZVNjb3BlQXJyYXkgPSByZXNwb25zZVNjb3Blcy5hc0FycmF5KCk7XHJcblxyXG4gICAgICAgIC8vIEV4cGlyYXRpb24gY2FsY3VsYXRpb25cclxuICAgICAgICBjb25zdCBleHBpcmVzSW4gPSBUaW1lVXRpbHMucGFyc2VFeHBpcmVzSW5TZWNvbmRzKHNlcnZlclRva2VuUmVzcG9uc2UuZXhwaXJlc19pbik7XHJcbiAgICAgICAgY29uc3QgZXhwaXJhdGlvblNlYyA9IFRpbWVVdGlscy5ub3dTZWNvbmRzKCkgKyBleHBpcmVzSW47XHJcbiAgICAgICAgY29uc3QgZXh0ZW5kZWRFeHBpcmF0aW9uU2VjID0gZXhwaXJhdGlvblNlYyArIFRpbWVVdGlscy5wYXJzZUV4cGlyZXNJblNlY29uZHMoc2VydmVyVG9rZW5SZXNwb25zZS5leHRfZXhwaXJlc19pbik7XHJcblxyXG4gICAgICAgIC8vIEdldCBpZCB0b2tlblxyXG4gICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShvcmlnaW5hbFRva2VuUmVzcG9uc2UuaWRUb2tlbikpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShQZXJzaXN0ZW50Q2FjaGVLZXlzLklEX1RPS0VOLCBvcmlnaW5hbFRva2VuUmVzcG9uc2UuaWRUb2tlbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTYXZlIGFjY2VzcyB0b2tlbiBpbiBjYWNoZVxyXG4gICAgICAgIGNvbnN0IG5ld0FjY2Vzc1Rva2VuVmFsdWUgPSBuZXcgQWNjZXNzVG9rZW5WYWx1ZShzZXJ2ZXJUb2tlblJlc3BvbnNlLnRva2VuX3R5cGUsIHNlcnZlclRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuLCBvcmlnaW5hbFRva2VuUmVzcG9uc2UuaWRUb2tlbiwgc2VydmVyVG9rZW5SZXNwb25zZS5yZWZyZXNoX3Rva2VuLCBleHBpcmF0aW9uU2VjLnRvU3RyaW5nKCksIGV4dGVuZGVkRXhwaXJhdGlvblNlYy50b1N0cmluZygpKTtcclxuICAgICAgICBjb25zdCBob21lQWNjb3VudElkZW50aWZpZXIgPSBvcmlnaW5hbFRva2VuUmVzcG9uc2UuYWNjb3VudCAmJiBvcmlnaW5hbFRva2VuUmVzcG9uc2UuYWNjb3VudC5ob21lQWNjb3VudElkZW50aWZpZXI7XHJcbiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW5DYWNoZUl0ZW1zID0gdGhpcy5jYWNoZU1hbmFnZXIuZ2V0QWxsQWNjZXNzVG9rZW5zKHRoaXMuY2xpZW50SWQsIGF1dGhvcml0eSB8fCBcIlwiLCByZXNvdXJjZSB8fCBcIlwiLCBob21lQWNjb3VudElkZW50aWZpZXIgfHwgXCJcIik7XHJcblxyXG4gICAgICAgIC8vIElmIG5vIGl0ZW1zIGluIGNhY2hlIHdpdGggdGhlc2UgcGFyYW1ldGVycywgc2V0IG5ldyBpdGVtLlxyXG4gICAgICAgIGlmIChhY2Nlc3NUb2tlbkNhY2hlSXRlbXMubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKFwiTm8gdG9rZW5zIGZvdW5kLCBjcmVhdGluZyBuZXcgaXRlbS5cIik7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1Rva2VuS2V5ID0gbmV3IEFjY2Vzc1Rva2VuS2V5KFxyXG4gICAgICAgICAgICAgICAgYXV0aG9yaXR5LCBcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xpZW50SWQsIFxyXG4gICAgICAgICAgICAgICAgc2VydmVyVG9rZW5SZXNwb25zZS5zY29wZSwgXHJcbiAgICAgICAgICAgICAgICByZXNvdXJjZSwgXHJcbiAgICAgICAgICAgICAgICBjbGllbnRJbmZvICYmIGNsaWVudEluZm8udWlkLCBcclxuICAgICAgICAgICAgICAgIGNsaWVudEluZm8gJiYgY2xpZW50SW5mby51dGlkLCBcclxuICAgICAgICAgICAgICAgIHRoaXMuY3J5cHRvT2JqXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnNldEl0ZW0oSlNPTi5zdHJpbmdpZnkobmV3VG9rZW5LZXkpLCBKU09OLnN0cmluZ2lmeShuZXdBY2Nlc3NUb2tlblZhbHVlKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgc2NvcGVzIGFyZSBpbnRlcnNlY3RpbmcuIElmIHRoZXkgYXJlLCBjb21iaW5lIHNjb3BlcyBhbmQgcmVwbGFjZSBjYWNoZSBpdGVtLlxyXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbkNhY2hlSXRlbXMuZm9yRWFjaChhY2Nlc3NUb2tlbkNhY2hlSXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYWNoZWRTY29wZXMgPSBTY29wZVNldC5mcm9tU3RyaW5nKGFjY2Vzc1Rva2VuQ2FjaGVJdGVtLmtleS5zY29wZXMsIHRoaXMuY2xpZW50SWQsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgaWYoY2FjaGVkU2NvcGVzLmludGVyc2VjdGluZ1Njb3BlU2V0cyhyZXNwb25zZVNjb3BlcykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKEpTT04uc3RyaW5naWZ5KGFjY2Vzc1Rva2VuQ2FjaGVJdGVtLmtleSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlZFNjb3Blcy5hcHBlbmRTY29wZXMocmVzcG9uc2VTY29wZUFycmF5KTtcclxuICAgICAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbkNhY2hlSXRlbS5rZXkuc2NvcGVzID0gY2FjaGVkU2NvcGVzLnByaW50U2NvcGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkobmV3QWNjZXNzVG9rZW5WYWx1ZS5pZFRva2VuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdBY2Nlc3NUb2tlblZhbHVlLmlkVG9rZW4gPSBhY2Nlc3NUb2tlbkNhY2hlSXRlbS52YWx1ZS5pZFRva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKEpTT04uc3RyaW5naWZ5KGFjY2Vzc1Rva2VuQ2FjaGVJdGVtLmtleSksIEpTT04uc3RyaW5naWZ5KG5ld0FjY2Vzc1Rva2VuVmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTYXZlIHRva2VucyBpbiByZXNwb25zZSBhbmQgcmV0dXJuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgLi4ub3JpZ2luYWxUb2tlblJlc3BvbnNlLFxyXG4gICAgICAgICAgICBzY29wZXM6IHJlc3BvbnNlU2NvcGVBcnJheSxcclxuICAgICAgICAgICAgYWNjZXNzVG9rZW46IHNlcnZlclRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuLFxyXG4gICAgICAgICAgICByZWZyZXNoVG9rZW46IHNlcnZlclRva2VuUmVzcG9uc2UucmVmcmVzaF90b2tlbixcclxuICAgICAgICAgICAgZXhwaXJlc09uOiBuZXcgRGF0ZShleHBpcmF0aW9uU2VjICogMTAwMClcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyBhY2NvdW50IGNhY2hlZCB3aXRoIGdpdmVuIGtleS4gUmV0dXJucyBudWxsIGlmIHBhcnNpbmcgY291bGQgbm90IGJlIGNvbXBsZXRlZC5cclxuICAgICAqIEBwYXJhbSBhY2NvdW50S2V5IFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldENhY2hlZEFjY291bnQoYWNjb3VudEtleTogc3RyaW5nKTogQWNjb3VudCB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodGhpcy5jYWNoZVN0b3JhZ2UuZ2V0SXRlbShhY2NvdW50S2V5KSkgYXMgQWNjb3VudDtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm5pbmcoYEFjY291bnQgY291bGQgbm90IGJlIHBhcnNlZDogJHtKU09OLnN0cmluZ2lmeShlKX1gKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIGNvbnN0cnVjdGVkIHRva2VuIHJlc3BvbnNlIGJhc2VkIG9uIGdpdmVuIHN0cmluZy4gQWxzbyBtYW5hZ2VzIHRoZSBjYWNoZSB1cGRhdGVzIGFuZCBjbGVhbnVwcy5cclxuICAgICAqIEBwYXJhbSBzZXJ2ZXJUb2tlblJlc3BvbnNlIFxyXG4gICAgICogQHBhcmFtIGF1dGhvcml0eVN0cmluZyBcclxuICAgICAqIEBwYXJhbSByZXNvdXJjZSBcclxuICAgICAqIEBwYXJhbSBzdGF0ZSBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNyZWF0ZVRva2VuUmVzcG9uc2Uoc2VydmVyVG9rZW5SZXNwb25zZTogU2VydmVyQXV0aG9yaXphdGlvblRva2VuUmVzcG9uc2UsIGF1dGhvcml0eVN0cmluZzogc3RyaW5nLCByZXNvdXJjZTogc3RyaW5nLCBzdGF0ZT86IHN0cmluZyk6IFRva2VuUmVzcG9uc2Uge1xyXG4gICAgICAgIGxldCB0b2tlblJlc3BvbnNlOiBUb2tlblJlc3BvbnNlID0ge1xyXG4gICAgICAgICAgICB1bmlxdWVJZDogXCJcIixcclxuICAgICAgICAgICAgdGVuYW50SWQ6IFwiXCIsXHJcbiAgICAgICAgICAgIHRva2VuVHlwZTogXCJcIixcclxuICAgICAgICAgICAgaWRUb2tlbjogbnVsbCxcclxuICAgICAgICAgICAgaWRUb2tlbkNsYWltczogbnVsbCxcclxuICAgICAgICAgICAgYWNjZXNzVG9rZW46IFwiXCIsXHJcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogXCJcIixcclxuICAgICAgICAgICAgc2NvcGVzOiBbXSxcclxuICAgICAgICAgICAgZXhwaXJlc09uOiBudWxsLFxyXG4gICAgICAgICAgICBhY2NvdW50OiBudWxsLFxyXG4gICAgICAgICAgICB1c2VyUmVxdWVzdFN0YXRlOiBcIlwiXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gUmV0cmlldmUgY3VycmVudCBpZCB0b2tlbiBvYmplY3RcclxuICAgICAgICBsZXQgaWRUb2tlbk9iajogSWRUb2tlbjtcclxuICAgICAgICBjb25zdCBjYWNoZWRJZFRva2VuOiBzdHJpbmcgPSB0aGlzLmNhY2hlU3RvcmFnZS5nZXRJdGVtKFBlcnNpc3RlbnRDYWNoZUtleXMuSURfVE9LRU4pO1xyXG4gICAgICAgIGlmIChzZXJ2ZXJUb2tlblJlc3BvbnNlLmlkX3Rva2VuKSB7XHJcbiAgICAgICAgICAgIGlkVG9rZW5PYmogPSBuZXcgSWRUb2tlbihzZXJ2ZXJUb2tlblJlc3BvbnNlLmlkX3Rva2VuLCB0aGlzLmNyeXB0b09iaik7XHJcbiAgICAgICAgICAgIHRva2VuUmVzcG9uc2UgPSBSZXNwb25zZUhhbmRsZXIuc2V0UmVzcG9uc2VJZFRva2VuKHRva2VuUmVzcG9uc2UsIGlkVG9rZW5PYmopO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY2FjaGVkSWRUb2tlbikge1xyXG4gICAgICAgICAgICBpZFRva2VuT2JqID0gbmV3IElkVG9rZW4oY2FjaGVkSWRUb2tlbiwgdGhpcy5jcnlwdG9PYmopO1xyXG4gICAgICAgICAgICB0b2tlblJlc3BvbnNlID0gUmVzcG9uc2VIYW5kbGVyLnNldFJlc3BvbnNlSWRUb2tlbih0b2tlblJlc3BvbnNlLCBpZFRva2VuT2JqKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZFRva2VuT2JqID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBjbGllbnRJbmZvOiBDbGllbnRJbmZvID0gbnVsbDtcclxuICAgICAgICBsZXQgY2FjaGVkQWNjb3VudDogQWNjb3VudCA9IG51bGw7XHJcbiAgICAgICAgaWYgKGlkVG9rZW5PYmopIHtcclxuICAgICAgICAgICAgLy8gSWYgc3RhdGUgaXMgZW1wdHksIHJlZnJlc2ggdG9rZW4gaXMgYmVpbmcgdXNlZFxyXG4gICAgICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoc3RhdGUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKFwiU3RhdGUgd2FzIGRldGVjdGVkIC0gbm9uY2Ugc2hvdWxkIGJlIGF2YWlsYWJsZS5cIik7XHJcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBub25jZSBpbnRlZ3JpdHkgaWYgcmVmcmVzaCB0b2tlbiBpcyBub3QgdXNlZCAtIHRocm93IGFuIGVycm9yIGlmIG5vdCBtYXRjaGVkICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmICghaWRUb2tlbk9iai5jbGFpbXMubm9uY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlSW52YWxpZElkVG9rZW5FcnJvcihpZFRva2VuT2JqKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBub25jZSA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0odGhpcy5jYWNoZU1hbmFnZXIuZ2VuZXJhdGVOb25jZUtleShzdGF0ZSkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlkVG9rZW5PYmouY2xhaW1zLm5vbmNlICE9PSBub25jZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IENsaWVudEF1dGhFcnJvci5jcmVhdGVOb25jZU1pc21hdGNoRXJyb3IoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gUmV0cmlldmUgY2xpZW50IGluZm9cclxuICAgICAgICAgICAgY2xpZW50SW5mbyA9IGJ1aWxkQ2xpZW50SW5mbyh0aGlzLmNhY2hlU3RvcmFnZS5nZXRJdGVtKFBlcnNpc3RlbnRDYWNoZUtleXMuQ0xJRU5UX0lORk8pLCB0aGlzLmNyeXB0b09iaik7XHJcblxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgYWNjb3VudCBvYmplY3QgZm9yIHJlcXVlc3RcclxuICAgICAgICAgICAgdG9rZW5SZXNwb25zZS5hY2NvdW50ID0gQWNjb3VudC5jcmVhdGVBY2NvdW50KGlkVG9rZW5PYmosIGNsaWVudEluZm8sIHRoaXMuY3J5cHRvT2JqKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFNhdmUgdGhlIGFjY2VzcyB0b2tlbiBpZiBpdCBleGlzdHNcclxuICAgICAgICAgICAgY29uc3QgYWNjb3VudEtleSA9IHRoaXMuY2FjaGVNYW5hZ2VyLmdlbmVyYXRlQWNxdWlyZVRva2VuQWNjb3VudEtleSh0b2tlblJlc3BvbnNlLmFjY291bnQuaG9tZUFjY291bnRJZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEdldCBjYWNoZWQgYWNjb3VudFxyXG4gICAgICAgICAgICBjYWNoZWRBY2NvdW50ID0gdGhpcy5nZXRDYWNoZWRBY2NvdW50KGFjY291bnRLZXkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUmV0dXJuIHVzZXIgc2V0IHN0YXRlIGluIHRoZSByZXNwb25zZVxyXG4gICAgICAgIHRva2VuUmVzcG9uc2UudXNlclJlcXVlc3RTdGF0ZSA9IFByb3RvY29sVXRpbHMuZ2V0VXNlclJlcXVlc3RTdGF0ZShzdGF0ZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2FjaGVNYW5hZ2VyLnJlc2V0VGVtcENhY2hlSXRlbXMoc3RhdGUpO1xyXG4gICAgICAgIGlmICghY2FjaGVkQWNjb3VudCB8fCAhdG9rZW5SZXNwb25zZS5hY2NvdW50IHx8IEFjY291bnQuY29tcGFyZUFjY291bnRzKGNhY2hlZEFjY291bnQsIHRva2VuUmVzcG9uc2UuYWNjb3VudCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZVRva2VuKHRva2VuUmVzcG9uc2UsIGF1dGhvcml0eVN0cmluZywgcmVzb3VyY2UsIHNlcnZlclRva2VuUmVzcG9uc2UsIGNsaWVudEluZm8pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFwiQWNjb3VudHMgZG8gbm90IG1hdGNoLlwiKTtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3JQaWkoYENhY2hlZCBBY2NvdW50OiAke0pTT04uc3RyaW5naWZ5KGNhY2hlZEFjY291bnQpfSwgTmV3IEFjY291bnQ6ICR7SlNPTi5zdHJpbmdpZnkodG9rZW5SZXNwb25zZS5hY2NvdW50KX1gKTtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUFjY291bnRNaXNtYXRjaEVycm9yKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5pbXBvcnQgeyBTZXJ2ZXJFcnJvciB9IGZyb20gXCIuLi9lcnJvci9TZXJ2ZXJFcnJvclwiO1xyXG5cclxuLyoqXHJcbiAqIERlc2VyaWFsaXplZCByZXNwb25zZSBvYmplY3QgZnJvbSBzZXJ2ZXIgYXV0aG9yaXphdGlvbiBjb2RlIHJlcXVlc3QuXHJcbiAqIC0gdG9rZW5fdHlwZTogSW5kaWNhdGVzIHRoZSB0b2tlbiB0eXBlIHZhbHVlLiBUaGUgb25seSB0eXBlIHRoYXQgQXp1cmUgQUQgc3VwcG9ydHMgaXMgQmVhcmVyLlxyXG4gKiAtIHNjb3BlOiBUaGUgc2NvcGVzIHRoYXQgdGhlIGFjY2Vzc190b2tlbiBpcyB2YWxpZCBmb3IuXHJcbiAqIC0gZXhwaXJlc19pbjogSG93IGxvbmcgdGhlIGFjY2VzcyB0b2tlbiBpcyB2YWxpZCAoaW4gc2Vjb25kcykuXHJcbiAqIC0gZXh0X2V4cGlyZXNfaW46IEhvdyBsb25nIHRoZSBhY2Nlc3MgdG9rZW4gaXMgdmFsaWQgKGluIHNlY29uZHMpIGlmIHRoZSBzZXJ2ZXIgaXNuJ3QgcmVzcG9uZGluZy5cclxuICogLSBhY2Nlc3NfdG9rZW46IFRoZSByZXF1ZXN0ZWQgYWNjZXNzIHRva2VuLiBUaGUgYXBwIGNhbiB1c2UgdGhpcyB0b2tlbiB0byBhdXRoZW50aWNhdGUgdG8gdGhlIHNlY3VyZWQgcmVzb3VyY2UsIHN1Y2ggYXMgYSB3ZWIgQVBJLlxyXG4gKiAtIHJlZnJlc2hfdG9rZW46IEFuIE9BdXRoIDIuMCByZWZyZXNoIHRva2VuLiBUaGUgYXBwIGNhbiB1c2UgdGhpcyB0b2tlbiBhY3F1aXJlIGFkZGl0aW9uYWwgYWNjZXNzIHRva2VucyBhZnRlciB0aGUgY3VycmVudCBhY2Nlc3MgdG9rZW4gZXhwaXJlcy5cclxuICogLSBpZF90b2tlbjogQSBKU09OIFdlYiBUb2tlbiAoSldUKS4gVGhlIGFwcCBjYW4gZGVjb2RlIHRoZSBzZWdtZW50cyBvZiB0aGlzIHRva2VuIHRvIHJlcXVlc3QgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIgd2hvIHNpZ25lZCBpbi5cclxuICogXHJcbiAqIEluIGNhc2Ugb2YgZXJyb3I6XHJcbiAqIC0gZXJyb3I6IEFuIGVycm9yIGNvZGUgc3RyaW5nIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2xhc3NpZnkgdHlwZXMgb2YgZXJyb3JzIHRoYXQgb2NjdXIsIGFuZCBjYW4gYmUgdXNlZCB0byByZWFjdCB0byBlcnJvcnMuXHJcbiAqIC0gZXJyb3JfZGVzY3JpcHRpb246IEEgc3BlY2lmaWMgZXJyb3IgbWVzc2FnZSB0aGF0IGNhbiBoZWxwIGEgZGV2ZWxvcGVyIGlkZW50aWZ5IHRoZSByb290IGNhdXNlIG9mIGFuIGF1dGhlbnRpY2F0aW9uIGVycm9yLlxyXG4gKiAtIGVycm9yX2NvZGVzOiBBIGxpc3Qgb2YgU1RTLXNwZWNpZmljIGVycm9yIGNvZGVzIHRoYXQgY2FuIGhlbHAgaW4gZGlhZ25vc3RpY3MuXHJcbiAqIC0gdGltZXN0YW1wOiBUaGUgdGltZSBhdCB3aGljaCB0aGUgZXJyb3Igb2NjdXJyZWQuXHJcbiAqIC0gdHJhY2VfaWQ6IEEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSByZXF1ZXN0IHRoYXQgY2FuIGhlbHAgaW4gZGlhZ25vc3RpY3MuXHJcbiAqIC0gY29ycmVsYXRpb25faWQ6IEEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSByZXF1ZXN0IHRoYXQgY2FuIGhlbHAgaW4gZGlhZ25vc3RpY3MgYWNyb3NzIGNvbXBvbmVudHMuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBTZXJ2ZXJBdXRob3JpemF0aW9uVG9rZW5SZXNwb25zZSA9IHtcclxuICAgIC8vIFN1Y2Nlc3NcclxuICAgIHRva2VuX3R5cGU/OiBzdHJpbmc7XHJcbiAgICBzY29wZT86IHN0cmluZztcclxuICAgIGV4cGlyZXNfaW4/OiBudW1iZXI7XHJcbiAgICBleHRfZXhwaXJlc19pbj86IG51bWJlcjtcclxuICAgIGFjY2Vzc190b2tlbj86IHN0cmluZztcclxuICAgIHJlZnJlc2hfdG9rZW4/OiBzdHJpbmc7XHJcbiAgICBpZF90b2tlbj86IHN0cmluZztcclxuICAgIC8vIEVycm9yXHJcbiAgICBlcnJvcj86IHN0cmluZztcclxuICAgIGVycm9yX2Rlc2NyaXB0aW9uPzogc3RyaW5nO1xyXG4gICAgZXJyb3JfY29kZXM/OiBBcnJheTxzdHJpbmc+O1xyXG4gICAgdGltZXN0YW1wPzogc3RyaW5nO1xyXG4gICAgdHJhY2VfaWQ/OiBzdHJpbmc7XHJcbiAgICBjb3JyZWxhdGlvbl9pZD86IHN0cmluZztcclxufTtcclxuXHJcbi8qKlxyXG4gKiBGdW5jdGlvbiB3aGljaCB2YWxpZGF0ZXMgc2VydmVyIGF1dGhvcml6YXRpb24gdG9rZW4gcmVzcG9uc2UuXHJcbiAqIEBwYXJhbSBzZXJ2ZXJSZXNwb25zZSBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVNlcnZlckF1dGhvcml6YXRpb25Ub2tlblJlc3BvbnNlKHNlcnZlclJlc3BvbnNlOiBTZXJ2ZXJBdXRob3JpemF0aW9uVG9rZW5SZXNwb25zZSk6IHZvaWQge1xyXG4gICAgLy8gQ2hlY2sgZm9yIGVycm9yXHJcbiAgICBpZiAoc2VydmVyUmVzcG9uc2UuZXJyb3IgfHwgc2VydmVyUmVzcG9uc2UuZXJyb3JfZGVzY3JpcHRpb24pIHtcclxuICAgICAgICBjb25zdCBlcnJTdHJpbmcgPSBgJHtzZXJ2ZXJSZXNwb25zZS5lcnJvcl9jb2Rlc30gLSBbJHtzZXJ2ZXJSZXNwb25zZS50aW1lc3RhbXB9XTogJHtzZXJ2ZXJSZXNwb25zZS5lcnJvcl9kZXNjcmlwdGlvbn0gLSBDb3JyZWxhdGlvbiBJRDogJHtzZXJ2ZXJSZXNwb25zZS5jb3JyZWxhdGlvbl9pZH0gLSBUcmFjZSBJRDogJHtzZXJ2ZXJSZXNwb25zZS50cmFjZV9pZH1gO1xyXG4gICAgICAgIHRocm93IG5ldyBTZXJ2ZXJFcnJvcihzZXJ2ZXJSZXNwb25zZS5lcnJvciwgZXJyU3RyaW5nKTtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQXV0aG9yaXR5VHlwZSB9IGZyb20gXCIuL0F1dGhvcml0eVR5cGVcIjtcclxuaW1wb3J0IHsgVGVuYW50RGlzY292ZXJ5UmVzcG9uc2UgfSBmcm9tIFwiLi9UZW5hbnREaXNjb3ZlcnlSZXNwb25zZVwiO1xyXG5pbXBvcnQgeyBVcmxTdHJpbmcgfSBmcm9tIFwiLi4vLi4vdXJsL1VybFN0cmluZ1wiO1xyXG5pbXBvcnQgeyBJVXJpIH0gZnJvbSBcIi4uLy4uL3VybC9JVXJpXCI7XHJcbmltcG9ydCB7IENsaWVudEF1dGhFcnJvciB9IGZyb20gXCIuLi8uLi9lcnJvci9DbGllbnRBdXRoRXJyb3JcIjtcclxuaW1wb3J0IHsgSU5ldHdvcmtNb2R1bGUgfSBmcm9tIFwiLi4vLi4vbmV0d29yay9JTmV0d29ya01vZHVsZVwiO1xyXG5cclxuLyoqXHJcbiAqIFRoZSBhdXRob3JpdHkgY2xhc3MgdmFsaWRhdGVzIHRoZSBhdXRob3JpdHkgVVJJcyB1c2VkIGJ5IHRoZSB1c2VyLCBhbmQgcmV0cmlldmVzIHRoZSBPcGVuSUQgQ29uZmlndXJhdGlvbiBEYXRhIGZyb20gdGhlXHJcbiAqIGVuZHBvaW50LiBJdCB3aWxsIHN0b3JlIHRoZSBwZXJ0aW5lbnQgY29uZmlnIGRhdGEgaW4gdGhpcyBvYmplY3QgZm9yIHVzZSBkdXJpbmcgdG9rZW4gY2FsbHMuXHJcbiAqL1xyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQXV0aG9yaXR5IHtcclxuXHJcbiAgICAvLyBDYW5vbmljYWwgYXV0aG9yaXR5IHVybCBzdHJpbmdcclxuICAgIHByaXZhdGUgX2Nhbm9uaWNhbEF1dGhvcml0eTogVXJsU3RyaW5nO1xyXG4gICAgLy8gQ2Fub25pY2FseSBhdXRob3JpdHkgdXJsIGNvbXBvbmVudHNcclxuICAgIHByaXZhdGUgX2Nhbm9uaWNhbEF1dGhvcml0eVVybENvbXBvbmVudHM6IElVcmk7XHJcbiAgICAvLyBUZW5hbnQgZGlzY292ZXJ5IHJlc3BvbnNlIHJldHJpZXZlZCBmcm9tIE9wZW5JRCBDb25maWd1cmF0aW9uIEVuZHBvaW50XHJcbiAgICBwcml2YXRlIHRlbmFudERpc2NvdmVyeVJlc3BvbnNlOiBUZW5hbnREaXNjb3ZlcnlSZXNwb25zZTtcclxuICAgIC8vIE5ldHdvcmsgaW50ZXJmYWNlIHRvIG1ha2UgcmVxdWVzdHMgd2l0aC5cclxuICAgIHByb3RlY3RlZCBuZXR3b3JrSW50ZXJmYWNlOiBJTmV0d29ya01vZHVsZTtcclxuXHJcbiAgICAvLyBTZWUgYWJvdmUgZm9yIEF1dGhvcml0eVR5cGVcclxuICAgIHB1YmxpYyBhYnN0cmFjdCBnZXQgYXV0aG9yaXR5VHlwZSgpOiBBdXRob3JpdHlUeXBlO1xyXG4gICAgLy8gQm9vbGVhbiB2YWx1ZSB0byBjaGVjayBmb3IgYXV0aG9yaXR5IHZhbGlkYXRpb24uIElmIHZhbGlkYXRpb24gaXMgZGlzYWJsZWQsIHdlIGRvIG5vdCBjaGVjayBrbm93biBhdXRob3JpdGllcy5cclxuICAgIHB1YmxpYyBhYnN0cmFjdCBnZXQgaXNWYWxpZGF0aW9uRW5hYmxlZCgpOiBib29sZWFuO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQSBVUkwgdGhhdCBpcyB0aGUgYXV0aG9yaXR5IHNldCBieSB0aGUgZGV2ZWxvcGVyXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXQgY2Fub25pY2FsQXV0aG9yaXR5KCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nhbm9uaWNhbEF1dGhvcml0eS51cmxTdHJpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXRzIGNhbm9uaWNhbCBhdXRob3JpdHkuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZXQgY2Fub25pY2FsQXV0aG9yaXR5KHVybDogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5fY2Fub25pY2FsQXV0aG9yaXR5ID0gbmV3IFVybFN0cmluZyh1cmwpO1xyXG4gICAgICAgIHRoaXMuX2Nhbm9uaWNhbEF1dGhvcml0eVVybENvbXBvbmVudHMgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGF1dGhvcml0eSBjb21wb25lbnRzLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0IGNhbm9uaWNhbEF1dGhvcml0eVVybENvbXBvbmVudHMoKTogSVVyaSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9jYW5vbmljYWxBdXRob3JpdHlVcmxDb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Nhbm9uaWNhbEF1dGhvcml0eVVybENvbXBvbmVudHMgPSB0aGlzLl9jYW5vbmljYWxBdXRob3JpdHkuZ2V0VXJsQ29tcG9uZW50cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nhbm9uaWNhbEF1dGhvcml0eVVybENvbXBvbmVudHM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGVuYW50IGZvciBhdXRob3JpdHkuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXQgdGVuYW50KCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nhbm9uaWNhbEF1dGhvcml0eVVybENvbXBvbmVudHMuUGF0aFNlZ21lbnRzWzBdO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogT0F1dGggL2F1dGhvcml6ZSBlbmRwb2ludCBmb3IgcmVxdWVzdHNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldCBhdXRob3JpemF0aW9uRW5kcG9pbnQoKTogc3RyaW5nIHtcclxuICAgICAgICBpZih0aGlzLmRpc2NvdmVyeUNvbXBsZXRlKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZVRlbmFudCh0aGlzLnRlbmFudERpc2NvdmVyeVJlc3BvbnNlLmF1dGhvcml6YXRpb25fZW5kcG9pbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudEF1dGhFcnJvci5jcmVhdGVFbmRwb2ludERpc2NvdmVyeUluY29tcGxldGVFcnJvcihcIkRpc2NvdmVyeSBpbmNvbXBsZXRlLlwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPQXV0aCAvdG9rZW4gZW5kcG9pbnQgZm9yIHJlcXVlc3RzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXQgdG9rZW5FbmRwb2ludCgpOiBzdHJpbmcge1xyXG4gICAgICAgIGlmKHRoaXMuZGlzY292ZXJ5Q29tcGxldGUoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlVGVuYW50KHRoaXMudGVuYW50RGlzY292ZXJ5UmVzcG9uc2UudG9rZW5fZW5kcG9pbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudEF1dGhFcnJvci5jcmVhdGVFbmRwb2ludERpc2NvdmVyeUluY29tcGxldGVFcnJvcihcIkRpc2NvdmVyeSBpbmNvbXBsZXRlLlwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPQXV0aCBsb2dvdXQgZW5kcG9pbnQgZm9yIHJlcXVlc3RzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXQgZW5kU2Vzc2lvbkVuZHBvaW50KCk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYodGhpcy5kaXNjb3ZlcnlDb21wbGV0ZSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2VUZW5hbnQodGhpcy50ZW5hbnREaXNjb3ZlcnlSZXNwb25zZS5lbmRfc2Vzc2lvbl9lbmRwb2ludCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUVuZHBvaW50RGlzY292ZXJ5SW5jb21wbGV0ZUVycm9yKFwiRGlzY292ZXJ5IGluY29tcGxldGUuXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE9BdXRoIGlzc3VlciBmb3IgcmVxdWVzdHNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldCBzZWxmU2lnbmVkSnd0QXVkaWVuY2UoKTogc3RyaW5nIHtcclxuICAgICAgICBpZih0aGlzLmRpc2NvdmVyeUNvbXBsZXRlKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZVRlbmFudCh0aGlzLnRlbmFudERpc2NvdmVyeVJlc3BvbnNlLmlzc3Vlcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUVuZHBvaW50RGlzY292ZXJ5SW5jb21wbGV0ZUVycm9yKFwiRGlzY292ZXJ5IGluY29tcGxldGUuXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlcGxhY2VzIHRlbmFudCBpbiB1cmwgcGF0aCB3aXRoIGN1cnJlbnQgdGVuYW50LiBEZWZhdWx0cyB0byBjb21tb24uXHJcbiAgICAgKiBAcGFyYW0gdXJsU3RyaW5nIFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlcGxhY2VUZW5hbnQodXJsU3RyaW5nOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB1cmxTdHJpbmcucmVwbGFjZShcInt0ZW5hbnR9XCIsIHRoaXMudGVuYW50KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBkZWZhdWx0IG9wZW4gaWQgY29uZmlndXJhdGlvbiBlbmRwb2ludCBmb3IgYW55IGNhbm9uaWNhbCBhdXRob3JpdHkuXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBnZXQgZGVmYXVsdE9wZW5JZENvbmZpZ3VyYXRpb25FbmRwb2ludCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBgJHt0aGlzLmNhbm9uaWNhbEF1dGhvcml0eX12Mi4wLy53ZWxsLWtub3duL29wZW5pZC1jb25maWd1cmF0aW9uYDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhdXRob3JpdHk6IHN0cmluZywgbmV0d29ya0ludGVyZmFjZTogSU5ldHdvcmtNb2R1bGUpIHtcclxuICAgICAgICB0aGlzLmNhbm9uaWNhbEF1dGhvcml0eSA9IGF1dGhvcml0eTtcclxuXHJcbiAgICAgICAgdGhpcy5fY2Fub25pY2FsQXV0aG9yaXR5LnZhbGlkYXRlQXNVcmkoKTtcclxuICAgICAgICB0aGlzLm5ldHdvcmtJbnRlcmZhY2UgPSBuZXR3b3JrSW50ZXJmYWNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQm9vbGVhbiB0aGF0IHJldHVybnMgd2hldGhyIG9yIG5vdCB0ZW5hbnQgZGlzY292ZXJ5IGhhcyBiZWVuIGNvbXBsZXRlZC5cclxuICAgICAqL1xyXG4gICAgZGlzY292ZXJ5Q29tcGxldGUoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICEhdGhpcy50ZW5hbnREaXNjb3ZlcnlSZXNwb25zZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldHMgT0F1dGggZW5kcG9pbnRzIGZyb20gdGhlIGdpdmVuIE9wZW5JRCBjb25maWd1cmF0aW9uIGVuZHBvaW50LlxyXG4gICAgICogQHBhcmFtIG9wZW5JZENvbmZpZ3VyYXRpb25FbmRwb2ludCBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBkaXNjb3ZlckVuZHBvaW50cyhvcGVuSWRDb25maWd1cmF0aW9uRW5kcG9pbnQ6IHN0cmluZyk6IFByb21pc2U8VGVuYW50RGlzY292ZXJ5UmVzcG9uc2U+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5uZXR3b3JrSW50ZXJmYWNlLnNlbmRHZXRSZXF1ZXN0QXN5bmM8VGVuYW50RGlzY292ZXJ5UmVzcG9uc2U+KG9wZW5JZENvbmZpZ3VyYXRpb25FbmRwb2ludCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBYnN0cmFjdCBmdW5jdGlvbiB3aGljaCB3aWxsIGdldCB0aGUgT3BlbklEIGNvbmZpZ3VyYXRpb24gZW5kcG9pbnQuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhYnN0cmFjdCBhc3luYyBnZXRPcGVuSWRDb25maWd1cmF0aW9uQXN5bmMoKTogUHJvbWlzZTxzdHJpbmc+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUGVyZm9ybSBlbmRwb2ludCBkaXNjb3ZlcnkgdG8gZGlzY292ZXIgdGhlIC9hdXRob3JpemUsIC90b2tlbiBhbmQgbG9nb3V0IGVuZHBvaW50cy5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIHJlc29sdmVFbmRwb2ludHNBc3luYygpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBjb25zdCBvcGVuSWRDb25maWdFbmRwb2ludCA9IGF3YWl0IHRoaXMuZ2V0T3BlbklkQ29uZmlndXJhdGlvbkFzeW5jKCk7XHJcbiAgICAgICAgdGhpcy50ZW5hbnREaXNjb3ZlcnlSZXNwb25zZSA9IGF3YWl0IHRoaXMuZGlzY292ZXJFbmRwb2ludHMob3BlbklkQ29uZmlnRW5kcG9pbnQpO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEF1dGhvcml0eSB0eXBlcyBzdXBwb3J0ZWQgYnkgTVNBTC5cclxuICovXHJcbmV4cG9ydCBlbnVtIEF1dGhvcml0eVR5cGUge1xyXG4gICAgQWFkLFxyXG4gICAgQWRmcyxcclxuICAgIEIyQ1xyXG59XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5pbXBvcnQgeyBBdXRob3JpdHkgfSBmcm9tIFwiLi9BdXRob3JpdHlcIjtcclxuaW1wb3J0IHsgT3BlbklkQ29uZmlnUmVzcG9uc2UgfSBmcm9tIFwiLi9PcGVuSWRDb25maWdSZXNwb25zZVwiO1xyXG5pbXBvcnQgeyBBdXRob3JpdHlUeXBlIH0gZnJvbSBcIi4vQXV0aG9yaXR5VHlwZVwiO1xyXG5pbXBvcnQgeyBBQURUcnVzdGVkSG9zdExpc3QgfSBmcm9tIFwiLi4vLi4vdXRpbHMvQ29uc3RhbnRzXCI7XHJcbmltcG9ydCB7IElOZXR3b3JrTW9kdWxlIH0gZnJvbSBcIi4uLy4uL25ldHdvcmsvSU5ldHdvcmtNb2R1bGVcIjtcclxuXHJcbi8qKlxyXG4gKiBUaGUgQWFkQXV0aG9yaXR5IGNsYXNzIGV4dGVuZHMgdGhlIEF1dGhvcml0eSBjbGFzcyBhbmQgYWRkcyBmdW5jdGlvbmFsaXR5IHNwZWNpZmljIHRvIHRoZSBBenVyZSBBRCBPQXV0aCBBdXRob3JpdHkuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQWFkQXV0aG9yaXR5IGV4dGVuZHMgQXV0aG9yaXR5IHtcclxuICAgIC8vIFNldCBhdXRob3JpdHkgdHlwZSB0byBBQURcclxuICAgIHB1YmxpYyBnZXQgYXV0aG9yaXR5VHlwZSgpOiBBdXRob3JpdHlUeXBlIHtcclxuICAgICAgICByZXR1cm4gQXV0aG9yaXR5VHlwZS5BYWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldCBpc1ZhbGlkYXRpb25FbmFibGVkKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIEhhcmRjb2RlZCB0byB0cnVlIGZvciBub3cgLSBtYXkgY2hhbmdlIGRlcGVuZGluZyBvbiByZXF1aXJlbWVudHNcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWZhdWx0IEFBRCBJbnN0YW5jZSBEaXNjb3ZlcnkgRW5kcG9pbnRcclxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IGFhZEluc3RhbmNlRGlzY292ZXJ5RW5kcG9pbnQ6IHN0cmluZyA9IFwiaHR0cHM6Ly9sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tL2NvbW1vbi9kaXNjb3ZlcnkvaW5zdGFuY2VcIjtcclxuICAgIHByaXZhdGUgZ2V0IGFhZEluc3RhbmNlRGlzY292ZXJ5RW5kcG9pbnRVcmwoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gYCR7QWFkQXV0aG9yaXR5LmFhZEluc3RhbmNlRGlzY292ZXJ5RW5kcG9pbnR9P2FwaS12ZXJzaW9uPTEuMCZhdXRob3JpemF0aW9uX2VuZHBvaW50PSR7dGhpcy5jYW5vbmljYWxBdXRob3JpdHl9b2F1dGgyL3YyLjAvYXV0aG9yaXplYDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY29uc3RydWN0b3IoYXV0aG9yaXR5OiBzdHJpbmcsIG5ldHdvcmtJbnRlcmZhY2U6IElOZXR3b3JrTW9kdWxlKSB7XHJcbiAgICAgICAgc3VwZXIoYXV0aG9yaXR5LCBuZXR3b3JrSW50ZXJmYWNlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBwcm9taXNlIHdoaWNoIHJlc29sdmVzIHRvIHRoZSBPSURDIGVuZHBvaW50XHJcbiAgICAgKiBPbmx5IHJlc3BvbmRzIHdpdGggdGhlIGVuZHBvaW50XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBnZXRPcGVuSWRDb25maWd1cmF0aW9uQXN5bmMoKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNWYWxpZGF0aW9uRW5hYmxlZCB8fCB0aGlzLmlzSW5UcnVzdGVkSG9zdExpc3QodGhpcy5jYW5vbmljYWxBdXRob3JpdHlVcmxDb21wb25lbnRzLkhvc3ROYW1lQW5kUG9ydCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdE9wZW5JZENvbmZpZ3VyYXRpb25FbmRwb2ludDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGZvciBjdXN0b20gZG9tYWlucyBpbiBBQUQgd2hlcmUgd2UgcXVlcnkgdGhlIHNlcnZpY2UgZm9yIHRoZSBJbnN0YW5jZSBkaXNjb3ZlcnlcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubmV0d29ya0ludGVyZmFjZS5zZW5kR2V0UmVxdWVzdEFzeW5jPE9wZW5JZENvbmZpZ1Jlc3BvbnNlPih0aGlzLmFhZEluc3RhbmNlRGlzY292ZXJ5RW5kcG9pbnRVcmwpO1xyXG4gICAgICAgIHJldHVybiByZXNwb25zZS50ZW5hbnRfZGlzY292ZXJ5X2VuZHBvaW50O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2tzIHRvIHNlZSBpZiB0aGUgaG9zdCBpcyBpbiBhIGxpc3Qgb2YgdHJ1c3RlZCBob3N0c1xyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFRoZSBob3N0IHRvIGxvb2sgdXBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGlzSW5UcnVzdGVkSG9zdExpc3QoaG9zdDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIEFBRFRydXN0ZWRIb3N0TGlzdC5pbmNsdWRlcyhob3N0KTtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQXV0aG9yaXR5IH0gZnJvbSBcIi4vQXV0aG9yaXR5XCI7XHJcbmltcG9ydCB7IEFhZEF1dGhvcml0eSB9IGZyb20gXCIuL0FhZEF1dGhvcml0eVwiO1xyXG5pbXBvcnQgeyBBdXRob3JpdHlUeXBlIH0gZnJvbSBcIi4vQXV0aG9yaXR5VHlwZVwiO1xyXG5pbXBvcnQgeyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IgfSBmcm9tIFwiLi4vLi4vZXJyb3IvQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yXCI7XHJcbmltcG9ydCB7IElOZXR3b3JrTW9kdWxlIH0gZnJvbSBcIi4uLy4uL25ldHdvcmsvSU5ldHdvcmtNb2R1bGVcIjtcclxuaW1wb3J0IHsgU3RyaW5nVXRpbHMgfSBmcm9tIFwiLi4vLi4vdXRpbHMvU3RyaW5nVXRpbHNcIjtcclxuaW1wb3J0IHsgVXJsU3RyaW5nIH0gZnJvbSBcIi4uLy4uL3VybC9VcmxTdHJpbmdcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBBdXRob3JpdHlGYWN0b3J5IHtcclxuXHJcbiAgICAvLyBkZWZhdWx0IGF1dGhvcml0eVxyXG4gICAgcHVibGljIHN0YXRpYyBERUZBVUxUX0FVVEhPUklUWSA9IFwiaHR0cHM6Ly9sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tL2NvbW1vblwiO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUGFyc2UgdGhlIHVybCBhbmQgZGV0ZXJtaW5lIHRoZSB0eXBlIG9mIGF1dGhvcml0eVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHN0YXRpYyBkZXRlY3RBdXRob3JpdHlGcm9tVXJsKGF1dGhvcml0eVN0cmluZzogc3RyaW5nKTogQXV0aG9yaXR5VHlwZSB7XHJcbiAgICAgICAgY29uc3QgYXV0aG9yaXR5VXJsID0gbmV3IFVybFN0cmluZyhhdXRob3JpdHlTdHJpbmcpO1xyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudHMgPSBhdXRob3JpdHlVcmwuZ2V0VXJsQ29tcG9uZW50cygpO1xyXG4gICAgICAgIGNvbnN0IHBhdGhTZWdtZW50cyA9IGNvbXBvbmVudHMuUGF0aFNlZ21lbnRzO1xyXG4gICAgICAgIHN3aXRjaCAocGF0aFNlZ21lbnRzWzBdKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJ0ZnBcIjpcclxuICAgICAgICAgICAgICAgIC8vIHRmcCBkZW5vdGVzIGEgYjJjIHVybFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGhvcml0eVR5cGUuQjJDO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgLy8gZGVmYXVsdCBhdXRob3JpdHkgaXMgYWx3YXlzIEFBRFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGhvcml0eVR5cGUuQWFkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBhbiBhdXRob3JpdHkgb2JqZWN0IG9mIHRoZSBjb3JyZWN0IHR5cGUgYmFzZWQgb24gdGhlIHVybFxyXG4gICAgICogUGVyZm9ybXMgYmFzaWMgYXV0aG9yaXR5IHZhbGlkYXRpb24gLSBjaGVja3MgdG8gc2VlIGlmIHRoZSBhdXRob3JpdHkgaXMgb2YgYSB2YWxpZCB0eXBlIChlZyBhYWQsIGIyYylcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVJbnN0YW5jZShhdXRob3JpdHlVcmw6IHN0cmluZywgbmV0d29ya0ludGVyZmFjZTogSU5ldHdvcmtNb2R1bGUpOiBBdXRob3JpdHkge1xyXG4gICAgICAgIC8vIFJldHVybiBudWxsIGlmIGF1dGhvcml0eSB1cmwgaXMgZW1wdHlcclxuICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShhdXRob3JpdHlVcmwpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdHlwZSA9IEF1dGhvcml0eUZhY3RvcnkuZGV0ZWN0QXV0aG9yaXR5RnJvbVVybChhdXRob3JpdHlVcmwpO1xyXG4gICAgICAgIC8vIERlcGVuZGluZyBvbiBhYm92ZSBkZXRlY3Rpb24sIGNyZWF0ZSB0aGUgcmlnaHQgdHlwZS5cclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBBdXRob3JpdHlUeXBlLkFhZDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWFkQXV0aG9yaXR5KGF1dGhvcml0eVVybCwgbmV0d29ya0ludGVyZmFjZSk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlSW52YWxpZEF1dGhvcml0eVR5cGVFcnJvcihgR2l2ZW4gVXJsOiAke2F1dGhvcml0eVVybH1gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IEF1dGhNb2R1bGUgfSBmcm9tIFwiLi9BdXRoTW9kdWxlXCI7XHJcbmltcG9ydCB7IFB1YmxpY0NsaWVudFNQQUNvbmZpZ3VyYXRpb24sIGJ1aWxkUHVibGljQ2xpZW50U1BBQ29uZmlndXJhdGlvbiB9IGZyb20gXCIuLi9jb25maWcvUHVibGljQ2xpZW50U1BBQ29uZmlndXJhdGlvblwiO1xyXG5pbXBvcnQgeyBBdXRoZW50aWNhdGlvblBhcmFtZXRlcnMgfSBmcm9tIFwiLi4vLi4vcmVxdWVzdC9BdXRoZW50aWNhdGlvblBhcmFtZXRlcnNcIjtcclxuaW1wb3J0IHsgVG9rZW5FeGNoYW5nZVBhcmFtZXRlcnMgfSBmcm9tIFwiLi4vLi4vcmVxdWVzdC9Ub2tlbkV4Y2hhbmdlUGFyYW1ldGVyc1wiO1xyXG5pbXBvcnQgeyBUb2tlblJlbmV3UGFyYW1ldGVycyB9IGZyb20gXCIuLi8uLi9yZXF1ZXN0L1Rva2VuUmVuZXdQYXJhbWV0ZXJzXCI7XHJcbmltcG9ydCB7IFNlcnZlckNvZGVSZXF1ZXN0UGFyYW1ldGVycyB9IGZyb20gXCIuLi8uLi9zZXJ2ZXIvU2VydmVyQ29kZVJlcXVlc3RQYXJhbWV0ZXJzXCI7XHJcbmltcG9ydCB7IFNlcnZlclRva2VuUmVxdWVzdFBhcmFtZXRlcnMgfSBmcm9tIFwiLi4vLi4vc2VydmVyL1NlcnZlclRva2VuUmVxdWVzdFBhcmFtZXRlcnNcIjtcclxuaW1wb3J0IHsgQ29kZVJlc3BvbnNlIH0gZnJvbSBcIi4uLy4uL3Jlc3BvbnNlL0NvZGVSZXNwb25zZVwiO1xyXG5pbXBvcnQgeyBUb2tlblJlc3BvbnNlIH0gZnJvbSBcIi4uLy4uL3Jlc3BvbnNlL1Rva2VuUmVzcG9uc2VcIjtcclxuaW1wb3J0IHsgUmVzcG9uc2VIYW5kbGVyIH0gZnJvbSBcIi4uLy4uL3Jlc3BvbnNlL1Jlc3BvbnNlSGFuZGxlclwiO1xyXG5pbXBvcnQgeyBTZXJ2ZXJBdXRob3JpemF0aW9uQ29kZVJlc3BvbnNlIH0gZnJvbSBcIi4uLy4uL3NlcnZlci9TZXJ2ZXJBdXRob3JpemF0aW9uQ29kZVJlc3BvbnNlXCI7XHJcbmltcG9ydCB7IFNlcnZlckF1dGhvcml6YXRpb25Ub2tlblJlc3BvbnNlLCB2YWxpZGF0ZVNlcnZlckF1dGhvcml6YXRpb25Ub2tlblJlc3BvbnNlIH0gZnJvbSBcIi4uLy4uL3NlcnZlci9TZXJ2ZXJBdXRob3JpemF0aW9uVG9rZW5SZXNwb25zZVwiO1xyXG5pbXBvcnQgeyBDbGllbnRBdXRoRXJyb3IgfSBmcm9tIFwiLi4vLi4vZXJyb3IvQ2xpZW50QXV0aEVycm9yXCI7XHJcbmltcG9ydCB7IENsaWVudENvbmZpZ3VyYXRpb25FcnJvciB9IGZyb20gXCIuLi8uLi9lcnJvci9DbGllbnRDb25maWd1cmF0aW9uRXJyb3JcIjtcclxuaW1wb3J0IHsgQWNjZXNzVG9rZW5DYWNoZUl0ZW0gfSBmcm9tIFwiLi4vLi4vY2FjaGUvQWNjZXNzVG9rZW5DYWNoZUl0ZW1cIjtcclxuaW1wb3J0IHsgQXV0aG9yaXR5RmFjdG9yeSB9IGZyb20gXCIuLi8uLi9hdXRoL2F1dGhvcml0eS9BdXRob3JpdHlGYWN0b3J5XCI7XHJcbmltcG9ydCB7IElkVG9rZW4gfSBmcm9tIFwiLi4vLi4vYXV0aC9JZFRva2VuXCI7XHJcbmltcG9ydCB7IFNjb3BlU2V0IH0gZnJvbSBcIi4uLy4uL2F1dGgvU2NvcGVTZXRcIjtcclxuaW1wb3J0IHsgVGVtcG9yYXJ5Q2FjaGVLZXlzLCBQZXJzaXN0ZW50Q2FjaGVLZXlzLCBBQURTZXJ2ZXJQYXJhbUtleXMgfSBmcm9tIFwiLi4vLi4vdXRpbHMvQ29uc3RhbnRzXCI7XHJcbmltcG9ydCB7IFRpbWVVdGlscyB9IGZyb20gXCIuLi8uLi91dGlscy9UaW1lVXRpbHNcIjtcclxuaW1wb3J0IHsgU3RyaW5nVXRpbHMgfSBmcm9tIFwiLi4vLi4vdXRpbHMvU3RyaW5nVXRpbHNcIjtcclxuaW1wb3J0IHsgVXJsU3RyaW5nIH0gZnJvbSBcIi4uLy4uL3VybC9VcmxTdHJpbmdcIjtcclxuXHJcbi8qKlxyXG4gKiBBdXRob3JpemF0aW9uQ29kZU1vZHVsZSBjbGFzc1xyXG4gKiBcclxuICogT2JqZWN0IGluc3RhbmNlIHdoaWNoIHdpbGwgY29uc3RydWN0IHJlcXVlc3RzIHRvIHNlbmQgdG8gYW5kIGhhbmRsZSByZXNwb25zZXNcclxuICogZnJvbSB0aGUgTWljcm9zb2Z0IFNUUyB1c2luZyB0aGUgYXV0aG9yaXphdGlvbiBjb2RlIGZsb3cuIFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEF1dGhvcml6YXRpb25Db2RlTW9kdWxlIGV4dGVuZHMgQXV0aE1vZHVsZSB7XHJcblxyXG4gICAgLy8gQXBwbGljYXRpb24gY29uZmlnXHJcbiAgICBwcml2YXRlIGNsaWVudENvbmZpZzogUHVibGljQ2xpZW50U1BBQ29uZmlndXJhdGlvbjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb25maWd1cmF0aW9uOiBQdWJsaWNDbGllbnRTUEFDb25maWd1cmF0aW9uKSB7XHJcbiAgICAgICAgLy8gSW1wbGVtZW50IGJhc2UgbW9kdWxlXHJcbiAgICAgICAgc3VwZXIoe1xyXG4gICAgICAgICAgICBzeXN0ZW1PcHRpb25zOiBjb25maWd1cmF0aW9uLnN5c3RlbU9wdGlvbnMsXHJcbiAgICAgICAgICAgIGxvZ2dlck9wdGlvbnM6IGNvbmZpZ3VyYXRpb24ubG9nZ2VyT3B0aW9ucyxcclxuICAgICAgICAgICAgc3RvcmFnZUludGVyZmFjZTogY29uZmlndXJhdGlvbi5zdG9yYWdlSW50ZXJmYWNlLFxyXG4gICAgICAgICAgICBuZXR3b3JrSW50ZXJmYWNlOiBjb25maWd1cmF0aW9uLm5ldHdvcmtJbnRlcmZhY2UsXHJcbiAgICAgICAgICAgIGNyeXB0b0ludGVyZmFjZTogY29uZmlndXJhdGlvbi5jcnlwdG9JbnRlcmZhY2VcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBJbXBsZW1lbnQgZGVmYXVsdHMgaW4gY29uZmlnXHJcbiAgICAgICAgdGhpcy5jbGllbnRDb25maWcgPSBidWlsZFB1YmxpY0NsaWVudFNQQUNvbmZpZ3VyYXRpb24oY29uZmlndXJhdGlvbik7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNsaWVudENvbmZpZy5hdXRoLnRtcF9jbGllbnRTZWNyZXQpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIud2FybmluZyhcIkNsaWVudCBzZWNyZXQgaXMgYSB0ZW1wb3JhcnkgcGFyYW1ldGVyIHRoYXQgd2lsbCBub3QgYmUgY2FycmllZCBmb3J3YXJkIGluIHByb2R1Y3Rpb24gdmVyc2lvbnMgb2YgdGhpcyBsaWJyYXJ5LlwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgZGVmYXVsdCBhdXRob3JpdHkgaW5zdGFuY2VcclxuICAgICAgICB0aGlzLmRlZmF1bHRBdXRob3JpdHlJbnN0YW5jZSA9IEF1dGhvcml0eUZhY3RvcnkuY3JlYXRlSW5zdGFuY2UodGhpcy5jbGllbnRDb25maWcuYXV0aC5hdXRob3JpdHkgfHwgQXV0aG9yaXR5RmFjdG9yeS5ERUZBVUxUX0FVVEhPUklUWSwgdGhpcy5uZXR3b3JrQ2xpZW50KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSB1cmwgZm9yIGxvZ2dpbmcgaW4gYSB1c2VyLiBUaGlzIHdpbGwgYnkgZGVmYXVsdCBhcHBlbmQgdGhlIGNsaWVudCBpZCB0byB0aGUgbGlzdCBvZiBzY29wZXMsIFxyXG4gICAgICogYWxsb3dpbmcgeW91IHRvIHJldHJpZXZlIGFuIGlkIHRva2VuIGluIHRoZSBzdWJzZXF1ZW50IGNvZGUgZXhjaGFuZ2UuIEFsc28gcGVyZm9ybXMgdmFsaWRhdGlvbiBvZiB0aGUgcmVxdWVzdCBwYXJhbWV0ZXJzLlxyXG4gICAgICogSW5jbHVkaW5nIGFueSBTU08gcGFyYW1ldGVycyAoYWNjb3VudCwgc2lkLCBsb2dpbl9oaW50KSB3aWxsIHNob3J0IGNpcmN1aXQgdGhlIGF1dGhlbnRpY2F0aW9uIGFuZCBhbGxvdyB5b3UgdG8gcmV0cmlldmUgYSBjb2RlIHdpdGhvdXQgaW50ZXJhY3Rpb24uXHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdCBcclxuICAgICAqL1xyXG4gICAgYXN5bmMgY3JlYXRlTG9naW5VcmwocmVxdWVzdDogQXV0aGVudGljYXRpb25QYXJhbWV0ZXJzKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVVcmwocmVxdWVzdCwgdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgdXJsIGZvciBsb2dnaW5nIGluIGEgdXNlci4gQWxzbyBwZXJmb3JtcyB2YWxpZGF0aW9uIG9mIHRoZSByZXF1ZXN0IHBhcmFtZXRlcnMuXHJcbiAgICAgKiBJbmNsdWRpbmcgYW55IFNTTyBwYXJhbWV0ZXJzIChhY2NvdW50LCBzaWQsIGxvZ2luX2hpbnQpIHdpbGwgc2hvcnQgY2lyY3VpdCB0aGUgYXV0aGVudGljYXRpb24gYW5kIGFsbG93IHlvdSB0byByZXRyaWV2ZSBhIGNvZGUgd2l0aG91dCBpbnRlcmFjdGlvbi5cclxuICAgICAqIEBwYXJhbSByZXF1ZXN0IFxyXG4gICAgICovXHJcbiAgICBhc3luYyBjcmVhdGVBY3F1aXJlVG9rZW5VcmwocmVxdWVzdDogQXV0aGVudGljYXRpb25QYXJhbWV0ZXJzKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVVcmwocmVxdWVzdCwgZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIGZ1bmN0aW9uIHdoaWNoIGNyZWF0ZXMgVVJMLiBJZiBpc0xvZ2luQ2FsbCBpcyB0cnVlLCBNU0FMIGFwcGVuZHMgY2xpZW50IGlkIHNjb3BlIHRvIHJldHJpZXZlIGlkIHRva2VuIGZyb20gdGhlIHNlcnZpY2UuXHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdCBcclxuICAgICAqIEBwYXJhbSBpc0xvZ2luQ2FsbCBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBjcmVhdGVVcmwocmVxdWVzdDogQXV0aGVudGljYXRpb25QYXJhbWV0ZXJzLCBpc0xvZ2luQ2FsbDogYm9vbGVhbik6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBhdXRob3JpdHkgb3IgdXNlIGRlZmF1bHQsIGFuZCBwZXJmb3JtIGRpc2NvdmVyeSBlbmRwb2ludCBjaGVjay5cclxuICAgICAgICBjb25zdCBhY3F1aXJlVG9rZW5BdXRob3JpdHkgPSAocmVxdWVzdCAmJiByZXF1ZXN0LmF1dGhvcml0eSkgPyBBdXRob3JpdHlGYWN0b3J5LmNyZWF0ZUluc3RhbmNlKHJlcXVlc3QuYXV0aG9yaXR5LCB0aGlzLm5ldHdvcmtDbGllbnQpIDogdGhpcy5kZWZhdWx0QXV0aG9yaXR5SW5zdGFuY2U7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgYXdhaXQgYWNxdWlyZVRva2VuQXV0aG9yaXR5LnJlc29sdmVFbmRwb2ludHNBc3luYygpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUVuZHBvaW50RGlzY292ZXJ5SW5jb21wbGV0ZUVycm9yKGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ3JlYXRlIGFuZCB2YWxpZGF0ZSByZXF1ZXN0IHBhcmFtZXRlcnMuXHJcbiAgICAgICAgbGV0IHJlcXVlc3RQYXJhbWV0ZXJzOiBTZXJ2ZXJDb2RlUmVxdWVzdFBhcmFtZXRlcnM7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmVxdWVzdFBhcmFtZXRlcnMgPSBuZXcgU2VydmVyQ29kZVJlcXVlc3RQYXJhbWV0ZXJzKFxyXG4gICAgICAgICAgICAgICAgYWNxdWlyZVRva2VuQXV0aG9yaXR5LFxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGllbnRDb25maWcuYXV0aC5jbGllbnRJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVlc3QsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldEFjY291bnQoKSxcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0UmVkaXJlY3RVcmkoKSxcclxuICAgICAgICAgICAgICAgIHRoaXMuY3J5cHRvT2JqLFxyXG4gICAgICAgICAgICAgICAgaXNMb2dpbkNhbGxcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBTU08uXHJcbiAgICAgICAgICAgIGxldCBhZGFsSWRUb2tlbjogSWRUb2tlbiA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmICghcmVxdWVzdFBhcmFtZXRlcnMuaGFzU1NPUGFyYW0oKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWRhbElkVG9rZW5TdHJpbmcgPSB0aGlzLmNhY2hlU3RvcmFnZS5nZXRJdGVtKFBlcnNpc3RlbnRDYWNoZUtleXMuQURBTF9JRF9UT0tFTik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoYWRhbElkVG9rZW5TdHJpbmcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRhbElkVG9rZW4gPSBuZXcgSWRUb2tlbihhZGFsSWRUb2tlblN0cmluZywgdGhpcy5jcnlwdG9PYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnJlbW92ZUl0ZW0oUGVyc2lzdGVudENhY2hlS2V5cy5BREFMX0lEX1RPS0VOKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHJlcXVpcmVkIGNhY2hlIGVudHJpZXMgZm9yIHJlcXVlc3QuXHJcbiAgICAgICAgICAgIHRoaXMuY2FjaGVNYW5hZ2VyLnVwZGF0ZUNhY2hlRW50cmllcyhyZXF1ZXN0UGFyYW1ldGVycywgcmVxdWVzdC5hY2NvdW50KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFBvcHVsYXRlIHF1ZXJ5IHBhcmFtZXRlcnMgKHNpZC9sb2dpbl9oaW50L2RvbWFpbl9oaW50KSBhbmQgYW55IG90aGVyIGV4dHJhUXVlcnlQYXJhbWV0ZXJzIHNldCBieSB0aGUgZGV2ZWxvcGVyLlxyXG4gICAgICAgICAgICByZXF1ZXN0UGFyYW1ldGVycy5wb3B1bGF0ZVF1ZXJ5UGFyYW1zKGFkYWxJZFRva2VuKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSB1cmwgdG8gbmF2aWdhdGUgdG8uXHJcbiAgICAgICAgICAgIGNvbnN0IHVybE5hdmlnYXRlID0gYXdhaXQgcmVxdWVzdFBhcmFtZXRlcnMuY3JlYXRlTmF2aWdhdGVVcmwoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENhY2hlIHRva2VuIHJlcXVlc3QuXHJcbiAgICAgICAgICAgIGNvbnN0IHRva2VuUmVxdWVzdDogVG9rZW5FeGNoYW5nZVBhcmFtZXRlcnMgPSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZXM6IHJlcXVlc3RQYXJhbWV0ZXJzLnNjb3Blcy5nZXRPcmlnaW5hbFNjb3Blc0FzQXJyYXkoKSxcclxuICAgICAgICAgICAgICAgIHJlc291cmNlOiByZXF1ZXN0LnJlc291cmNlLFxyXG4gICAgICAgICAgICAgICAgY29kZVZlcmlmaWVyOiByZXF1ZXN0UGFyYW1ldGVycy5nZW5lcmF0ZWRQa2NlLnZlcmlmaWVyLFxyXG4gICAgICAgICAgICAgICAgZXh0cmFRdWVyeVBhcmFtZXRlcnM6IHJlcXVlc3QuZXh0cmFRdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgICAgICAgICAgICBhdXRob3JpdHk6IHJlcXVlc3RQYXJhbWV0ZXJzLmF1dGhvcml0eUluc3RhbmNlLmNhbm9uaWNhbEF1dGhvcml0eSxcclxuICAgICAgICAgICAgICAgIGNvcnJlbGF0aW9uSWQ6IHJlcXVlc3RQYXJhbWV0ZXJzLmNvcnJlbGF0aW9uSWRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShUZW1wb3JhcnlDYWNoZUtleXMuUkVRVUVTVF9QQVJBTVMsIHRoaXMuY3J5cHRvT2JqLmJhc2U2NEVuY29kZShKU09OLnN0cmluZ2lmeSh0b2tlblJlcXVlc3QpKSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdXJsTmF2aWdhdGU7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvLyBSZXNldCBjYWNoZSBpdGVtcyBiZWZvcmUgcmUtdGhyb3dpbmcuXHJcbiAgICAgICAgICAgIHRoaXMuY2FjaGVNYW5hZ2VyLnJlc2V0VGVtcENhY2hlSXRlbXMocmVxdWVzdFBhcmFtZXRlcnMgJiYgcmVxdWVzdFBhcmFtZXRlcnMuc3RhdGUpO1xyXG4gICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdpdmVuIGFuIGF1dGhvcml6YXRpb24gY29kZSwgaXQgd2lsbCBwZXJmb3JtIGEgdG9rZW4gZXhjaGFuZ2UgdXNpbmcgY2FjaGVkIHZhbHVlcyBmcm9tIGEgcHJldmlvdXMgY2FsbCB0b1xyXG4gICAgICogY3JlYXRlTG9naW5VcmwoKSBvciBjcmVhdGVBY3F1aXJlVG9rZW5VcmwoKS4gWW91IG11c3QgY2FsbCB0aGlzIEFGVEVSIHVzaW5nIG9uZSBvZiB0aG9zZSBBUElzIGZpcnN0LiBZb3Ugc2hvdWxkXHJcbiAgICAgKiBhbHNvIHVzZSB0aGUgaGFuZGxlRnJhZ21lbnRSZXNwb25zZSgpIEFQSSB0byBwYXNzIHRoZSBjb2RlUmVzcG9uc2UgdG8gdGhpcyBmdW5jdGlvbiBhZnRlcndhcmRzLlxyXG4gICAgICogQHBhcmFtIGNvZGVSZXNwb25zZSBcclxuICAgICAqL1xyXG4gICAgYXN5bmMgYWNxdWlyZVRva2VuKGNvZGVSZXNwb25zZTogQ29kZVJlc3BvbnNlKTogUHJvbWlzZTxUb2tlblJlc3BvbnNlPiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gR2V0IHJlcXVlc3QgZnJvbSBjYWNoZVxyXG4gICAgICAgICAgICBjb25zdCB0b2tlblJlcXVlc3Q6IFRva2VuRXhjaGFuZ2VQYXJhbWV0ZXJzID0gdGhpcy5nZXRDYWNoZWRSZXF1ZXN0KGNvZGVSZXNwb25zZS51c2VyUmVxdWVzdFN0YXRlKTtcclxuXHJcbiAgICAgICAgICAgIC8vIElmIG5vIGNvZGUgcmVzcG9uc2UgaXMgZ2l2ZW4sIHdlIGNhbm5vdCBhY3F1aXJlIGEgdG9rZW4uXHJcbiAgICAgICAgICAgIGlmICghY29kZVJlc3BvbnNlIHx8ICFjb2RlUmVzcG9uc2UuY29kZSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZVRva2VuUmVxdWVzdENhbm5vdEJlTWFkZUVycm9yKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgYXV0aG9yaXR5IG9yIHVzZSBkZWZhdWx0LCBhbmQgcGVyZm9ybSBkaXNjb3ZlcnkgZW5kcG9pbnQgY2hlY2suXHJcbiAgICAgICAgICAgIGNvbnN0IGFjcXVpcmVUb2tlbkF1dGhvcml0eSA9ICh0b2tlblJlcXVlc3QgJiYgdG9rZW5SZXF1ZXN0LmF1dGhvcml0eSkgPyBBdXRob3JpdHlGYWN0b3J5LmNyZWF0ZUluc3RhbmNlKHRva2VuUmVxdWVzdC5hdXRob3JpdHksIHRoaXMubmV0d29ya0NsaWVudCkgOiB0aGlzLmRlZmF1bHRBdXRob3JpdHlJbnN0YW5jZTtcclxuICAgICAgICAgICAgaWYgKCFhY3F1aXJlVG9rZW5BdXRob3JpdHkuZGlzY292ZXJ5Q29tcGxldGUoKSkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBhY3F1aXJlVG9rZW5BdXRob3JpdHkucmVzb2x2ZUVuZHBvaW50c0FzeW5jKCk7XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUVuZHBvaW50RGlzY292ZXJ5SW5jb21wbGV0ZUVycm9yKGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgdG9rZW4gZW5kcG9pbnQuXHJcbiAgICAgICAgICAgIGNvbnN0IHsgdG9rZW5FbmRwb2ludCB9ID0gYWNxdWlyZVRva2VuQXV0aG9yaXR5O1xyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHJlcXVlc3QgcGFyYW1ldGVycy5cclxuICAgICAgICAgICAgY29uc3QgdG9rZW5SZXFQYXJhbXMgPSBuZXcgU2VydmVyVG9rZW5SZXF1ZXN0UGFyYW1ldGVycyhcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xpZW50Q29uZmlnLmF1dGguY2xpZW50SWQsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsaWVudENvbmZpZy5hdXRoLnRtcF9jbGllbnRTZWNyZXQsXHJcbiAgICAgICAgICAgICAgICB0b2tlblJlcXVlc3QsXHJcbiAgICAgICAgICAgICAgICBjb2RlUmVzcG9uc2UsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFJlZGlyZWN0VXJpKCksXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyeXB0b09ialxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVXNlciBoZWxwZXIgdG8gcmV0cmlldmUgdG9rZW4gcmVzcG9uc2UuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFRva2VuUmVzcG9uc2UodG9rZW5FbmRwb2ludCwgdG9rZW5SZXFQYXJhbXMsIHRva2VuUmVxdWVzdCwgY29kZVJlc3BvbnNlKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIFJlc2V0IGNhY2hlIGl0ZW1zIGFuZCBzZXQgYWNjb3VudCB0byBudWxsIGJlZm9yZSByZS10aHJvd2luZy5cclxuICAgICAgICAgICAgdGhpcy5jYWNoZU1hbmFnZXIucmVzZXRUZW1wQ2FjaGVJdGVtcyhjb2RlUmVzcG9uc2UgJiYgY29kZVJlc3BvbnNlLnVzZXJSZXF1ZXN0U3RhdGUpO1xyXG4gICAgICAgICAgICB0aGlzLmFjY291bnQgPSBudWxsO1xyXG4gICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHJpZXZlcyBhIHRva2VuIGZyb20gY2FjaGUgaWYgaXQgaXMgc3RpbGwgdmFsaWQsIG9yIHVzZXMgdGhlIGNhY2hlZCByZWZyZXNoIHRva2VuIHRvIHJlbmV3XHJcbiAgICAgKiB0aGUgZ2l2ZW4gdG9rZW4gYW5kIHJldHVybnMgdGhlIHJlbmV3ZWQgdG9rZW4uIFdpbGwgdGhyb3cgYW4gZXJyb3IgaWYgbG9naW4gaXMgbm90IGNvbXBsZXRlZCAodW5sZXNzXHJcbiAgICAgKiBpZCB0b2tlbnMgYXJlIG5vdCBiZWluZyByZW5ld2VkKS5cclxuICAgICAqIEBwYXJhbSByZXF1ZXN0IFxyXG4gICAgICovXHJcbiAgICBhc3luYyByZW5ld1Rva2VuKHJlcXVlc3Q6IFRva2VuUmVuZXdQYXJhbWV0ZXJzKTogUHJvbWlzZTxUb2tlblJlc3BvbnNlPiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gQ2Fubm90IHJlbmV3IHRva2VuIGlmIG5vIHJlcXVlc3Qgb2JqZWN0IGlzIGdpdmVuLlxyXG4gICAgICAgICAgICBpZiAoIXJlcXVlc3QpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVFbXB0eVRva2VuUmVxdWVzdEVycm9yKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEdldCBhY2NvdW50IG9iamVjdCBmb3IgdGhpcyByZXF1ZXN0LlxyXG4gICAgICAgICAgICBjb25zdCBhY2NvdW50ID0gcmVxdWVzdC5hY2NvdW50IHx8IHRoaXMuZ2V0QWNjb3VudCgpO1xyXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0U2NvcGVzID0gbmV3IFNjb3BlU2V0KHJlcXVlc3Quc2NvcGVzLCB0aGlzLmNsaWVudENvbmZpZy5hdXRoLmNsaWVudElkLCB0cnVlKTtcclxuICAgICAgICAgICAgLy8gSWYgdGhpcyBpcyBhbiBpZCB0b2tlbiByZW5ld2FsLCBhbmQgbm8gYWNjb3VudCBpcyBwcmVzZW50LCB0aHJvdyBhbiBlcnJvci5cclxuICAgICAgICAgICAgaWYgKHJlcXVlc3RTY29wZXMuaXNMb2dpblNjb3BlU2V0KCkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghYWNjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IENsaWVudEF1dGhFcnJvci5jcmVhdGVVc2VyTG9naW5SZXF1aXJlZEVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgYXV0aG9yaXR5IG9yIHVzZSBkZWZhdWx0LCBhbmQgcGVyZm9ybSBkaXNjb3ZlcnkgZW5kcG9pbnQgY2hlY2suXHJcbiAgICAgICAgICAgIGNvbnN0IGFjcXVpcmVUb2tlbkF1dGhvcml0eSA9IHJlcXVlc3QuYXV0aG9yaXR5ID8gQXV0aG9yaXR5RmFjdG9yeS5jcmVhdGVJbnN0YW5jZShyZXF1ZXN0LmF1dGhvcml0eSwgdGhpcy5uZXR3b3JrQ2xpZW50KSA6IHRoaXMuZGVmYXVsdEF1dGhvcml0eUluc3RhbmNlO1xyXG4gICAgICAgICAgICBpZiAoIWFjcXVpcmVUb2tlbkF1dGhvcml0eS5kaXNjb3ZlcnlDb21wbGV0ZSgpKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGFjcXVpcmVUb2tlbkF1dGhvcml0eS5yZXNvbHZlRW5kcG9pbnRzQXN5bmMoKTtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlRW5kcG9pbnREaXNjb3ZlcnlJbmNvbXBsZXRlRXJyb3IoZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEdldCBjdXJyZW50IGNhY2hlZCB0b2tlbnNcclxuICAgICAgICAgICAgY29uc3QgY2FjaGVkVG9rZW5JdGVtID0gdGhpcy5nZXRDYWNoZWRUb2tlbnMocmVxdWVzdFNjb3BlcywgYWNxdWlyZVRva2VuQXV0aG9yaXR5LmNhbm9uaWNhbEF1dGhvcml0eSwgcmVxdWVzdC5yZXNvdXJjZSwgYWNjb3VudCAmJiBhY2NvdW50LmhvbWVBY2NvdW50SWRlbnRpZmllcik7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGlyYXRpb25TZWMgPSBOdW1iZXIoY2FjaGVkVG9rZW5JdGVtLnZhbHVlLmV4cGlyZXNPblNlYyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG9mZnNldEN1cnJlbnRUaW1lU2VjID0gVGltZVV0aWxzLm5vd1NlY29uZHMoKSArIHRoaXMuY2xpZW50Q29uZmlnLnN5c3RlbU9wdGlvbnMudG9rZW5SZW5ld2FsT2Zmc2V0U2Vjb25kcztcclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgcmVmcmVzaCBpcyBmb3JjZWQsIG9yIGlmIHRva2VucyBhcmUgZXhwaXJlZC4gSWYgbmVpdGhlciBhcmUgdHJ1ZSwgcmV0dXJuIGEgdG9rZW4gcmVzcG9uc2Ugd2l0aCB0aGUgZm91bmQgdG9rZW4gZW50cnkuXHJcbiAgICAgICAgICAgIGlmICghcmVxdWVzdC5mb3JjZVJlZnJlc2ggJiYgZXhwaXJhdGlvblNlYyAmJiBleHBpcmF0aW9uU2VjID4gb2Zmc2V0Q3VycmVudFRpbWVTZWMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlZFNjb3BlcyA9IFNjb3BlU2V0LmZyb21TdHJpbmcoY2FjaGVkVG9rZW5JdGVtLmtleS5zY29wZXMsIHRoaXMuY2xpZW50Q29uZmlnLmF1dGguY2xpZW50SWQsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVmYXVsdFRva2VuUmVzcG9uc2U6IFRva2VuUmVzcG9uc2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlSWQ6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVuYW50SWQ6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVzOiBjYWNoZWRTY29wZXMuYXNBcnJheSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHRva2VuVHlwZTogY2FjaGVkVG9rZW5JdGVtLnZhbHVlLnRva2VuVHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBpZFRva2VuOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGlkVG9rZW5DbGFpbXM6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IGNhY2hlZFRva2VuSXRlbS52YWx1ZS5hY2Nlc3NUb2tlbixcclxuICAgICAgICAgICAgICAgICAgICByZWZyZXNoVG9rZW46IGNhY2hlZFRva2VuSXRlbS52YWx1ZS5yZWZyZXNoVG9rZW4sXHJcbiAgICAgICAgICAgICAgICAgICAgZXhwaXJlc09uOiBuZXcgRGF0ZShleHBpcmF0aW9uU2VjICogMTAwMCksXHJcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudDogYWNjb3VudCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VyUmVxdWVzdFN0YXRlOiBcIlwiXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIE9ubHkgcG9wdWxhdGUgaWQgdG9rZW4gaWYgaXQgZXhpc3RzIGluIGNhY2hlIGl0ZW0uXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuaXNFbXB0eShjYWNoZWRUb2tlbkl0ZW0udmFsdWUuaWRUb2tlbikgPyBkZWZhdWx0VG9rZW5SZXNwb25zZSA6IFxyXG4gICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlSGFuZGxlci5zZXRSZXNwb25zZUlkVG9rZW4oZGVmYXVsdFRva2VuUmVzcG9uc2UsIG5ldyBJZFRva2VuKGNhY2hlZFRva2VuSXRlbS52YWx1ZS5pZFRva2VuLCB0aGlzLmNyeXB0b09iaikpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVuZXcgdGhlIHRva2Vucy5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3QuYXV0aG9yaXR5ID0gY2FjaGVkVG9rZW5JdGVtLmtleS5hdXRob3JpdHk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IHRva2VuRW5kcG9pbnQgfSA9IGFjcXVpcmVUb2tlbkF1dGhvcml0eTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBJbml0aWFsaXplIHJlcXVlc3QgcGFyYW1ldGVycy5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuUmVxUGFyYW1zID0gbmV3IFNlcnZlclRva2VuUmVxdWVzdFBhcmFtZXRlcnMoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGllbnRDb25maWcuYXV0aC5jbGllbnRJZCxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsaWVudENvbmZpZy5hdXRoLnRtcF9jbGllbnRTZWNyZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdCxcclxuICAgICAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0UmVkaXJlY3RVcmkoKSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNyeXB0b09iaixcclxuICAgICAgICAgICAgICAgICAgICBjYWNoZWRUb2tlbkl0ZW0udmFsdWUucmVmcmVzaFRva2VuXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gXHJcbiAgICAgICAgICAgICAgICAvLyBVc2VyIGhlbHBlciB0byByZXRyaWV2ZSB0b2tlbiByZXNwb25zZS5cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFRva2VuUmVzcG9uc2UodG9rZW5FbmRwb2ludCwgdG9rZW5SZXFQYXJhbXMsIHJlcXVlc3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvLyBSZXNldCBjYWNoZSBpdGVtcyBhbmQgc2V0IGFjY291bnQgdG8gbnVsbCBiZWZvcmUgcmUtdGhyb3dpbmcuXHJcbiAgICAgICAgICAgIHRoaXMuY2FjaGVNYW5hZ2VyLnJlc2V0VGVtcENhY2hlSXRlbXMoKTtcclxuICAgICAgICAgICAgdGhpcy5hY2NvdW50ID0gbnVsbDtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gI3JlZ2lvbiBMb2dvdXRcclxuXHJcbiAgICAvKipcclxuICAgICAqIFVzZSB0byBsb2cgb3V0IHRoZSBjdXJyZW50IHVzZXIsIGFuZCByZWRpcmVjdCB0aGUgdXNlciB0byB0aGUgcG9zdExvZ291dFJlZGlyZWN0VXJpLlxyXG4gICAgICogRGVmYXVsdCBiZWhhdmlvdXIgaXMgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG8gYHdpbmRvdy5sb2NhdGlvbi5ocmVmYC5cclxuICAgICAqIEBwYXJhbSBhdXRob3JpdHlVcmkgXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGxvZ291dChhdXRob3JpdHlVcmk/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRBY2NvdW50ID0gdGhpcy5nZXRBY2NvdW50KCk7XHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIGhvbWVBY2NvdW50SWRlbnRpZmllci4gRG8gbm90IHNlbmQgYW55dGhpbmcgaWYgaXQgZG9lc24ndCBleGlzdC5cclxuICAgICAgICBjb25zdCBob21lQWNjb3VudElkZW50aWZpZXIgPSBjdXJyZW50QWNjb3VudCA/IGN1cnJlbnRBY2NvdW50LmhvbWVBY2NvdW50SWRlbnRpZmllciA6IFwiXCI7XHJcbiAgICAgICAgLy8gUmVtb3ZlIGFsbCBwZXJ0aW5lbnQgYWNjZXNzIHRva2Vucy5cclxuICAgICAgICB0aGlzLmNhY2hlTWFuYWdlci5yZW1vdmVBbGxBY2Nlc3NUb2tlbnModGhpcy5jbGllbnRDb25maWcuYXV0aC5jbGllbnRJZCwgYXV0aG9yaXR5VXJpLCBcIlwiLCBob21lQWNjb3VudElkZW50aWZpZXIpO1xyXG4gICAgICAgIC8vIENsZWFyIHJlbWFpbmluZyBjYWNoZSBpdGVtcy5cclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5jbGVhcigpO1xyXG4gICAgICAgIC8vIENsZWFyIGN1cnJlbnQgYWNjb3VudC5cclxuICAgICAgICB0aGlzLmFjY291bnQgPSBudWxsO1xyXG4gICAgICAgIC8vIEdldCBwb3N0TG9nb3V0UmVkaXJlY3RVcmkuXHJcbiAgICAgICAgbGV0IHBvc3RMb2dvdXRSZWRpcmVjdFVyaSA9IFwiXCI7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcG9zdExvZ291dFJlZGlyZWN0VXJpID0gYD8ke0FBRFNlcnZlclBhcmFtS2V5cy5QT1NUX0xPR09VVF9VUkl9PWAgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5nZXRQb3N0TG9nb3V0UmVkaXJlY3RVcmkoKSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge31cclxuXHJcbiAgICAgICAgLy8gQWNxdWlyZSB0b2tlbiBhdXRob3JpdGllcy5cclxuICAgICAgICBjb25zdCBhY3F1aXJlVG9rZW5BdXRob3JpdHkgPSAoYXV0aG9yaXR5VXJpKSA/IEF1dGhvcml0eUZhY3RvcnkuY3JlYXRlSW5zdGFuY2UoYXV0aG9yaXR5VXJpLCB0aGlzLm5ldHdvcmtDbGllbnQpIDogdGhpcy5kZWZhdWx0QXV0aG9yaXR5SW5zdGFuY2U7XHJcbiAgICAgICAgaWYgKCFhY3F1aXJlVG9rZW5BdXRob3JpdHkuZGlzY292ZXJ5Q29tcGxldGUoKSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgYWNxdWlyZVRva2VuQXV0aG9yaXR5LnJlc29sdmVFbmRwb2ludHNBc3luYygpO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlRW5kcG9pbnREaXNjb3ZlcnlJbmNvbXBsZXRlRXJyb3IoZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENvbnN0cnVjdCBsb2dvdXQgVVJJLlxyXG4gICAgICAgIGNvbnN0IGxvZ291dFVyaSA9IGAke2FjcXVpcmVUb2tlbkF1dGhvcml0eS5lbmRTZXNzaW9uRW5kcG9pbnR9JHtwb3N0TG9nb3V0UmVkaXJlY3RVcml9YDtcclxuICAgICAgICByZXR1cm4gbG9nb3V0VXJpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vICNlbmRyZWdpb25cclxuXHJcbiAgICAvLyAjcmVnaW9uIFJlc3BvbnNlIEhhbmRsaW5nXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIYW5kbGVzIHRoZSBoYXNoIGZyYWdtZW50IHJlc3BvbnNlIGZyb20gcHVibGljIGNsaWVudCBjb2RlIHJlcXVlc3QuIFJldHVybnMgYSBjb2RlIHJlc3BvbnNlIHVzZWQgYnlcclxuICAgICAqIHRoZSBjbGllbnQgdG8gZXhjaGFuZ2UgZm9yIGEgdG9rZW4gaW4gYWNxdWlyZVRva2VuLlxyXG4gICAgICogQHBhcmFtIGhhc2hGcmFnbWVudCBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGhhbmRsZUZyYWdtZW50UmVzcG9uc2UoaGFzaEZyYWdtZW50OiBzdHJpbmcpOiBDb2RlUmVzcG9uc2Uge1xyXG4gICAgICAgIC8vIEhhbmRsZSByZXNwb25zZXMuXHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2VIYW5kbGVyID0gbmV3IFJlc3BvbnNlSGFuZGxlcih0aGlzLmNsaWVudENvbmZpZy5hdXRoLmNsaWVudElkLCB0aGlzLmNhY2hlU3RvcmFnZSwgdGhpcy5jYWNoZU1hbmFnZXIsIHRoaXMuY3J5cHRvT2JqLCB0aGlzLmxvZ2dlcik7XHJcbiAgICAgICAgLy8gRGVzZXJpYWxpemUgaGFzaCBmcmFnbWVudCByZXNwb25zZSBwYXJhbWV0ZXJzLlxyXG4gICAgICAgIGNvbnN0IGhhc2hVcmxTdHJpbmcgPSBuZXcgVXJsU3RyaW5nKGhhc2hGcmFnbWVudCk7XHJcbiAgICAgICAgY29uc3Qgc2VydmVyUGFyYW1zID0gaGFzaFVybFN0cmluZy5nZXREZXNlcmlhbGl6ZWRIYXNoPFNlcnZlckF1dGhvcml6YXRpb25Db2RlUmVzcG9uc2U+KCk7XHJcbiAgICAgICAgLy8gR2V0IGNvZGUgcmVzcG9uc2VcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2VIYW5kbGVyLmhhbmRsZVNlcnZlckNvZGVSZXNwb25zZShzZXJ2ZXJQYXJhbXMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vICNlbmRyZWdpb25cclxuXHJcbiAgICAvLyAjcmVnaW9uIEhlbHBlcnNcclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldHMgdGhlIHRva2VuIGV4Y2hhbmdlIHBhcmFtZXRlcnMgZnJvbSB0aGUgY2FjaGUuIFRocm93cyBhbiBlcnJvciBpZiBub3RoaW5nIGlzIGZvdW5kLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldENhY2hlZFJlcXVlc3Qoc3RhdGU6IHN0cmluZyk6IFRva2VuRXhjaGFuZ2VQYXJhbWV0ZXJzIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBHZXQgdG9rZW4gcmVxdWVzdCBmcm9tIGNhY2hlIGFuZCBwYXJzZSBhcyBUb2tlbkV4Y2hhbmdlUGFyYW1ldGVycy5cclxuICAgICAgICAgICAgY29uc3QgZW5jb2RlZFRva2VuUmVxdWVzdCA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0oVGVtcG9yYXJ5Q2FjaGVLZXlzLlJFUVVFU1RfUEFSQU1TKTtcclxuICAgICAgICAgICAgY29uc3QgcGFyc2VkUmVxdWVzdCA9IEpTT04ucGFyc2UodGhpcy5jcnlwdG9PYmouYmFzZTY0RGVjb2RlKGVuY29kZWRUb2tlblJlcXVlc3QpKSBhcyBUb2tlbkV4Y2hhbmdlUGFyYW1ldGVycztcclxuICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UucmVtb3ZlSXRlbShUZW1wb3JhcnlDYWNoZUtleXMuUkVRVUVTVF9QQVJBTVMpO1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGNhY2hlZCBhdXRob3JpdHkgYW5kIHVzZSBpZiBubyBhdXRob3JpdHkgaXMgZ2l2ZW4uXHJcbiAgICAgICAgICAgIGlmICghcGFyc2VkUmVxdWVzdC5hdXRob3JpdHkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhvcml0eUtleTogc3RyaW5nID0gdGhpcy5jYWNoZU1hbmFnZXIuZ2VuZXJhdGVBdXRob3JpdHlLZXkoc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FjaGVkQXV0aG9yaXR5OiBzdHJpbmcgPSB0aGlzLmNhY2hlU3RvcmFnZS5nZXRJdGVtKGF1dGhvcml0eUtleSk7XHJcbiAgICAgICAgICAgICAgICBwYXJzZWRSZXF1ZXN0LmF1dGhvcml0eSA9IGNhY2hlZEF1dGhvcml0eTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VkUmVxdWVzdDtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZVRva2VuUmVxdWVzdENhY2hlRXJyb3IoZXJyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIGFsbCBjYWNoZWQgdG9rZW5zIGJhc2VkIG9uIHRoZSBnaXZlbiBjcml0ZXJpYS5cclxuICAgICAqIEBwYXJhbSByZXF1ZXN0U2NvcGVzIFxyXG4gICAgICogQHBhcmFtIGF1dGhvcml0eVVyaSBcclxuICAgICAqIEBwYXJhbSByZXNvdXJjZUlkIFxyXG4gICAgICogQHBhcmFtIGhvbWVBY2NvdW50SWRlbnRpZmllciBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRDYWNoZWRUb2tlbnMocmVxdWVzdFNjb3BlczogU2NvcGVTZXQsIGF1dGhvcml0eVVyaTogc3RyaW5nLCByZXNvdXJjZUlkOiBzdHJpbmcsIGhvbWVBY2NvdW50SWRlbnRpZmllcjogc3RyaW5nKTogQWNjZXNzVG9rZW5DYWNoZUl0ZW0ge1xyXG4gICAgICAgIC8vIEdldCBhbGwgYWNjZXNzIHRva2VucyB3aXRoIG1hdGNoaW5nIGF1dGhvcml0eSwgcmVzb3VyY2UgaWQgYW5kIGhvbWUgYWNjb3VudCBJRFxyXG4gICAgICAgIGNvbnN0IHRva2VuQ2FjaGVJdGVtczogQXJyYXk8QWNjZXNzVG9rZW5DYWNoZUl0ZW0+ID0gdGhpcy5jYWNoZU1hbmFnZXIuZ2V0QWxsQWNjZXNzVG9rZW5zKHRoaXMuY2xpZW50Q29uZmlnLmF1dGguY2xpZW50SWQsIGF1dGhvcml0eVVyaSB8fCBcIlwiLCByZXNvdXJjZUlkIHx8IFwiXCIsIGhvbWVBY2NvdW50SWRlbnRpZmllciB8fCBcIlwiKTtcclxuICAgICAgICBpZiAodG9rZW5DYWNoZUl0ZW1zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlTm9Ub2tlbnNGb3VuZEVycm9yKHJlcXVlc3RTY29wZXMucHJpbnRTY29wZXMoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBGaWx0ZXIgY2FjaGUgaXRlbXMgYmFzZWQgb24gYXZhaWxhYmxlIHNjb3Blcy5cclxuICAgICAgICBjb25zdCBmaWx0ZXJlZENhY2hlSXRlbXM6IEFycmF5PEFjY2Vzc1Rva2VuQ2FjaGVJdGVtPiA9IHRva2VuQ2FjaGVJdGVtcy5maWx0ZXIoY2FjaGVJdGVtID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FjaGVkU2NvcGVzID0gU2NvcGVTZXQuZnJvbVN0cmluZyhjYWNoZUl0ZW0ua2V5LnNjb3BlcywgdGhpcy5jbGllbnRDb25maWcuYXV0aC5jbGllbnRJZCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTY29wZXMuY29udGFpbnNTY29wZVNldChyZXF1ZXN0U2NvcGVzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gSWYgY2FjaGUgaXRlbXMgY29udGFpbnMgdG9vIG1hbnkgbWF0Y2hpbmcgdG9rZW5zLCB0aHJvdyBlcnJvci5cclxuICAgICAgICBpZiAoZmlsdGVyZWRDYWNoZUl0ZW1zLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZU11bHRpcGxlTWF0Y2hpbmdUb2tlbnNJbkNhY2hlRXJyb3IocmVxdWVzdFNjb3Blcy5wcmludFNjb3BlcygpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGZpbHRlcmVkQ2FjaGVJdGVtcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgLy8gUmV0dXJuIHNpbmdsZSBjYWNoZSBpdGVtLlxyXG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyZWRDYWNoZUl0ZW1zWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiBjYWNoZSBpdGVtcyBhcmUgZW1wdHksIHRocm93IGVycm9yLlxyXG4gICAgICAgIHRocm93IENsaWVudEF1dGhFcnJvci5jcmVhdGVOb1Rva2Vuc0ZvdW5kRXJyb3IocmVxdWVzdFNjb3Blcy5wcmludFNjb3BlcygpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1ha2VzIGEgcmVxdWVzdCB0byB0aGUgdG9rZW4gZW5kcG9pbnQgd2l0aCB0aGUgZ2l2ZW4gcGFyYW1ldGVycyBhbmQgcGFyc2VzIHRoZSByZXNwb25zZS5cclxuICAgICAqIEBwYXJhbSB0b2tlbkVuZHBvaW50IFxyXG4gICAgICogQHBhcmFtIHRva2VuUmVxUGFyYW1zIFxyXG4gICAgICogQHBhcmFtIHRva2VuUmVxdWVzdCBcclxuICAgICAqIEBwYXJhbSBjb2RlUmVzcG9uc2UgXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYXN5bmMgZ2V0VG9rZW5SZXNwb25zZSh0b2tlbkVuZHBvaW50OiBzdHJpbmcsIHRva2VuUmVxUGFyYW1zOiBTZXJ2ZXJUb2tlblJlcXVlc3RQYXJhbWV0ZXJzLCB0b2tlblJlcXVlc3Q6IFRva2VuRXhjaGFuZ2VQYXJhbWV0ZXJzLCBjb2RlUmVzcG9uc2U/OiBDb2RlUmVzcG9uc2UpOiBQcm9taXNlPFRva2VuUmVzcG9uc2U+IHtcclxuICAgICAgICAvLyBQZXJmb3JtIHRva2VuIHJlcXVlc3QuXHJcbiAgICAgICAgY29uc3QgYWNxdWlyZWRUb2tlblJlc3BvbnNlID0gYXdhaXQgdGhpcy5uZXR3b3JrQ2xpZW50LnNlbmRQb3N0UmVxdWVzdEFzeW5jPFNlcnZlckF1dGhvcml6YXRpb25Ub2tlblJlc3BvbnNlPihcclxuICAgICAgICAgICAgdG9rZW5FbmRwb2ludCxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYm9keTogdG9rZW5SZXFQYXJhbXMuY3JlYXRlUmVxdWVzdEJvZHkoKSxcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRva2VuUmVxUGFyYW1zLmNyZWF0ZVJlcXVlc3RIZWFkZXJzKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIFZhbGlkYXRlIHJlc3BvbnNlLiBUaGlzIGZ1bmN0aW9uIHRocm93cyBhIHNlcnZlciBlcnJvciBpZiBhbiBlcnJvciBpcyByZXR1cm5lZCBieSB0aGUgc2VydmVyLlxyXG4gICAgICAgIHZhbGlkYXRlU2VydmVyQXV0aG9yaXphdGlvblRva2VuUmVzcG9uc2UoYWNxdWlyZWRUb2tlblJlc3BvbnNlKTtcclxuICAgICAgICAvLyBDcmVhdGUgcmVzcG9uc2UgaGFuZGxlciBhbmQgcmV0dXJuIHRva2VuIHJlc3BvbnNlIHdpdGggZ2l2ZW4gcGFyYW1ldGVyc1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlSGFuZGxlciA9IG5ldyBSZXNwb25zZUhhbmRsZXIodGhpcy5jbGllbnRDb25maWcuYXV0aC5jbGllbnRJZCwgdGhpcy5jYWNoZVN0b3JhZ2UsIHRoaXMuY2FjaGVNYW5hZ2VyLCB0aGlzLmNyeXB0b09iaiwgdGhpcy5sb2dnZXIpO1xyXG4gICAgICAgIGNvbnN0IHRva2VuUmVzcG9uc2UgPSByZXNwb25zZUhhbmRsZXIuY3JlYXRlVG9rZW5SZXNwb25zZShhY3F1aXJlZFRva2VuUmVzcG9uc2UsIHRva2VuUmVxdWVzdC5hdXRob3JpdHksIHRva2VuUmVxdWVzdC5yZXNvdXJjZSwgY29kZVJlc3BvbnNlICYmIGNvZGVSZXNwb25zZS51c2VyUmVxdWVzdFN0YXRlKTtcclxuICAgICAgICAvLyBTZXQgY3VycmVudCBhY2NvdW50IHRvIHJlY2VpdmVkIHJlc3BvbnNlIGFjY291bnQsIGlmIGFueS5cclxuICAgICAgICB0aGlzLmFjY291bnQgPSB0b2tlblJlc3BvbnNlLmFjY291bnQ7XHJcbiAgICAgICAgcmV0dXJuIHRva2VuUmVzcG9uc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gI2VuZHJlZ2lvblxyXG5cclxuICAgIC8vICNyZWdpb24gR2V0dGVycyBhbmQgc2V0dGVyc1xyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIFVzZSB0byBnZXQgdGhlIHJlZGlyZWN0IHVyaSBjb25maWd1cmVkIGluIE1TQUwgb3IgbnVsbC5cclxuICAgICAqIEV2YWx1YXRlcyByZWRpcmVjdFVyaSBpZiBpdHMgYSBmdW5jdGlvbiwgb3RoZXJ3aXNlIHNpbXBseSByZXR1cm5zIGl0cyB2YWx1ZS5cclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJlZGlyZWN0IFVSTFxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldFJlZGlyZWN0VXJpKCk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2xpZW50Q29uZmlnLmF1dGgucmVkaXJlY3RVcmkpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmNsaWVudENvbmZpZy5hdXRoLnJlZGlyZWN0VXJpID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNsaWVudENvbmZpZy5hdXRoLnJlZGlyZWN0VXJpKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkodGhpcy5jbGllbnRDb25maWcuYXV0aC5yZWRpcmVjdFVyaSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNsaWVudENvbmZpZy5hdXRoLnJlZGlyZWN0VXJpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBcclxuICAgICAgICAvLyBUaGlzIHNob3VsZCBuZXZlciB0aHJvdyB1bmxlc3Mgd2luZG93LmxvY2F0aW9uLmhyZWYgaXMgcmV0dXJuaW5nIGVtcHR5LlxyXG4gICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVSZWRpcmVjdFVyaUVtcHR5RXJyb3IoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFVzZSB0byBnZXQgdGhlIHBvc3QgbG9nb3V0IHJlZGlyZWN0IHVyaSBjb25maWd1cmVkIGluIE1TQUwgb3IgbnVsbC5cclxuICAgICAqIEV2YWx1YXRlcyBwb3N0TG9nb3V0cmVkaXJlY3RVcmkgaWYgaXRzIGEgZnVuY3Rpb24sIG90aGVyd2lzZSBzaW1wbHkgcmV0dXJucyBpdHMgdmFsdWUuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ30gcG9zdCBsb2dvdXQgcmVkaXJlY3QgVVJMXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRQb3N0TG9nb3V0UmVkaXJlY3RVcmkoKTogc3RyaW5nIHtcclxuICAgICAgICBpZiAodGhpcy5jbGllbnRDb25maWcuYXV0aC5wb3N0TG9nb3V0UmVkaXJlY3RVcmkpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmNsaWVudENvbmZpZy5hdXRoLnBvc3RMb2dvdXRSZWRpcmVjdFVyaSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jbGllbnRDb25maWcuYXV0aC5wb3N0TG9nb3V0UmVkaXJlY3RVcmkoKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eSh0aGlzLmNsaWVudENvbmZpZy5hdXRoLnBvc3RMb2dvdXRSZWRpcmVjdFVyaSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNsaWVudENvbmZpZy5hdXRoLnBvc3RMb2dvdXRSZWRpcmVjdFVyaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gXHJcbiAgICAgICAgLy8gVGhpcyBzaG91bGQgbmV2ZXIgdGhyb3cgdW5sZXNzIHdpbmRvdy5sb2NhdGlvbi5ocmVmIGlzIHJldHVybmluZyBlbXB0eS5cclxuICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlUG9zdExvZ291dFJlZGlyZWN0VXJpRW1wdHlFcnJvcigpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vICNlbmRyZWdpb25cclxufVxyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBBdXRoUmVzcG9uc2UgYmFzZSB0eXBlIHJldHVybmVkIGJ5IE1TQUwgbGlicmFyeSBvbiBzdWNjZXNzXHJcbiAqIC0gdXNlclJlcXVlc3RTdGF0ZTogVXNlciBnaXZlbiBzdGF0ZVxyXG4gKi9cclxuZXhwb3J0IHR5cGUgQXV0aFJlc3BvbnNlID0ge1xyXG4gICAgdXNlclJlcXVlc3RTdGF0ZTogc3RyaW5nO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEJ1aWxkcyBhIHJlc3BvbnNlIHRoYXQgb25seSBzZXRzIHN0YXRlXHJcbiAqIEBwYXJhbSByZXNwb25zZVN0YXRlIFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkUmVzcG9uc2VTdGF0ZU9ubHkocmVzcG9uc2VTdGF0ZTogc3RyaW5nKSA6IEF1dGhSZXNwb25zZSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHVzZXJSZXF1ZXN0U3RhdGU6IHJlc3BvbnNl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
